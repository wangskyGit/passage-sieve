2023-07-20 15:44:02,697 - __main__ - INFO - Training/evaluation parameters Namespace(a=0.5, adam_epsilon=1e-08, adv_data_path=None, adv_lambda=0.0, adv_loss_alpha=0.3, adv_steps=3, ann_data_path=None, ann_dir='output/co_training_nq_SimANS_test/temp', b=0, config_name='', continue_train=False, contr_loss=False, corpus_path='', dev_qa_path='', device=device(type='cuda', index=0), fix_embedding=False, fp16=False, fp16_opt_level='O1', global_step=0, gradient_accumulation_steps=1, gradient_checkpointing=True, iteration_reranker_step=500, iteration_step=2000, learning_rate=1e-06, load_cache=False, load_optimizer_scheduler=False, local_rank=0, log_dir='tensorboard_log/co_training_nq_SimANS_test', logging_steps=100, max_grad_norm=2.0, max_query_length=32, max_seq_length=256, max_steps=20000, model_name_or_path='/webdav/MyData/NQ/NQ/nq_fintinue.pkl', model_name_or_path_ict=None, model_type='nghuyong/ernie-2.0-base-en', n_gpu=1, no_cuda=False, normal_loss=True, normal_term='cross_e', num_epoch=0, number_neg=15, optimizer='adamW', origin_data_dir='output/co_training_nq_SimANS_test/temp/train_ce.json', output_dir='output/co_training_nq_SimANS_test', passage_path='', per_gpu_train_batch_size=8, rank=0, reranker_learning_rate=5e-07, reranker_model_path='/webdav/MyData/NQ/NQ/checkpoint-reranker26000', reranker_model_type='nghuyong/ernie-2.0-large-en', save_steps=2000, scale_simmila=False, seed=42, server_ip='', server_port='', single_warmup=True, temperature_normal=1.0, test_qa_path='', tokenizer_name='', train_qa_path='', triplet=False, warmup_steps=1000, weight_decay=0.0, world_size=2)
2023-07-20 15:44:32,706 - __main__ - INFO - ***** Running training *****
2023-07-20 15:44:32,707 - __main__ - INFO -   Max steps = 20000
2023-07-20 15:44:32,707 - __main__ - INFO -   Instantaneous batch size per GPU = 8
2023-07-20 15:44:32,707 - __main__ - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 16
2023-07-20 15:44:32,707 - __main__ - INFO -   Gradient Accumulation steps = 1
2023-07-20 15:44:32,707 - __main__ - INFO -   Dataset example num = 71506
2023-07-20 15:44:32,707 - __main__ - INFO -   step each epoch = 8938
