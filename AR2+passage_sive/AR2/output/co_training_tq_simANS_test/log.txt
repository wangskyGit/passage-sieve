2023-06-20 14:06:53,535 - __main__ - INFO - Training/evaluation parameters Namespace(model_type='nghuyong/ernie-2.0-base-en', model_name_or_path='../TQ/triviaqa_fintinue.pkl', model_name_or_path_ict=None, output_dir='output/co_training_tq_simANS_test', num_epoch=0, config_name='', tokenizer_name='', corpus_path='', max_seq_length=256, max_query_length=32, triplet=False, log_dir='tensorboard_log/co_training_tq_simANS_test', optimizer='adamW', per_gpu_train_batch_size=8, gradient_accumulation_steps=1, learning_rate=2e-06, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=2.0, max_steps=10000, warmup_steps=1000, logging_steps=100, save_steps=2000, no_cuda=False, seed=42, fp16=False, fp16_opt_level='O1', gradient_checkpointing=True, contr_loss=False, normal_loss=True, origin_data_dir='output/co_training_tq_simANS_test/temp/train_ce.json', load_optimizer_scheduler=False, single_warmup=True, adv_data_path=None, ann_data_path=None, fix_embedding=False, continue_train=False, adv_loss_alpha=0.3, reranker_model_path='../TQ/checkpoint-reranker34000', reranker_model_type='nghuyong/ernie-2.0-large-en', number_neg=15, adv_lambda=0.0, adv_steps=3, local_rank=0, server_ip='', server_port='', test_qa_path='', train_qa_path='', dev_qa_path='', passage_path='', iteration_step=2000, iteration_reranker_step=500, temperature_normal=1.0, scale_simmila=False, reranker_learning_rate=5e-07, load_cache=False, ann_dir='output/co_training_tq_simANS_test/temp', normal_term='cross_e', global_step=0, a=0.5, b=0, n_gpu=1, device=device(type='cuda', index=0), world_size=4, rank=0)
2023-06-20 14:07:04,778 - __main__ - INFO - ***** Running training *****
2023-06-20 14:07:04,778 - __main__ - INFO -   Max steps = 10000
2023-06-20 14:07:04,779 - __main__ - INFO -   Instantaneous batch size per GPU = 8
2023-06-20 14:07:04,779 - __main__ - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 32
2023-06-20 14:07:04,779 - __main__ - INFO -   Gradient Accumulation steps = 1
2023-06-20 14:07:04,779 - __main__ - INFO -   Dataset example num = 69969
2023-06-20 14:07:04,779 - __main__ - INFO -   step each epoch = 8746
2023-06-20 14:17:40,611 - __main__ - INFO - {"learning_rate": 0.0, "loss": 0.1045623625458029, "normal_loss": 0.0, "contr_loss": 0.1045623625458029, "step": 100}
2023-06-20 14:28:20,746 - __main__ - INFO - {"learning_rate": 0.0, "loss": 0.07819906321637973, "normal_loss": 0.0, "contr_loss": 0.07819906321637973, "step": 200}
2023-06-20 14:38:51,168 - __main__ - INFO - {"learning_rate": 0.0, "loss": 0.06825545425238375, "normal_loss": 0.0, "contr_loss": 0.06825545425238375, "step": 300}
2023-06-20 14:49:27,953 - __main__ - INFO - {"learning_rate": 0.0, "loss": 0.09402611508499831, "normal_loss": 0.0, "contr_loss": 0.09402611508499831, "step": 400}
2023-06-20 14:59:55,867 - __main__ - INFO - {"learning_rate": 0.0, "loss": 0.06512577637636013, "normal_loss": 0.0, "contr_loss": 0.06512577637636013, "step": 500}
2023-06-20 15:05:35,921 - __main__ - INFO - {"learning_rate": 2.64e-07, "loss": 0.4294990832358599, "normal_loss": 0.41915875382721424, "contr_loss": 0.01034032940864563, "step": 600}
2023-06-20 15:11:07,599 - __main__ - INFO - {"learning_rate": 5.306666666666665e-07, "loss": 0.3477302080206573, "normal_loss": 0.3477302080206573, "contr_loss": 0.0, "step": 700}
2023-06-20 15:16:40,095 - __main__ - INFO - {"learning_rate": 7.973333333333333e-07, "loss": 0.18875037353485824, "normal_loss": 0.18875037353485824, "contr_loss": 0.0, "step": 800}
2023-06-20 15:22:16,335 - __main__ - INFO - {"learning_rate": 1.064e-06, "loss": 0.18808419727836737, "normal_loss": 0.18808419727836737, "contr_loss": 0.0, "step": 900}
2023-06-20 15:27:49,262 - __main__ - INFO - {"learning_rate": 1.3306666666666666e-06, "loss": 0.1480865952395834, "normal_loss": 0.1480865952395834, "contr_loss": 0.0, "step": 1000}
2023-06-20 15:33:22,097 - __main__ - INFO - {"learning_rate": 1.5973333333333331e-06, "loss": 0.17415845108102077, "normal_loss": 0.17415845108102077, "contr_loss": 0.0, "step": 1100}
2023-06-20 15:39:00,758 - __main__ - INFO - {"learning_rate": 1.864e-06, "loss": 0.1441855144672445, "normal_loss": 0.1441855144672445, "contr_loss": 0.0, "step": 1200}
2023-06-20 15:44:34,892 - __main__ - INFO - {"learning_rate": 1.9854814814814814e-06, "loss": 0.18668122573115398, "normal_loss": 0.18668122573115398, "contr_loss": 0.0, "step": 1300}
2023-06-20 15:50:16,112 - __main__ - INFO - {"learning_rate": 1.955851851851852e-06, "loss": 0.16607344378367997, "normal_loss": 0.16607344378367997, "contr_loss": 0.0, "step": 1400}
2023-06-20 15:55:54,411 - __main__ - INFO - {"learning_rate": 1.9262222222222223e-06, "loss": 0.17695738343900302, "normal_loss": 0.17695738343900302, "contr_loss": 0.0, "step": 1500}
2023-06-20 16:01:27,648 - __main__ - INFO - {"learning_rate": 1.8965925925925925e-06, "loss": 0.21115309861052084, "normal_loss": 0.21115309861052084, "contr_loss": 0.0, "step": 1600}
2023-06-20 16:07:04,128 - __main__ - INFO - {"learning_rate": 1.866962962962963e-06, "loss": 0.14190441513099358, "normal_loss": 0.14190441513099358, "contr_loss": 0.0, "step": 1700}
2023-06-20 16:12:41,372 - __main__ - INFO - {"learning_rate": 1.8373333333333332e-06, "loss": 0.2148306734795915, "normal_loss": 0.2148306734795915, "contr_loss": 0.0, "step": 1800}
2023-06-20 16:18:12,077 - __main__ - INFO - {"learning_rate": 1.8077037037037038e-06, "loss": 0.13539531125290524, "normal_loss": 0.13539531125290524, "contr_loss": 0.0, "step": 1900}
2023-06-20 16:23:48,518 - __main__ - INFO - {"learning_rate": 1.778074074074074e-06, "loss": 0.18115245723049156, "normal_loss": 0.18115245723049156, "contr_loss": 0.0, "step": 2000}
2023-06-20 16:23:51,969 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint
2023-06-20 16:23:57,041 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint-reranker
2023-06-20 16:23:59,581 - __main__ - INFO -  global_step = 2000
2023-06-20 16:24:48,053 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-20 16:28:14,769 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-20 16:28:14,841 - __main__ - INFO - Embedding generation for 5253831 passages from idx 0 to 5253831
2023-06-20 16:28:29,341 - __main__ - INFO - Encoded passages 512
2023-06-20 16:31:59,145 - __main__ - INFO - Encoded passages 51712
2023-06-20 16:35:29,645 - __main__ - INFO - Encoded passages 102912
2023-06-20 16:39:00,118 - __main__ - INFO - Encoded passages 154112
2023-06-20 16:42:30,586 - __main__ - INFO - Encoded passages 205312
2023-06-20 16:46:01,024 - __main__ - INFO - Encoded passages 256512
2023-06-20 16:49:31,459 - __main__ - INFO - Encoded passages 307712
2023-06-20 16:53:01,905 - __main__ - INFO - Encoded passages 358912
2023-06-20 16:56:32,355 - __main__ - INFO - Encoded passages 410112
2023-06-20 17:00:02,803 - __main__ - INFO - Encoded passages 461312
2023-06-20 17:03:33,313 - __main__ - INFO - Encoded passages 512512
2023-06-20 17:07:03,812 - __main__ - INFO - Encoded passages 563712
2023-06-20 17:10:34,307 - __main__ - INFO - Encoded passages 614912
2023-06-20 17:14:04,792 - __main__ - INFO - Encoded passages 666112
2023-06-20 17:17:35,315 - __main__ - INFO - Encoded passages 717312
2023-06-20 17:21:05,878 - __main__ - INFO - Encoded passages 768512
2023-06-20 17:24:36,395 - __main__ - INFO - Encoded passages 819712
2023-06-20 17:28:06,933 - __main__ - INFO - Encoded passages 870912
2023-06-20 17:31:37,495 - __main__ - INFO - Encoded passages 922112
2023-06-20 17:35:08,032 - __main__ - INFO - Encoded passages 973312
2023-06-20 17:38:38,577 - __main__ - INFO - Encoded passages 1024512
2023-06-20 17:42:09,039 - __main__ - INFO - Encoded passages 1075712
2023-06-20 17:45:39,514 - __main__ - INFO - Encoded passages 1126912
2023-06-20 17:49:10,065 - __main__ - INFO - Encoded passages 1178112
2023-06-20 17:52:40,550 - __main__ - INFO - Encoded passages 1229312
2023-06-20 17:56:11,042 - __main__ - INFO - Encoded passages 1280512
2023-06-20 17:58:39,503 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_0.pb.
2023-06-20 17:58:49,047 - __main__ - INFO - Encoded passages 512
2023-06-20 18:02:19,657 - __main__ - INFO - Encoded passages 51712
2023-06-20 18:05:50,284 - __main__ - INFO - Encoded passages 102912
2023-06-20 18:09:20,860 - __main__ - INFO - Encoded passages 154112
2023-06-20 18:12:51,423 - __main__ - INFO - Encoded passages 205312
2023-06-20 18:16:22,010 - __main__ - INFO - Encoded passages 256512
2023-06-20 18:19:52,594 - __main__ - INFO - Encoded passages 307712
2023-06-20 18:23:23,121 - __main__ - INFO - Encoded passages 358912
2023-06-20 18:26:53,620 - __main__ - INFO - Encoded passages 410112
2023-06-20 18:30:24,136 - __main__ - INFO - Encoded passages 461312
2023-06-20 18:33:54,663 - __main__ - INFO - Encoded passages 512512
2023-06-20 18:37:25,163 - __main__ - INFO - Encoded passages 563712
2023-06-20 18:40:55,615 - __main__ - INFO - Encoded passages 614912
2023-06-20 18:44:26,104 - __main__ - INFO - Encoded passages 666112
2023-06-20 18:47:56,647 - __main__ - INFO - Encoded passages 717312
2023-06-20 18:51:27,177 - __main__ - INFO - Encoded passages 768512
2023-06-20 18:54:57,725 - __main__ - INFO - Encoded passages 819712
2023-06-20 18:58:28,298 - __main__ - INFO - Encoded passages 870912
2023-06-20 19:01:58,836 - __main__ - INFO - Encoded passages 922112
2023-06-20 19:05:29,330 - __main__ - INFO - Encoded passages 973312
2023-06-20 19:08:59,843 - __main__ - INFO - Encoded passages 1024512
2023-06-20 19:12:30,363 - __main__ - INFO - Encoded passages 1075712
2023-06-20 19:16:00,900 - __main__ - INFO - Encoded passages 1126912
2023-06-20 19:19:31,411 - __main__ - INFO - Encoded passages 1178112
2023-06-20 19:23:01,938 - __main__ - INFO - Encoded passages 1229312
2023-06-20 19:26:32,429 - __main__ - INFO - Encoded passages 1280512
2023-06-20 19:29:00,334 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_1.pb.
2023-06-20 19:29:09,739 - __main__ - INFO - Encoded passages 512
2023-06-20 19:32:40,220 - __main__ - INFO - Encoded passages 51712
2023-06-20 19:36:10,616 - __main__ - INFO - Encoded passages 102912
2023-06-20 19:39:41,005 - __main__ - INFO - Encoded passages 154112
2023-06-20 19:43:11,330 - __main__ - INFO - Encoded passages 205312
2023-06-20 19:46:41,692 - __main__ - INFO - Encoded passages 256512
2023-06-20 19:50:12,035 - __main__ - INFO - Encoded passages 307712
2023-06-20 19:53:42,435 - __main__ - INFO - Encoded passages 358912
2023-06-20 19:57:12,774 - __main__ - INFO - Encoded passages 410112
2023-06-20 20:00:43,141 - __main__ - INFO - Encoded passages 461312
2023-06-20 20:04:13,514 - __main__ - INFO - Encoded passages 512512
2023-06-20 20:07:43,914 - __main__ - INFO - Encoded passages 563712
2023-06-20 20:11:14,288 - __main__ - INFO - Encoded passages 614912
2023-06-20 20:14:44,607 - __main__ - INFO - Encoded passages 666112
2023-06-20 20:18:14,883 - __main__ - INFO - Encoded passages 717312
2023-06-20 20:21:45,222 - __main__ - INFO - Encoded passages 768512
2023-06-20 20:25:15,600 - __main__ - INFO - Encoded passages 819712
2023-06-20 20:28:45,869 - __main__ - INFO - Encoded passages 870912
2023-06-20 20:32:16,193 - __main__ - INFO - Encoded passages 922112
2023-06-20 20:35:46,562 - __main__ - INFO - Encoded passages 973312
2023-06-20 20:39:16,868 - __main__ - INFO - Encoded passages 1024512
2023-06-20 20:42:47,169 - __main__ - INFO - Encoded passages 1075712
2023-06-20 20:46:17,475 - __main__ - INFO - Encoded passages 1126912
2023-06-20 20:49:47,775 - __main__ - INFO - Encoded passages 1178112
2023-06-20 20:53:18,071 - __main__ - INFO - Encoded passages 1229312
2023-06-20 20:56:48,358 - __main__ - INFO - Encoded passages 1280512
2023-06-20 20:59:15,026 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_2.pb.
2023-06-20 20:59:23,963 - __main__ - INFO - Encoded passages 512
2023-06-20 21:02:54,514 - __main__ - INFO - Encoded passages 51712
2023-06-20 21:06:24,890 - __main__ - INFO - Encoded passages 102912
2023-06-20 21:09:55,277 - __main__ - INFO - Encoded passages 154112
2023-06-20 21:13:25,669 - __main__ - INFO - Encoded passages 205312
2023-06-20 21:16:56,062 - __main__ - INFO - Encoded passages 256512
2023-06-20 21:20:26,457 - __main__ - INFO - Encoded passages 307712
2023-06-20 21:23:56,867 - __main__ - INFO - Encoded passages 358912
2023-06-20 21:27:27,310 - __main__ - INFO - Encoded passages 410112
2023-06-20 21:30:57,692 - __main__ - INFO - Encoded passages 461312
2023-06-20 21:34:28,071 - __main__ - INFO - Encoded passages 512512
2023-06-20 21:37:58,483 - __main__ - INFO - Encoded passages 563712
2023-06-20 21:41:28,889 - __main__ - INFO - Encoded passages 614912
2023-06-20 21:44:59,307 - __main__ - INFO - Encoded passages 666112
2023-06-20 21:48:29,702 - __main__ - INFO - Encoded passages 717312
2023-06-20 21:52:00,123 - __main__ - INFO - Encoded passages 768512
2023-06-20 21:55:30,553 - __main__ - INFO - Encoded passages 819712
2023-06-20 21:59:01,037 - __main__ - INFO - Encoded passages 870912
2023-06-20 22:02:31,435 - __main__ - INFO - Encoded passages 922112
2023-06-20 22:06:01,797 - __main__ - INFO - Encoded passages 973312
2023-06-20 22:09:32,150 - __main__ - INFO - Encoded passages 1024512
2023-06-20 22:13:02,532 - __main__ - INFO - Encoded passages 1075712
2023-06-20 22:16:32,875 - __main__ - INFO - Encoded passages 1126912
2023-06-20 22:20:03,247 - __main__ - INFO - Encoded passages 1178112
2023-06-20 22:23:33,677 - __main__ - INFO - Encoded passages 1229312
2023-06-20 22:27:04,121 - __main__ - INFO - Encoded passages 1280512
2023-06-20 22:29:32,005 - __main__ - INFO - Total passages processed 1313460. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_3.pb.
2023-06-20 22:29:32,398 - __main__ - INFO -  global_step = 2000
2023-06-20 22:36:17,547 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-20 22:39:14,740 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-20 22:39:14,742 - __main__ - INFO - load_passage_begin
2023-06-20 22:39:52,809 - __main__ - INFO - load_passage_id_begin
2023-06-20 22:40:37,888 - __main__ - INFO - load_passage_done
2023-06-20 22:40:39,754 - __main__ - INFO - Loadingtrainanswers
2023-06-20 22:40:51,399 - __main__ - INFO - Encoded question 512
2023-06-20 22:42:06,538 - __main__ - INFO - Loadingdevanswers
2023-06-20 22:42:14,515 - __main__ - INFO - Encoded question 512
2023-06-20 22:42:24,314 - __main__ - INFO - Loadingtestanswers
2023-06-20 22:42:32,603 - __main__ - INFO - Encoded question 512
2023-06-20 22:42:46,046 - __main__ - INFO - ***** Begin passage_embedding reorder *****
2023-06-20 22:43:43,706 - __main__ - INFO - ***** end passage_embedding reorder  *****
2023-06-20 22:43:50,718 - __main__ - INFO - ***** begin add passages  *****
2023-06-20 22:53:12,421 - __main__ - INFO - ***** end build index  *****
2023-06-20 22:57:29,086 - __main__ - INFO - Per question validation results len=78785
2023-06-20 22:57:29,515 - __main__ - INFO - Validation results: top k documents hits [61877, 65156, 66259, 66831, 67200, 67469, 67685, 67814, 67963, 68085, 68177, 68265, 68332, 68407, 68474, 68526, 68574, 68612, 68655, 68688, 68723, 68752, 68779, 68806, 68829, 68861, 68891, 68923, 68942, 68964, 68995, 69016, 69039, 69052, 69070, 69091, 69111, 69122, 69132, 69152, 69162, 69171, 69183, 69193, 69204, 69222, 69231, 69242, 69250, 69264, 69275, 69283, 69298, 69307, 69316, 69328, 69331, 69339, 69345, 69351, 69359, 69369, 69376, 69381, 69391, 69398, 69403, 69410, 69414, 69417, 69422, 69431, 69436, 69444, 69448, 69456, 69463, 69470, 69479, 69487, 69490, 69499, 69508, 69516, 69524, 69531, 69536, 69543, 69549, 69556, 69560, 69566, 69575, 69579, 69589, 69592, 69601, 69604, 69606, 69612]
2023-06-20 22:57:29,515 - __main__ - INFO - Validation results: top k documents hits accuracy [0.7853906200418862, 0.8270102176810307, 0.8410103446087454, 0.848270609887669, 0.8529542425588628, 0.8563685980833915, 0.8591102367201878, 0.8607476042393857, 0.8626388271879165, 0.8641873453068477, 0.8653550802817795, 0.8664720441708447, 0.8673224598591103, 0.868274417719109, 0.8691248334073745, 0.8697848575236403, 0.8703941105540395, 0.8708764358697721, 0.8714222250428381, 0.8718410865012376, 0.8722853335025703, 0.8726534238751031, 0.8729961287047027, 0.8733388335343022, 0.8736307672780351, 0.8740369359649679, 0.8744177191089675, 0.8748238877959003, 0.8750650504537666, 0.8753442914260329, 0.875737767341499, 0.8760043155422986, 0.8762962492860316, 0.876461255315098, 0.8766897252014978, 0.8769562734022974, 0.8772101288316304, 0.8773497493177635, 0.87747667703243, 0.877730532461763, 0.8778574601764295, 0.8779716951196294, 0.8781240083772291, 0.8782509360918956, 0.8783905565780288, 0.8786190264644285, 0.8787332614076283, 0.8788728818937614, 0.8789744240654948, 0.8791521228660278, 0.879291743352161, 0.8793932855238942, 0.8795836770958939, 0.8796979120390938, 0.8798121469822936, 0.8799644602398934, 0.8800025385542933, 0.8801040807260265, 0.8801802373548264, 0.8802563939836263, 0.8803579361553595, 0.880484863870026, 0.8805737132702925, 0.8806371771276258, 0.8807641048422923, 0.8808529542425588, 0.8809164180998921, 0.8810052675001586, 0.8810560385860252, 0.8810941169004252, 0.8811575807577584, 0.8812718157009582, 0.8813352795582916, 0.8814368217300248, 0.8814875928158914, 0.8815891349876246, 0.8816779843878911, 0.8817668337881577, 0.8818810687313575, 0.8819826109030907, 0.8820206892174907, 0.8821349241606905, 0.8822491591038903, 0.8823507012756235, 0.8824522434473567, 0.8825410928476233, 0.8826045567049565, 0.8826934061052231, 0.882769562734023, 0.8828584121342895, 0.8829091832201561, 0.882985339848956, 0.8830995747921558, 0.8831503458780224, 0.8832772735926889, 0.8833153519070889, 0.8834295868502887, 0.8834676651646887, 0.883493050707622, 0.8835692073364219]
2023-06-20 22:57:43,987 - __main__ - INFO - writing new train top-k
2023-06-20 22:57:43,987 - __main__ - INFO - writing new train data
2023-06-20 23:00:20,574 - __main__ - INFO - Per question validation results len=8837
2023-06-20 23:00:20,634 - __main__ - INFO - Validation results: top k documents hits [5193, 5978, 6335, 6552, 6708, 6807, 6893, 6958, 7016, 7058, 7097, 7127, 7163, 7195, 7223, 7239, 7259, 7279, 7300, 7318, 7337, 7352, 7366, 7381, 7393, 7403, 7411, 7423, 7436, 7448, 7458, 7472, 7477, 7482, 7494, 7503, 7512, 7513, 7518, 7529, 7533, 7541, 7550, 7554, 7560, 7563, 7565, 7567, 7572, 7574, 7576, 7583, 7587, 7589, 7592, 7595, 7598, 7601, 7603, 7604, 7607, 7610, 7612, 7615, 7619, 7623, 7625, 7629, 7634, 7640, 7643, 7644, 7648, 7648, 7650, 7653, 7659, 7663, 7666, 7666, 7667, 7672, 7675, 7677, 7679, 7680, 7680, 7684, 7684, 7685, 7686, 7687, 7689, 7692, 7692, 7692, 7693, 7697, 7699, 7702]
2023-06-20 23:00:20,634 - __main__ - INFO - Validation results: top k documents hits accuracy [0.5876428652257554, 0.6764739164874958, 0.7168722417109878, 0.7414280864546792, 0.7590811361321715, 0.7702840330428878, 0.7800158424804798, 0.7873712798461017, 0.7939345931877334, 0.7986873373316736, 0.8031005997510468, 0.8064954169967183, 0.8105691976915242, 0.8141903360869073, 0.8173588321828675, 0.819169401380559, 0.8214326128776734, 0.8236958243747878, 0.826072196446758, 0.828109086794161, 0.8302591377164196, 0.8319565463392554, 0.8335407943872355, 0.8352382030100713, 0.83659612990834, 0.8377277356568972, 0.8386330202557429, 0.8399909471540116, 0.8414620346271359, 0.8428199615254045, 0.8439515672739617, 0.8455358153219419, 0.8461016181962204, 0.8466674210704991, 0.8480253479687677, 0.8490437931424691, 0.8500622383161707, 0.8501753988910263, 0.850741201765305, 0.8519859680887178, 0.8524386103881407, 0.8533438949869865, 0.854362340160688, 0.8548149824601109, 0.8554939459092452, 0.8558334276338124, 0.8560597487835239, 0.8562860699332353, 0.8568518728075138, 0.8570781939572253, 0.8573045151069367, 0.8580966391309268, 0.8585492814303497, 0.8587756025800611, 0.8591150843046282, 0.8594545660291955, 0.8597940477537626, 0.8601335294783298, 0.8603598506280412, 0.8604730112028969, 0.8608124929274641, 0.8611519746520312, 0.8613782958017426, 0.8617177775263098, 0.8621704198257327, 0.8626230621251556, 0.862849383274867, 0.8633020255742899, 0.8638678284485685, 0.8645467918977029, 0.86488627362227, 0.8649994341971258, 0.8654520764965487, 0.8654520764965487, 0.8656783976462601, 0.8660178793708272, 0.8666968428199615, 0.8671494851193844, 0.8674889668439516, 0.8674889668439516, 0.8676021274188073, 0.8681679302930859, 0.868507412017653, 0.8687337331673645, 0.8689600543170759, 0.8690732148919317, 0.8690732148919317, 0.8695258571913546, 0.8695258571913546, 0.8696390177662102, 0.869752178341066, 0.8698653389159217, 0.8700916600656331, 0.8704311417902003, 0.8704311417902003, 0.8704311417902003, 0.870544302365056, 0.8709969446644789, 0.8712232658141903, 0.8715627475387575]
2023-06-20 23:00:29,220 - __main__ - INFO - writing new dev top-k
2023-06-20 23:00:29,220 - __main__ - INFO - writing new dev data
2023-06-20 23:01:43,677 - __main__ - INFO - Per question validation results len=11313
2023-06-20 23:01:43,750 - __main__ - INFO - Validation results: top k documents hits [6698, 7674, 8181, 8452, 8642, 8767, 8884, 8960, 9022, 9077, 9123, 9170, 9223, 9262, 9290, 9323, 9340, 9362, 9389, 9411, 9436, 9449, 9464, 9475, 9493, 9512, 9526, 9534, 9544, 9558, 9563, 9571, 9584, 9591, 9606, 9620, 9628, 9638, 9648, 9654, 9659, 9666, 9669, 9675, 9686, 9693, 9698, 9702, 9705, 9710, 9713, 9715, 9717, 9724, 9727, 9731, 9738, 9739, 9747, 9752, 9756, 9761, 9765, 9771, 9772, 9779, 9783, 9785, 9790, 9793, 9795, 9797, 9801, 9803, 9811, 9813, 9817, 9821, 9825, 9827, 9829, 9831, 9834, 9836, 9840, 9845, 9850, 9852, 9856, 9858, 9861, 9861, 9863, 9863, 9864, 9866, 9866, 9866, 9870, 9872]
2023-06-20 23:01:43,750 - __main__ - INFO - Validation results: top k documents hits accuracy [0.5920622292937329, 0.6783346592415804, 0.7231503579952268, 0.7471051003270573, 0.7638999381242818, 0.7749491735171926, 0.7852912578449571, 0.7920091929638469, 0.7974896137187306, 0.8023512772916114, 0.8064173959162027, 0.8105719084239371, 0.8152567842305313, 0.8187041456731194, 0.8211791744011314, 0.8240961725448599, 0.8255988685582958, 0.8275435339874481, 0.8299301688323169, 0.8318748342614691, 0.8340846813400513, 0.835233801820914, 0.8365597100680633, 0.8375320427826395, 0.8391231326792186, 0.840802616458941, 0.842040130822947, 0.8427472818880933, 0.8436312207195262, 0.8448687350835322, 0.8453107044992486, 0.8460178555643949, 0.8471669760452577, 0.8477857332272607, 0.84911164147441, 0.850349155838416, 0.8510563069035623, 0.8519402457349952, 0.8528241845664281, 0.8533545478652877, 0.8537965172810041, 0.8544152744630071, 0.854680456112437, 0.8552108194112967, 0.8561831521258729, 0.8568019093078759, 0.8572438787235923, 0.8575974542561655, 0.8578626359055953, 0.8583046053213118, 0.8585697869707416, 0.8587465747370282, 0.8589233625033148, 0.8595421196853178, 0.8598073013347476, 0.8601608768673208, 0.8607796340493238, 0.8608680279324671, 0.8615751789976134, 0.8620171484133298, 0.862370723945903, 0.8628126933616194, 0.8631662688941926, 0.8636966321930523, 0.8637850260761956, 0.8644037832581986, 0.8647573587907716, 0.8649341465570582, 0.8653761159727746, 0.8656412976222045, 0.8658180853884911, 0.8659948731547777, 0.8663484486873508, 0.8665252364536374, 0.8672323875187837, 0.8674091752850702, 0.8677627508176434, 0.8681163263502165, 0.8684699018827897, 0.8686466896490763, 0.8688234774153628, 0.8690002651816494, 0.8692654468310793, 0.8694422345973659, 0.869795810129939, 0.8702377795456554, 0.8706797489613719, 0.8708565367276584, 0.8712101122602316, 0.8713869000265182, 0.871652081675948, 0.871652081675948, 0.8718288694422346, 0.8718288694422346, 0.8719172633253779, 0.8720940510916645, 0.8720940510916645, 0.8720940510916645, 0.8724476266242376, 0.8726244143905242]
2023-06-20 23:01:53,275 - __main__ - INFO - writing new test top-k
2023-06-20 23:01:53,275 - __main__ - INFO - writing new test data
2023-06-20 23:01:55,488 - __main__ - INFO -  global_step = 2000
2023-06-21 04:42:52,832 - __main__ - INFO - Training/evaluation parameters Namespace(model_type='nghuyong/ernie-2.0-base-en', model_name_or_path='../TQ/triviaqa_fintinue.pkl', model_name_or_path_ict=None, output_dir='output/co_training_tq_simANS_test', num_epoch=0, config_name='', tokenizer_name='', corpus_path='', max_seq_length=256, max_query_length=32, triplet=False, log_dir='tensorboard_log/co_training_tq_simANS_test', optimizer='adamW', per_gpu_train_batch_size=8, gradient_accumulation_steps=1, learning_rate=2e-06, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=2.0, max_steps=10000, warmup_steps=1000, logging_steps=100, save_steps=2000, no_cuda=False, seed=42, fp16=False, fp16_opt_level='O1', gradient_checkpointing=True, contr_loss=False, normal_loss=True, origin_data_dir='output/co_training_tq_simANS_test/temp/train_ce.json', load_optimizer_scheduler=False, single_warmup=True, adv_data_path=None, ann_data_path=None, fix_embedding=False, continue_train=False, adv_loss_alpha=0.3, reranker_model_path='../TQ/checkpoint-reranker34000', reranker_model_type='nghuyong/ernie-2.0-large-en', number_neg=15, adv_lambda=0.0, adv_steps=3, local_rank=0, server_ip='', server_port='', test_qa_path='', train_qa_path='', dev_qa_path='', passage_path='', iteration_step=2000, iteration_reranker_step=500, temperature_normal=1.0, scale_simmila=False, reranker_learning_rate=5e-07, load_cache=False, ann_dir='output/co_training_tq_simANS_test/temp', normal_term='cross_e', global_step=2000, a=0.5, b=0, n_gpu=1, device=device(type='cuda', index=0), world_size=4, rank=0)
2023-06-21 04:43:08,860 - __main__ - INFO - Loading checkpoint @ step=2000
2023-06-21 04:43:08,860 - __main__ - INFO - Loading saved model state ...
2023-06-21 04:43:36,373 - __main__ - INFO - Loading checkpoint @ step=2000
2023-06-21 04:43:36,373 - __main__ - INFO - Loading saved model state ...
2023-06-21 04:43:49,848 - __main__ - INFO - ***** Running training *****
2023-06-21 04:43:49,848 - __main__ - INFO -   Max steps = 10000
2023-06-21 04:43:49,848 - __main__ - INFO -   Instantaneous batch size per GPU = 8
2023-06-21 04:43:49,848 - __main__ - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 32
2023-06-21 04:43:49,848 - __main__ - INFO -   Gradient Accumulation steps = 1
2023-06-21 04:43:49,848 - __main__ - INFO -   Dataset example num = 70185
2023-06-21 04:43:49,848 - __main__ - INFO -   step each epoch = 8773
2023-06-21 04:57:31,449 - __main__ - INFO - {"learning_rate": 1.778074074074074e-06, "loss": 0.16787093395294506, "normal_loss": 0.0, "contr_loss": 0.16787093395294506, "step": 2100}
2023-06-21 05:11:04,328 - __main__ - INFO - {"learning_rate": 1.778074074074074e-06, "loss": 0.10542935118081914, "normal_loss": 0.0, "contr_loss": 0.10542935118081914, "step": 2200}
2023-06-21 05:24:38,287 - __main__ - INFO - {"learning_rate": 1.778074074074074e-06, "loss": 0.07032848207296638, "normal_loss": 0.0, "contr_loss": 0.07032848207296638, "step": 2300}
2023-06-21 05:38:16,416 - __main__ - INFO - {"learning_rate": 1.778074074074074e-06, "loss": 0.0514633012489594, "normal_loss": 0.0, "contr_loss": 0.0514633012489594, "step": 2400}
2023-06-21 05:51:48,847 - __main__ - INFO - {"learning_rate": 1.778074074074074e-06, "loss": 0.07324440311252146, "normal_loss": 0.0, "contr_loss": 0.07324440311252146, "step": 2500}
2023-06-21 05:59:05,725 - __main__ - INFO - {"learning_rate": 1.7487407407407405e-06, "loss": 0.2635597441671416, "normal_loss": 0.26355800445424393, "contr_loss": 1.7397128976881505e-06, "step": 2600}
2023-06-21 06:06:17,811 - __main__ - INFO - {"learning_rate": 1.719111111111111e-06, "loss": 0.137791422966402, "normal_loss": 0.137791422966402, "contr_loss": 0.0, "step": 2700}
2023-06-21 06:13:32,510 - __main__ - INFO - {"learning_rate": 1.6894814814814814e-06, "loss": 0.13070227257281658, "normal_loss": 0.13070227257281658, "contr_loss": 0.0, "step": 2800}
2023-06-21 06:20:46,064 - __main__ - INFO - {"learning_rate": 1.6598518518518518e-06, "loss": 0.1467186235077679, "normal_loss": 0.1467186235077679, "contr_loss": 0.0, "step": 2900}
2023-06-21 06:27:57,349 - __main__ - INFO - {"learning_rate": 1.630222222222222e-06, "loss": 0.16080735735777124, "normal_loss": 0.16080735735777124, "contr_loss": 0.0, "step": 3000}
2023-06-21 06:35:09,509 - __main__ - INFO - {"learning_rate": 1.6005925925925925e-06, "loss": 0.11082310806435998, "normal_loss": 0.11082310806435998, "contr_loss": 0.0, "step": 3100}
2023-06-21 06:42:20,892 - __main__ - INFO - {"learning_rate": 1.5709629629629627e-06, "loss": 0.1606535944969073, "normal_loss": 0.1606535944969073, "contr_loss": 0.0, "step": 3200}
2023-06-21 06:49:35,824 - __main__ - INFO - {"learning_rate": 1.5413333333333334e-06, "loss": 0.11960806086080993, "normal_loss": 0.11960806086080993, "contr_loss": 0.0, "step": 3300}
2023-06-21 06:56:47,865 - __main__ - INFO - {"learning_rate": 1.5117037037037038e-06, "loss": 0.13517099253222115, "normal_loss": 0.13517099253222115, "contr_loss": 0.0, "step": 3400}
2023-06-21 07:04:01,104 - __main__ - INFO - {"learning_rate": 1.482074074074074e-06, "loss": 0.12994203581867622, "normal_loss": 0.12994203581867622, "contr_loss": 0.0, "step": 3500}
2023-06-21 07:11:14,393 - __main__ - INFO - {"learning_rate": 1.4524444444444445e-06, "loss": 0.153212508711149, "normal_loss": 0.153212508711149, "contr_loss": 0.0, "step": 3600}
2023-06-21 07:18:26,271 - __main__ - INFO - {"learning_rate": 1.4228148148148147e-06, "loss": 0.20491829530670658, "normal_loss": 0.20491829530670658, "contr_loss": 0.0, "step": 3700}
2023-06-21 07:25:39,744 - __main__ - INFO - {"learning_rate": 1.3931851851851851e-06, "loss": 0.13775227099307813, "normal_loss": 0.13775227099307813, "contr_loss": 0.0, "step": 3800}
2023-06-21 07:32:53,339 - __main__ - INFO - {"learning_rate": 1.3635555555555556e-06, "loss": 0.1446111306246894, "normal_loss": 0.1446111306246894, "contr_loss": 0.0, "step": 3900}
2023-06-21 07:40:06,156 - __main__ - INFO - {"learning_rate": 1.333925925925926e-06, "loss": 0.1758410883927354, "normal_loss": 0.1758410883927354, "contr_loss": 0.0, "step": 4000}
2023-06-21 07:40:11,502 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint
2023-06-21 07:40:20,368 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint-reranker
2023-06-21 07:40:23,176 - __main__ - INFO -  global_step = 4000
2023-06-21 07:43:29,804 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-21 07:46:54,559 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-21 07:46:54,652 - __main__ - INFO - Embedding generation for 5253831 passages from idx 0 to 5253831
2023-06-21 07:47:09,596 - __main__ - INFO - Encoded passages 512
2023-06-21 07:50:39,439 - __main__ - INFO - Encoded passages 51712
2023-06-21 07:54:10,098 - __main__ - INFO - Encoded passages 102912
2023-06-21 07:57:40,815 - __main__ - INFO - Encoded passages 154112
2023-06-21 08:01:11,417 - __main__ - INFO - Encoded passages 205312
2023-06-21 08:04:42,064 - __main__ - INFO - Encoded passages 256512
2023-06-21 08:08:12,689 - __main__ - INFO - Encoded passages 307712
2023-06-21 08:11:43,339 - __main__ - INFO - Encoded passages 358912
2023-06-21 08:15:14,040 - __main__ - INFO - Encoded passages 410112
2023-06-21 08:18:44,704 - __main__ - INFO - Encoded passages 461312
2023-06-21 08:22:15,344 - __main__ - INFO - Encoded passages 512512
2023-06-21 08:25:45,995 - __main__ - INFO - Encoded passages 563712
2023-06-21 08:29:16,641 - __main__ - INFO - Encoded passages 614912
2023-06-21 08:32:47,254 - __main__ - INFO - Encoded passages 666112
2023-06-21 08:36:17,863 - __main__ - INFO - Encoded passages 717312
2023-06-21 08:39:48,511 - __main__ - INFO - Encoded passages 768512
2023-06-21 08:43:19,145 - __main__ - INFO - Encoded passages 819712
2023-06-21 08:46:49,798 - __main__ - INFO - Encoded passages 870912
2023-06-21 08:50:20,459 - __main__ - INFO - Encoded passages 922112
2023-06-21 08:53:51,091 - __main__ - INFO - Encoded passages 973312
2023-06-21 08:57:21,745 - __main__ - INFO - Encoded passages 1024512
2023-06-21 09:00:52,401 - __main__ - INFO - Encoded passages 1075712
2023-06-21 09:04:23,090 - __main__ - INFO - Encoded passages 1126912
2023-06-21 09:07:53,761 - __main__ - INFO - Encoded passages 1178112
2023-06-21 09:11:24,428 - __main__ - INFO - Encoded passages 1229312
2023-06-21 09:14:55,077 - __main__ - INFO - Encoded passages 1280512
2023-06-21 09:17:22,035 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_0.pb.
2023-06-21 09:17:32,871 - __main__ - INFO - Encoded passages 512
2023-06-21 09:21:03,649 - __main__ - INFO - Encoded passages 51712
2023-06-21 09:24:34,452 - __main__ - INFO - Encoded passages 102912
2023-06-21 09:28:05,192 - __main__ - INFO - Encoded passages 154112
2023-06-21 09:31:35,940 - __main__ - INFO - Encoded passages 205312
2023-06-21 09:35:06,637 - __main__ - INFO - Encoded passages 256512
2023-06-21 09:38:37,360 - __main__ - INFO - Encoded passages 307712
2023-06-21 09:42:08,096 - __main__ - INFO - Encoded passages 358912
2023-06-21 09:45:38,901 - __main__ - INFO - Encoded passages 410112
2023-06-21 09:49:09,637 - __main__ - INFO - Encoded passages 461312
2023-06-21 09:52:40,350 - __main__ - INFO - Encoded passages 512512
2023-06-21 09:56:11,066 - __main__ - INFO - Encoded passages 563712
2023-06-21 09:59:41,772 - __main__ - INFO - Encoded passages 614912
2023-06-21 10:03:12,489 - __main__ - INFO - Encoded passages 666112
2023-06-21 10:06:43,204 - __main__ - INFO - Encoded passages 717312
2023-06-21 10:10:13,888 - __main__ - INFO - Encoded passages 768512
2023-06-21 10:13:44,529 - __main__ - INFO - Encoded passages 819712
2023-06-21 10:17:15,194 - __main__ - INFO - Encoded passages 870912
2023-06-21 10:20:45,867 - __main__ - INFO - Encoded passages 922112
2023-06-21 10:24:16,545 - __main__ - INFO - Encoded passages 973312
2023-06-21 10:27:47,204 - __main__ - INFO - Encoded passages 1024512
2023-06-21 10:31:17,941 - __main__ - INFO - Encoded passages 1075712
2023-06-21 10:34:48,688 - __main__ - INFO - Encoded passages 1126912
2023-06-21 10:38:19,387 - __main__ - INFO - Encoded passages 1178112
2023-06-21 10:41:50,138 - __main__ - INFO - Encoded passages 1229312
2023-06-21 10:45:20,897 - __main__ - INFO - Encoded passages 1280512
2023-06-21 10:47:50,044 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_1.pb.
2023-06-21 10:48:00,731 - __main__ - INFO - Encoded passages 512
2023-06-21 10:51:31,384 - __main__ - INFO - Encoded passages 51712
2023-06-21 10:55:02,232 - __main__ - INFO - Encoded passages 102912
2023-06-21 10:58:32,960 - __main__ - INFO - Encoded passages 154112
2023-06-21 11:02:03,679 - __main__ - INFO - Encoded passages 205312
2023-06-21 11:05:34,385 - __main__ - INFO - Encoded passages 256512
2023-06-21 11:09:05,085 - __main__ - INFO - Encoded passages 307712
2023-06-21 11:12:35,850 - __main__ - INFO - Encoded passages 358912
2023-06-21 11:16:06,613 - __main__ - INFO - Encoded passages 410112
2023-06-21 11:19:37,311 - __main__ - INFO - Encoded passages 461312
2023-06-21 11:23:08,024 - __main__ - INFO - Encoded passages 512512
2023-06-21 11:26:38,739 - __main__ - INFO - Encoded passages 563712
2023-06-21 11:30:09,452 - __main__ - INFO - Encoded passages 614912
2023-06-21 11:33:40,166 - __main__ - INFO - Encoded passages 666112
2023-06-21 11:37:10,867 - __main__ - INFO - Encoded passages 717312
2023-06-21 11:40:41,529 - __main__ - INFO - Encoded passages 768512
2023-06-21 11:44:12,218 - __main__ - INFO - Encoded passages 819712
2023-06-21 11:47:42,944 - __main__ - INFO - Encoded passages 870912
2023-06-21 11:51:13,688 - __main__ - INFO - Encoded passages 922112
2023-06-21 11:54:44,463 - __main__ - INFO - Encoded passages 973312
2023-06-21 11:58:15,197 - __main__ - INFO - Encoded passages 1024512
2023-06-21 12:01:45,893 - __main__ - INFO - Encoded passages 1075712
2023-06-21 12:05:16,621 - __main__ - INFO - Encoded passages 1126912
2023-06-21 12:08:47,316 - __main__ - INFO - Encoded passages 1178112
2023-06-21 12:12:17,981 - __main__ - INFO - Encoded passages 1229312
2023-06-21 12:15:48,684 - __main__ - INFO - Encoded passages 1280512
2023-06-21 12:18:15,568 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_2.pb.
2023-06-21 12:18:25,097 - __main__ - INFO - Encoded passages 512
2023-06-21 12:21:55,800 - __main__ - INFO - Encoded passages 51712
2023-06-21 12:25:26,547 - __main__ - INFO - Encoded passages 102912
2023-06-21 12:28:57,349 - __main__ - INFO - Encoded passages 154112
2023-06-21 12:32:28,062 - __main__ - INFO - Encoded passages 205312
2023-06-21 12:35:58,791 - __main__ - INFO - Encoded passages 256512
2023-06-21 12:39:29,510 - __main__ - INFO - Encoded passages 307712
2023-06-21 12:43:00,234 - __main__ - INFO - Encoded passages 358912
2023-06-21 12:46:30,956 - __main__ - INFO - Encoded passages 410112
2023-06-21 12:50:01,640 - __main__ - INFO - Encoded passages 461312
2023-06-21 12:53:32,373 - __main__ - INFO - Encoded passages 512512
2023-06-21 12:57:03,094 - __main__ - INFO - Encoded passages 563712
2023-06-21 13:00:33,795 - __main__ - INFO - Encoded passages 614912
2023-06-21 13:04:04,477 - __main__ - INFO - Encoded passages 666112
2023-06-21 13:07:35,213 - __main__ - INFO - Encoded passages 717312
2023-06-21 13:11:05,929 - __main__ - INFO - Encoded passages 768512
2023-06-21 13:14:36,645 - __main__ - INFO - Encoded passages 819712
2023-06-21 13:18:07,370 - __main__ - INFO - Encoded passages 870912
2023-06-21 13:21:38,139 - __main__ - INFO - Encoded passages 922112
2023-06-21 13:25:08,872 - __main__ - INFO - Encoded passages 973312
2023-06-21 13:28:39,562 - __main__ - INFO - Encoded passages 1024512
2023-06-21 13:32:10,275 - __main__ - INFO - Encoded passages 1075712
2023-06-21 13:35:40,952 - __main__ - INFO - Encoded passages 1126912
2023-06-21 13:39:11,658 - __main__ - INFO - Encoded passages 1178112
2023-06-21 13:42:42,396 - __main__ - INFO - Encoded passages 1229312
2023-06-21 13:46:13,117 - __main__ - INFO - Encoded passages 1280512
2023-06-21 13:48:40,981 - __main__ - INFO - Total passages processed 1313460. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_3.pb.
2023-06-21 13:48:41,424 - __main__ - INFO -  global_step = 4000
2023-06-21 13:54:00,120 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-21 13:56:57,522 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-21 13:56:57,524 - __main__ - INFO - load_passage_begin
2023-06-21 13:57:35,153 - __main__ - INFO - load_passage_id_begin
2023-06-21 13:58:24,888 - __main__ - INFO - load_passage_done
2023-06-21 13:58:26,763 - __main__ - INFO - Loadingtrainanswers
2023-06-21 13:58:38,530 - __main__ - INFO - Encoded question 512
2023-06-21 13:59:53,748 - __main__ - INFO - Loadingdevanswers
2023-06-21 14:00:01,825 - __main__ - INFO - Encoded question 512
2023-06-21 14:00:11,647 - __main__ - INFO - Loadingtestanswers
2023-06-21 14:00:20,082 - __main__ - INFO - Encoded question 512
2023-06-21 14:00:33,217 - __main__ - INFO - ***** Begin passage_embedding reorder *****
2023-06-21 14:01:34,073 - __main__ - INFO - ***** end passage_embedding reorder  *****
2023-06-21 14:01:41,572 - __main__ - INFO - ***** begin add passages  *****
2023-06-21 14:06:26,283 - __main__ - INFO - ***** end build index  *****
2023-06-21 14:10:34,686 - __main__ - INFO - Per question validation results len=78785
2023-06-21 14:10:35,105 - __main__ - INFO - Validation results: top k documents hits [61995, 64788, 66021, 66643, 67053, 67308, 67484, 67656, 67788, 67909, 68012, 68095, 68174, 68239, 68297, 68348, 68394, 68442, 68488, 68523, 68557, 68588, 68619, 68655, 68679, 68702, 68726, 68755, 68778, 68801, 68825, 68842, 68859, 68876, 68891, 68905, 68925, 68940, 68959, 68974, 68983, 68992, 69002, 69014, 69025, 69037, 69052, 69071, 69081, 69090, 69099, 69113, 69126, 69136, 69145, 69154, 69162, 69168, 69180, 69186, 69193, 69204, 69211, 69218, 69226, 69239, 69249, 69261, 69268, 69278, 69286, 69294, 69302, 69311, 69318, 69327, 69337, 69348, 69354, 69365, 69370, 69373, 69377, 69387, 69389, 69398, 69408, 69412, 69416, 69424, 69427, 69432, 69436, 69441, 69447, 69454, 69457, 69463, 69467, 69470]
2023-06-21 14:10:35,105 - __main__ - INFO - Validation results: top k documents hits accuracy [0.7868883670749508, 0.8223392777813036, 0.8379894649996826, 0.8458843688519389, 0.8510884051532652, 0.8543250618772609, 0.8565589896553912, 0.858742146347655, 0.8604175921812528, 0.8619534175287173, 0.8632607729897823, 0.8643142730215142, 0.8653170019673796, 0.8661420321127118, 0.8668782128577774, 0.8675255442025767, 0.8681094116900425, 0.8687186647204417, 0.8693025322079075, 0.8697467792092404, 0.8701783334391064, 0.8705718093545726, 0.8709652852700387, 0.8714222250428381, 0.8717268515580378, 0.8720187853017707, 0.8723234118169703, 0.8726915021895031, 0.872983435933236, 0.873275369676969, 0.8735799961921685, 0.8737957733071016, 0.8740115504220346, 0.8742273275369677, 0.8744177191089675, 0.8745954179095006, 0.8748492733388336, 0.8750396649108333, 0.8752808275686996, 0.8754712191406994, 0.8755854540838992, 0.875699689027099, 0.8758266167417655, 0.8759789299993653, 0.8761185504854985, 0.8762708637430983, 0.876461255315098, 0.8767024179729644, 0.8768293456876309, 0.8769435806308308, 0.8770578155740306, 0.8772355143745637, 0.8774005204036301, 0.8775274481182966, 0.8776416830614965, 0.8777559180046963, 0.8778574601764295, 0.8779336168052294, 0.8780859300628292, 0.8781620866916291, 0.8782509360918956, 0.8783905565780288, 0.8784794059782953, 0.8785682553785619, 0.8786697975502951, 0.8788348035793615, 0.8789617312940281, 0.8791140445516279, 0.8792028939518944, 0.8793298216665609, 0.8794313638382941, 0.8795329060100273, 0.8796344481817605, 0.8797486831249604, 0.8798375325252269, 0.8799517674684267, 0.8800786951830932, 0.8802183156692264, 0.8802944722980263, 0.8804340927841594, 0.8804975566414927, 0.8805356349558926, 0.8805864060417592, 0.8807133337564257, 0.880738719299359, 0.8808529542425588, 0.8809798819572253, 0.8810306530430919, 0.8810814241289585, 0.8811829663006917, 0.8812210446150917, 0.8812845084724249, 0.8813352795582916, 0.8813987434156249, 0.8814749000444247, 0.8815637494446913, 0.8816018277590912, 0.8816779843878911, 0.8817287554737577, 0.8817668337881577]
2023-06-21 14:10:49,668 - __main__ - INFO - writing new train top-k
2023-06-21 14:10:49,668 - __main__ - INFO - writing new train data
2023-06-21 14:13:18,201 - __main__ - INFO - Per question validation results len=8837
2023-06-21 14:13:18,290 - __main__ - INFO - Validation results: top k documents hits [5531, 6110, 6433, 6613, 6733, 6830, 6916, 6974, 7034, 7080, 7111, 7147, 7180, 7200, 7233, 7255, 7278, 7298, 7322, 7332, 7347, 7358, 7370, 7380, 7395, 7404, 7420, 7427, 7434, 7445, 7456, 7466, 7471, 7483, 7489, 7495, 7501, 7505, 7510, 7518, 7522, 7524, 7532, 7537, 7544, 7550, 7556, 7563, 7563, 7565, 7568, 7571, 7574, 7577, 7577, 7579, 7581, 7583, 7587, 7592, 7598, 7601, 7603, 7605, 7611, 7615, 7617, 7624, 7627, 7628, 7629, 7630, 7633, 7635, 7637, 7639, 7640, 7643, 7645, 7648, 7648, 7652, 7654, 7657, 7659, 7660, 7664, 7669, 7670, 7677, 7679, 7680, 7684, 7685, 7686, 7686, 7688, 7690, 7691, 7693]
2023-06-21 14:13:18,290 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6258911395269888, 0.6914111123684509, 0.7279619780468485, 0.7483308815208781, 0.7619101505035646, 0.7728867262645694, 0.7826185357021613, 0.7891818490437932, 0.7959714835351364, 0.8011768699784995, 0.8046848477990268, 0.8087586284938327, 0.8124929274640715, 0.8147561389611859, 0.8184904379314247, 0.8209799705782506, 0.8235826637999321, 0.8258458752970466, 0.8285617290935838, 0.829693334842141, 0.8313907434649768, 0.8326355097883897, 0.8339934366866584, 0.8351250424352156, 0.8368224510580514, 0.8378408962317528, 0.8396514654294444, 0.8404435894534344, 0.8412357134774244, 0.8424804798008374, 0.8437252461242503, 0.8448568518728076, 0.8454226547470861, 0.8467805816453547, 0.8474595450944891, 0.8481385085436234, 0.8488174719927577, 0.8492701142921806, 0.8498359171664592, 0.850741201765305, 0.8511938440647279, 0.8514201652144393, 0.8523254498132851, 0.8528912526875636, 0.8536833767115537, 0.854362340160688, 0.8550413036098223, 0.8558334276338124, 0.8558334276338124, 0.8560597487835239, 0.856399230508091, 0.8567387122326582, 0.8570781939572253, 0.8574176756817925, 0.8574176756817925, 0.8576439968315039, 0.8578703179812154, 0.8580966391309268, 0.8585492814303497, 0.8591150843046282, 0.8597940477537626, 0.8601335294783298, 0.8603598506280412, 0.8605861717777527, 0.861265135226887, 0.8617177775263098, 0.8619440986760213, 0.8627362227000113, 0.8630757044245785, 0.8631888649994341, 0.8633020255742899, 0.8634151861491456, 0.8637546678737128, 0.8639809890234242, 0.8642073101731357, 0.8644336313228471, 0.8645467918977029, 0.86488627362227, 0.8651125947719814, 0.8654520764965487, 0.8654520764965487, 0.8659047187959715, 0.866131039945683, 0.8664705216702501, 0.8666968428199615, 0.8668100033948173, 0.8672626456942402, 0.8678284485685187, 0.8679416091433745, 0.8687337331673645, 0.8689600543170759, 0.8690732148919317, 0.8695258571913546, 0.8696390177662102, 0.869752178341066, 0.869752178341066, 0.8699784994907774, 0.8702048206404889, 0.8703179812153445, 0.870544302365056]
2023-06-21 14:13:27,009 - __main__ - INFO - writing new dev top-k
2023-06-21 14:13:27,010 - __main__ - INFO - writing new dev data
2023-06-21 14:14:34,860 - __main__ - INFO - Per question validation results len=11313
2023-06-21 14:14:34,941 - __main__ - INFO - Validation results: top k documents hits [7110, 7783, 8224, 8470, 8643, 8787, 8887, 8966, 9036, 9080, 9114, 9153, 9200, 9233, 9260, 9294, 9324, 9361, 9384, 9406, 9431, 9445, 9461, 9481, 9491, 9506, 9520, 9531, 9542, 9556, 9563, 9574, 9580, 9585, 9589, 9597, 9601, 9614, 9621, 9633, 9642, 9647, 9649, 9655, 9662, 9667, 9674, 9679, 9687, 9694, 9700, 9704, 9707, 9713, 9715, 9720, 9729, 9732, 9735, 9736, 9741, 9744, 9746, 9752, 9755, 9757, 9762, 9770, 9771, 9773, 9776, 9779, 9781, 9782, 9783, 9787, 9791, 9793, 9795, 9797, 9800, 9803, 9808, 9810, 9815, 9818, 9821, 9823, 9824, 9824, 9829, 9830, 9834, 9835, 9836, 9840, 9842, 9845, 9847, 9848]
2023-06-21 14:14:34,941 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6284805091487669, 0.6879695925041988, 0.726951294970388, 0.7486961902236365, 0.7639883320074251, 0.7767170511800583, 0.785556439494387, 0.7925395562627067, 0.7987271280827367, 0.8026164589410413, 0.8056218509679131, 0.8090692124105012, 0.8132237249182357, 0.8161407230619641, 0.8185273579068328, 0.8215327499337046, 0.8241845664280032, 0.8274551401043048, 0.8294881994166003, 0.8314328648457526, 0.8336427119243348, 0.8348802262883408, 0.8362945284186334, 0.8380624060814992, 0.8389463449129321, 0.8402722531600814, 0.8415097675240873, 0.8424821002386634, 0.8434544329532396, 0.8446919473172456, 0.8453107044992486, 0.8462830372138248, 0.8468134005126845, 0.847255369928401, 0.8476089454609741, 0.8483160965261204, 0.8486696720586936, 0.8498187925395563, 0.8504375497215593, 0.8514982763192787, 0.8522938212675683, 0.8527357906832848, 0.8529125784495712, 0.853442941748431, 0.854061698930434, 0.8545036683461504, 0.8551224255281534, 0.8555643949438699, 0.8562715460090162, 0.8568903031910192, 0.8574206664898789, 0.857774242022452, 0.8580394236718819, 0.8585697869707416, 0.8587465747370282, 0.8591885441527446, 0.8599840891010342, 0.8602492707504641, 0.8605144523998939, 0.8606028462830372, 0.8610448156987537, 0.8613099973481835, 0.8614867851144701, 0.8620171484133298, 0.8622823300627597, 0.8624591178290463, 0.8629010872447627, 0.863608238309909, 0.8636966321930523, 0.8638734199593389, 0.8641386016087687, 0.8644037832581986, 0.8645805710244852, 0.8646689649076283, 0.8647573587907716, 0.8651109343233448, 0.8654645098559179, 0.8656412976222045, 0.8658180853884911, 0.8659948731547777, 0.8662600548042075, 0.8665252364536374, 0.8669672058693538, 0.8671439936356404, 0.8675859630513568, 0.8678511447007867, 0.8681163263502165, 0.8682931141165031, 0.8683815079996464, 0.8683815079996464, 0.8688234774153628, 0.8689118712985061, 0.8692654468310793, 0.8693538407142226, 0.8694422345973659, 0.869795810129939, 0.8699725978962256, 0.8702377795456554, 0.870414567311942, 0.8705029611950853]
2023-06-21 14:14:44,081 - __main__ - INFO - writing new test top-k
2023-06-21 14:14:44,081 - __main__ - INFO - writing new test data
2023-06-21 14:14:46,153 - __main__ - INFO -  global_step = 4000
2023-06-21 19:08:22,744 - __main__ - INFO - Training/evaluation parameters Namespace(model_type='nghuyong/ernie-2.0-base-en', model_name_or_path='../TQ/triviaqa_fintinue.pkl', model_name_or_path_ict=None, output_dir='output/co_training_tq_simANS_test', num_epoch=0, config_name='', tokenizer_name='', corpus_path='', max_seq_length=256, max_query_length=32, triplet=False, log_dir='tensorboard_log/co_training_tq_simANS_test', optimizer='adamW', per_gpu_train_batch_size=8, gradient_accumulation_steps=1, learning_rate=2e-06, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=2.0, max_steps=10000, warmup_steps=1000, logging_steps=100, save_steps=2000, no_cuda=False, seed=42, fp16=False, fp16_opt_level='O1', gradient_checkpointing=True, contr_loss=False, normal_loss=True, origin_data_dir='output/co_training_tq_simANS_test/temp/train_ce.json', load_optimizer_scheduler=False, single_warmup=True, adv_data_path=None, ann_data_path=None, fix_embedding=False, continue_train=False, adv_loss_alpha=0.3, reranker_model_path='../TQ/checkpoint-reranker34000', reranker_model_type='nghuyong/ernie-2.0-large-en', number_neg=15, adv_lambda=0.0, adv_steps=3, local_rank=0, server_ip='', server_port='', test_qa_path='', train_qa_path='', dev_qa_path='', passage_path='', iteration_step=2000, iteration_reranker_step=500, temperature_normal=1.0, scale_simmila=False, reranker_learning_rate=5e-07, load_cache=False, ann_dir='output/co_training_tq_simANS_test/temp', normal_term='cross_e', global_step=4000, a=0.5, b=0, n_gpu=1, device=device(type='cuda', index=0), world_size=4, rank=0)
2023-06-21 19:08:42,465 - __main__ - INFO - Loading checkpoint @ step=4000
2023-06-21 19:08:42,465 - __main__ - INFO - Loading saved model state ...
2023-06-21 19:08:58,736 - __main__ - INFO - Loading checkpoint @ step=4000
2023-06-21 19:08:58,736 - __main__ - INFO - Loading saved model state ...
2023-06-21 19:09:10,706 - __main__ - INFO - ***** Running training *****
2023-06-21 19:09:10,706 - __main__ - INFO -   Max steps = 10000
2023-06-21 19:09:10,706 - __main__ - INFO -   Instantaneous batch size per GPU = 8
2023-06-21 19:09:10,706 - __main__ - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 32
2023-06-21 19:09:10,706 - __main__ - INFO -   Gradient Accumulation steps = 1
2023-06-21 19:09:10,706 - __main__ - INFO -   Dataset example num = 70025
2023-06-21 19:09:10,706 - __main__ - INFO -   step each epoch = 8753
2023-06-21 19:20:09,644 - __main__ - INFO - {"learning_rate": 1.333925925925926e-06, "loss": 0.1234045511236036, "normal_loss": 0.0, "contr_loss": 0.1234045511236036, "step": 4100}
2023-06-21 19:30:59,843 - __main__ - INFO - {"learning_rate": 1.333925925925926e-06, "loss": 0.08787036052143776, "normal_loss": 0.0, "contr_loss": 0.08787036052143776, "step": 4200}
2023-06-21 19:41:45,038 - __main__ - INFO - {"learning_rate": 1.333925925925926e-06, "loss": 0.098858397849624, "normal_loss": 0.0, "contr_loss": 0.098858397849624, "step": 4300}
2023-06-21 19:52:21,827 - __main__ - INFO - {"learning_rate": 1.333925925925926e-06, "loss": 0.13325022190948574, "normal_loss": 0.0, "contr_loss": 0.13325022190948574, "step": 4400}
2023-06-21 20:03:10,862 - __main__ - INFO - {"learning_rate": 1.333925925925926e-06, "loss": 0.0887886142860998, "normal_loss": 0.0, "contr_loss": 0.0887886142860998, "step": 4500}
2023-06-21 20:08:59,779 - __main__ - INFO - {"learning_rate": 1.3045925925925925e-06, "loss": 0.2752328812715132, "normal_loss": 0.27384991657105273, "contr_loss": 0.001382964700460434, "step": 4600}
2023-06-21 20:14:44,629 - __main__ - INFO - {"learning_rate": 1.2749629629629627e-06, "loss": 0.2106683837779565, "normal_loss": 0.2106683837779565, "contr_loss": 0.0, "step": 4700}
2023-06-21 20:20:30,122 - __main__ - INFO - {"learning_rate": 1.2453333333333334e-06, "loss": 0.1885524493677076, "normal_loss": 0.1885524493677076, "contr_loss": 0.0, "step": 4800}
2023-06-21 20:26:15,353 - __main__ - INFO - {"learning_rate": 1.2157037037037036e-06, "loss": 0.1970505605067592, "normal_loss": 0.1970505605067592, "contr_loss": 0.0, "step": 4900}
2023-06-21 20:31:58,732 - __main__ - INFO - {"learning_rate": 1.186074074074074e-06, "loss": 0.13888645774684846, "normal_loss": 0.13888645774684846, "contr_loss": 0.0, "step": 5000}
2023-06-21 20:37:45,719 - __main__ - INFO - {"learning_rate": 1.1564444444444442e-06, "loss": 0.16154837426380253, "normal_loss": 0.16154837426380253, "contr_loss": 0.0, "step": 5100}
2023-06-21 20:43:30,277 - __main__ - INFO - {"learning_rate": 1.1268148148148147e-06, "loss": 0.18914312028617133, "normal_loss": 0.18914312028617133, "contr_loss": 0.0, "step": 5200}
2023-06-21 20:49:15,099 - __main__ - INFO - {"learning_rate": 1.0971851851851851e-06, "loss": 0.1544136094939313, "normal_loss": 0.1544136094939313, "contr_loss": 0.0, "step": 5300}
2023-06-21 20:54:57,078 - __main__ - INFO - {"learning_rate": 1.0675555555555556e-06, "loss": 0.17423449079913553, "normal_loss": 0.17423449079913553, "contr_loss": 0.0, "step": 5400}
2023-06-21 21:00:38,469 - __main__ - INFO - {"learning_rate": 1.0379259259259258e-06, "loss": 0.2045040811051149, "normal_loss": 0.2045040811051149, "contr_loss": 0.0, "step": 5500}
2023-06-21 21:06:26,058 - __main__ - INFO - {"learning_rate": 1.0082962962962962e-06, "loss": 0.1586888509322307, "normal_loss": 0.1586888509322307, "contr_loss": 0.0, "step": 5600}
2023-06-21 21:12:09,487 - __main__ - INFO - {"learning_rate": 9.786666666666666e-07, "loss": 0.16865700287104118, "normal_loss": 0.16865700287104118, "contr_loss": 0.0, "step": 5700}
2023-06-21 21:17:52,267 - __main__ - INFO - {"learning_rate": 9.49037037037037e-07, "loss": 0.1687452317829593, "normal_loss": 0.1687452317829593, "contr_loss": 0.0, "step": 5800}
2023-06-21 21:23:37,109 - __main__ - INFO - {"learning_rate": 9.194074074074074e-07, "loss": 0.11145328319515102, "normal_loss": 0.11145328319515102, "contr_loss": 0.0, "step": 5900}
2023-06-21 21:29:15,757 - __main__ - INFO - {"learning_rate": 8.897777777777777e-07, "loss": 0.1950365152733866, "normal_loss": 0.1950365152733866, "contr_loss": 0.0, "step": 6000}
2023-06-21 21:29:21,583 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint
2023-06-21 21:29:29,678 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint-reranker
2023-06-21 21:29:32,132 - __main__ - INFO -  global_step = 6000
2023-06-21 21:29:59,532 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-21 21:33:20,227 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-21 21:33:20,298 - __main__ - INFO - Embedding generation for 5253831 passages from idx 0 to 5253831
2023-06-21 21:33:35,221 - __main__ - INFO - Encoded passages 512
2023-06-21 21:37:05,111 - __main__ - INFO - Encoded passages 51712
2023-06-21 21:40:35,664 - __main__ - INFO - Encoded passages 102912
2023-06-21 21:44:06,294 - __main__ - INFO - Encoded passages 154112
2023-06-21 21:47:36,845 - __main__ - INFO - Encoded passages 205312
2023-06-21 21:51:07,388 - __main__ - INFO - Encoded passages 256512
2023-06-21 21:54:37,910 - __main__ - INFO - Encoded passages 307712
2023-06-21 21:58:08,399 - __main__ - INFO - Encoded passages 358912
2023-06-21 22:01:38,893 - __main__ - INFO - Encoded passages 410112
2023-06-21 22:05:09,423 - __main__ - INFO - Encoded passages 461312
2023-06-21 22:08:39,969 - __main__ - INFO - Encoded passages 512512
2023-06-21 22:12:10,490 - __main__ - INFO - Encoded passages 563712
2023-06-21 22:15:40,976 - __main__ - INFO - Encoded passages 614912
2023-06-21 22:19:11,483 - __main__ - INFO - Encoded passages 666112
2023-06-21 22:22:41,970 - __main__ - INFO - Encoded passages 717312
2023-06-21 22:26:12,458 - __main__ - INFO - Encoded passages 768512
2023-06-21 22:29:42,931 - __main__ - INFO - Encoded passages 819712
2023-06-21 22:33:13,442 - __main__ - INFO - Encoded passages 870912
2023-06-21 22:36:43,934 - __main__ - INFO - Encoded passages 922112
2023-06-21 22:40:14,381 - __main__ - INFO - Encoded passages 973312
2023-06-21 22:43:44,880 - __main__ - INFO - Encoded passages 1024512
2023-06-21 22:47:15,363 - __main__ - INFO - Encoded passages 1075712
2023-06-21 22:50:45,887 - __main__ - INFO - Encoded passages 1126912
2023-06-21 22:54:16,432 - __main__ - INFO - Encoded passages 1178112
2023-06-21 22:57:46,890 - __main__ - INFO - Encoded passages 1229312
2023-06-21 23:01:17,352 - __main__ - INFO - Encoded passages 1280512
2023-06-21 23:03:45,361 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_0.pb.
2023-06-21 23:03:54,780 - __main__ - INFO - Encoded passages 512
2023-06-21 23:07:25,413 - __main__ - INFO - Encoded passages 51712
2023-06-21 23:10:56,020 - __main__ - INFO - Encoded passages 102912
2023-06-21 23:14:26,649 - __main__ - INFO - Encoded passages 154112
2023-06-21 23:17:57,213 - __main__ - INFO - Encoded passages 205312
2023-06-21 23:21:27,772 - __main__ - INFO - Encoded passages 256512
2023-06-21 23:24:58,351 - __main__ - INFO - Encoded passages 307712
2023-06-21 23:28:28,952 - __main__ - INFO - Encoded passages 358912
2023-06-21 23:31:59,485 - __main__ - INFO - Encoded passages 410112
2023-06-21 23:35:29,995 - __main__ - INFO - Encoded passages 461312
2023-06-21 23:39:00,505 - __main__ - INFO - Encoded passages 512512
2023-06-21 23:42:31,003 - __main__ - INFO - Encoded passages 563712
2023-06-21 23:46:01,506 - __main__ - INFO - Encoded passages 614912
2023-06-21 23:49:32,042 - __main__ - INFO - Encoded passages 666112
2023-06-21 23:53:02,562 - __main__ - INFO - Encoded passages 717312
2023-06-21 23:56:33,093 - __main__ - INFO - Encoded passages 768512
2023-06-22 00:00:03,605 - __main__ - INFO - Encoded passages 819712
2023-06-22 00:03:34,149 - __main__ - INFO - Encoded passages 870912
2023-06-22 00:07:04,686 - __main__ - INFO - Encoded passages 922112
2023-06-22 00:10:35,227 - __main__ - INFO - Encoded passages 973312
2023-06-22 00:14:05,767 - __main__ - INFO - Encoded passages 1024512
2023-06-22 00:17:36,323 - __main__ - INFO - Encoded passages 1075712
2023-06-22 00:21:06,890 - __main__ - INFO - Encoded passages 1126912
2023-06-22 00:24:37,433 - __main__ - INFO - Encoded passages 1178112
2023-06-22 00:28:08,001 - __main__ - INFO - Encoded passages 1229312
2023-06-22 00:31:38,538 - __main__ - INFO - Encoded passages 1280512
2023-06-22 00:34:05,677 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_1.pb.
2023-06-22 00:34:15,188 - __main__ - INFO - Encoded passages 512
2023-06-22 00:37:45,778 - __main__ - INFO - Encoded passages 51712
2023-06-22 00:41:16,595 - __main__ - INFO - Encoded passages 102912
2023-06-22 00:44:47,190 - __main__ - INFO - Encoded passages 154112
2023-06-22 00:48:17,733 - __main__ - INFO - Encoded passages 205312
2023-06-22 00:51:48,240 - __main__ - INFO - Encoded passages 256512
2023-06-22 00:55:18,822 - __main__ - INFO - Encoded passages 307712
2023-06-22 00:58:49,343 - __main__ - INFO - Encoded passages 358912
2023-06-22 01:02:19,851 - __main__ - INFO - Encoded passages 410112
2023-06-22 01:05:50,428 - __main__ - INFO - Encoded passages 461312
2023-06-22 01:09:20,921 - __main__ - INFO - Encoded passages 512512
2023-06-22 01:12:51,458 - __main__ - INFO - Encoded passages 563712
2023-06-22 01:16:22,035 - __main__ - INFO - Encoded passages 614912
2023-06-22 01:19:52,617 - __main__ - INFO - Encoded passages 666112
2023-06-22 01:23:23,139 - __main__ - INFO - Encoded passages 717312
2023-06-22 01:26:53,691 - __main__ - INFO - Encoded passages 768512
2023-06-22 01:30:24,225 - __main__ - INFO - Encoded passages 819712
2023-06-22 01:33:54,810 - __main__ - INFO - Encoded passages 870912
2023-06-22 01:37:25,385 - __main__ - INFO - Encoded passages 922112
2023-06-22 01:40:55,976 - __main__ - INFO - Encoded passages 973312
2023-06-22 01:44:26,542 - __main__ - INFO - Encoded passages 1024512
2023-06-22 01:47:57,087 - __main__ - INFO - Encoded passages 1075712
2023-06-22 01:51:27,638 - __main__ - INFO - Encoded passages 1126912
2023-06-22 01:54:58,190 - __main__ - INFO - Encoded passages 1178112
2023-06-22 01:58:28,739 - __main__ - INFO - Encoded passages 1229312
2023-06-22 02:01:59,301 - __main__ - INFO - Encoded passages 1280512
2023-06-22 02:04:27,718 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_2.pb.
2023-06-22 02:04:37,597 - __main__ - INFO - Encoded passages 512
2023-06-22 02:08:08,024 - __main__ - INFO - Encoded passages 51712
2023-06-22 02:11:38,459 - __main__ - INFO - Encoded passages 102912
2023-06-22 02:15:08,885 - __main__ - INFO - Encoded passages 154112
2023-06-22 02:18:39,286 - __main__ - INFO - Encoded passages 205312
2023-06-22 02:22:09,721 - __main__ - INFO - Encoded passages 256512
2023-06-22 02:25:40,156 - __main__ - INFO - Encoded passages 307712
2023-06-22 02:29:10,554 - __main__ - INFO - Encoded passages 358912
2023-06-22 02:32:40,933 - __main__ - INFO - Encoded passages 410112
2023-06-22 02:36:11,280 - __main__ - INFO - Encoded passages 461312
2023-06-22 02:39:41,642 - __main__ - INFO - Encoded passages 512512
2023-06-22 02:43:12,002 - __main__ - INFO - Encoded passages 563712
2023-06-22 02:46:42,388 - __main__ - INFO - Encoded passages 614912
2023-06-22 02:50:12,872 - __main__ - INFO - Encoded passages 666112
2023-06-22 02:53:43,365 - __main__ - INFO - Encoded passages 717312
2023-06-22 02:57:13,856 - __main__ - INFO - Encoded passages 768512
2023-06-22 03:00:44,300 - __main__ - INFO - Encoded passages 819712
2023-06-22 03:04:14,742 - __main__ - INFO - Encoded passages 870912
2023-06-22 03:07:45,216 - __main__ - INFO - Encoded passages 922112
2023-06-22 03:11:15,658 - __main__ - INFO - Encoded passages 973312
2023-06-22 03:14:46,106 - __main__ - INFO - Encoded passages 1024512
2023-06-22 03:18:16,582 - __main__ - INFO - Encoded passages 1075712
2023-06-22 03:21:47,061 - __main__ - INFO - Encoded passages 1126912
2023-06-22 03:25:17,522 - __main__ - INFO - Encoded passages 1178112
2023-06-22 03:28:47,999 - __main__ - INFO - Encoded passages 1229312
2023-06-22 03:32:18,511 - __main__ - INFO - Encoded passages 1280512
2023-06-22 03:34:47,826 - __main__ - INFO - Total passages processed 1313460. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_3.pb.
2023-06-22 03:34:48,219 - __main__ - INFO -  global_step = 6000
2023-06-22 03:40:10,430 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-22 03:43:08,305 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-22 03:43:08,306 - __main__ - INFO - load_passage_begin
2023-06-22 03:43:46,058 - __main__ - INFO - load_passage_id_begin
2023-06-22 03:44:39,768 - __main__ - INFO - load_passage_done
2023-06-22 03:44:41,607 - __main__ - INFO - Loadingtrainanswers
2023-06-22 03:44:53,563 - __main__ - INFO - Encoded question 512
2023-06-22 03:46:08,659 - __main__ - INFO - Loadingdevanswers
2023-06-22 03:46:16,759 - __main__ - INFO - Encoded question 512
2023-06-22 03:46:26,500 - __main__ - INFO - Loadingtestanswers
2023-06-22 03:46:34,848 - __main__ - INFO - Encoded question 512
2023-06-22 03:46:48,229 - __main__ - INFO - ***** Begin passage_embedding reorder *****
2023-06-22 03:47:54,822 - __main__ - INFO - ***** end passage_embedding reorder  *****
2023-06-22 03:48:01,630 - __main__ - INFO - ***** begin add passages  *****
2023-06-22 04:12:57,766 - __main__ - INFO - ***** end build index  *****
2023-06-22 04:17:09,642 - __main__ - INFO - Per question validation results len=78785
2023-06-22 04:17:10,088 - __main__ - INFO - Validation results: top k documents hits [63985, 66436, 67278, 67694, 67967, 68167, 68322, 68446, 68537, 68611, 68680, 68738, 68789, 68834, 68872, 68900, 68933, 68966, 69002, 69036, 69072, 69100, 69120, 69151, 69175, 69199, 69225, 69244, 69263, 69279, 69294, 69304, 69321, 69334, 69356, 69371, 69382, 69391, 69397, 69408, 69419, 69429, 69440, 69450, 69461, 69467, 69476, 69485, 69492, 69505, 69513, 69526, 69535, 69541, 69548, 69559, 69563, 69573, 69577, 69587, 69593, 69600, 69608, 69616, 69622, 69627, 69630, 69639, 69643, 69650, 69655, 69658, 69664, 69673, 69679, 69686, 69687, 69692, 69694, 69705, 69707, 69714, 69721, 69726, 69730, 69733, 69736, 69747, 69750, 69754, 69760, 69766, 69771, 69777, 69783, 69791, 69793, 69800, 69802, 69804]
2023-06-22 04:17:10,088 - __main__ - INFO - Validation results: top k documents hits accuracy [0.8121469822935838, 0.8432569651583424, 0.8539442787332614, 0.8592244716633877, 0.8626895982737831, 0.865228152567113, 0.8671955321444438, 0.8687694358063083, 0.8699244780097735, 0.8708637430983055, 0.8717395443295044, 0.87247572507457, 0.8731230564193692, 0.8736942311353684, 0.8741765564511011, 0.8745319540521673, 0.8749508155105667, 0.8753696769689662, 0.8758266167417655, 0.8762581709716316, 0.8767151107444311, 0.8770705083454973, 0.8773243637748303, 0.8777178396902964, 0.878022466205496, 0.8783270927206955, 0.8786571047788284, 0.8788982674366949, 0.8791394300945612, 0.8793425144380276, 0.8795329060100273, 0.8796598337246938, 0.8798756108396268, 0.8800406168686933, 0.8803198578409596, 0.8805102494129593, 0.8806498698990924, 0.8807641048422923, 0.8808402614710922, 0.8809798819572253, 0.8811195024433585, 0.881246430158025, 0.8813860506441582, 0.8815129783588247, 0.8816525988449578, 0.8817287554737577, 0.8818429904169576, 0.8819572253601574, 0.882046074760424, 0.8822110807894904, 0.8823126229612236, 0.88247762899029, 0.8825918639334899, 0.8826680205622898, 0.8827568699625563, 0.8828964904486895, 0.882947261534556, 0.8830741892492225, 0.8831249603350891, 0.8832518880497556, 0.8833280446785555, 0.8834168940788221, 0.8835184362505553, 0.8836199784222885, 0.8836961350510885, 0.8837595989084217, 0.8837976772228217, 0.8839119121660215, 0.8839626832518881, 0.8840515326521546, 0.8841149965094879, 0.8841530748238878, 0.8842292314526877, 0.8843434663958876, 0.8844196230246875, 0.884508472424954, 0.8845211651964207, 0.8845846290537539, 0.8846100145966872, 0.8847496350828203, 0.8847750206257536, 0.8848638700260202, 0.8849527194262867, 0.88501618328362, 0.8850669543694866, 0.8851050326838865, 0.8851431109982865, 0.8852827314844196, 0.8853208097988196, 0.8853715808846861, 0.885447737513486, 0.8855238941422859, 0.8855873579996192, 0.8856635146284191, 0.885739671257219, 0.8858412134289522, 0.8858665989718855, 0.885955448372152, 0.8859808339150853, 0.8860062194580186]
2023-06-22 04:17:24,858 - __main__ - INFO - writing new train top-k
2023-06-22 04:17:24,858 - __main__ - INFO - writing new train data
2023-06-22 04:19:50,308 - __main__ - INFO - Per question validation results len=8837
2023-06-22 04:19:50,366 - __main__ - INFO - Validation results: top k documents hits [5465, 6215, 6538, 6719, 6859, 6964, 7022, 7078, 7124, 7171, 7206, 7231, 7261, 7288, 7311, 7325, 7349, 7364, 7378, 7392, 7413, 7428, 7444, 7455, 7471, 7484, 7491, 7500, 7511, 7519, 7527, 7533, 7539, 7544, 7555, 7562, 7569, 7574, 7584, 7591, 7594, 7603, 7608, 7612, 7618, 7620, 7622, 7623, 7626, 7627, 7631, 7634, 7638, 7643, 7647, 7653, 7657, 7664, 7668, 7672, 7677, 7679, 7681, 7684, 7688, 7690, 7693, 7696, 7697, 7699, 7705, 7705, 7705, 7710, 7713, 7714, 7717, 7718, 7718, 7719, 7722, 7722, 7722, 7722, 7724, 7725, 7725, 7727, 7728, 7729, 7732, 7732, 7733, 7734, 7734, 7736, 7738, 7741, 7741, 7744]
2023-06-22 04:19:50,366 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6184225415865112, 0.7032929727283015, 0.7398438384066991, 0.7603259024555845, 0.7761683829353853, 0.788050243295236, 0.7946135566368677, 0.800950548828788, 0.8061559352721512, 0.81147448229037, 0.8154351024103202, 0.8182641167817133, 0.8216589340273849, 0.8247142695484893, 0.8273169627701709, 0.8289012108181509, 0.8316170646146882, 0.8333144732375241, 0.8348987212855041, 0.8364829693334842, 0.8388593414054544, 0.8405567500282901, 0.8423673192259816, 0.8436120855493946, 0.8454226547470861, 0.8468937422202105, 0.8476858662442005, 0.848704311417902, 0.8499490777413149, 0.8508543623401607, 0.8517596469390064, 0.8524386103881407, 0.853117573837275, 0.8536833767115537, 0.8549281430349667, 0.8557202670589567, 0.8565123910829467, 0.8570781939572253, 0.8582097997057825, 0.8590019237297726, 0.8593414054543397, 0.8603598506280412, 0.8609256535023198, 0.8613782958017426, 0.862057259250877, 0.8622835804005884, 0.8625099015502998, 0.8626230621251556, 0.8629625438497227, 0.8630757044245785, 0.8635283467240014, 0.8638678284485685, 0.8643204707479915, 0.86488627362227, 0.8653389159216929, 0.8660178793708272, 0.8664705216702501, 0.8672626456942402, 0.867715287993663, 0.8681679302930859, 0.8687337331673645, 0.8689600543170759, 0.8691863754667873, 0.8695258571913546, 0.8699784994907774, 0.8702048206404889, 0.870544302365056, 0.8708837840896232, 0.8709969446644789, 0.8712232658141903, 0.8719022292633246, 0.8719022292633246, 0.8719022292633246, 0.8724680321376033, 0.8728075138621704, 0.8729206744370261, 0.8732601561615932, 0.873373316736449, 0.873373316736449, 0.8734864773113047, 0.8738259590358719, 0.8738259590358719, 0.8738259590358719, 0.8738259590358719, 0.8740522801855833, 0.8741654407604391, 0.8741654407604391, 0.8743917619101506, 0.8745049224850062, 0.874618083059862, 0.8749575647844291, 0.8749575647844291, 0.8750707253592849, 0.8751838859341405, 0.8751838859341405, 0.875410207083852, 0.8756365282335634, 0.8759760099581306, 0.8759760099581306, 0.8763154916826977]
2023-06-22 04:19:58,990 - __main__ - INFO - writing new dev top-k
2023-06-22 04:19:58,990 - __main__ - INFO - writing new dev data
2023-06-22 04:21:08,196 - __main__ - INFO - Per question validation results len=11313
2023-06-22 04:21:08,273 - __main__ - INFO - Validation results: top k documents hits [7040, 7963, 8418, 8661, 8812, 8927, 9010, 9107, 9171, 9223, 9268, 9304, 9337, 9379, 9414, 9442, 9473, 9492, 9512, 9525, 9540, 9556, 9571, 9586, 9596, 9615, 9625, 9631, 9641, 9648, 9659, 9664, 9670, 9677, 9682, 9685, 9696, 9703, 9709, 9714, 9718, 9725, 9731, 9739, 9745, 9753, 9762, 9771, 9777, 9785, 9788, 9791, 9795, 9801, 9806, 9810, 9813, 9815, 9817, 9824, 9829, 9832, 9836, 9840, 9841, 9844, 9846, 9849, 9850, 9852, 9853, 9858, 9859, 9861, 9865, 9866, 9870, 9873, 9877, 9882, 9883, 9885, 9891, 9893, 9893, 9893, 9896, 9898, 9900, 9903, 9905, 9905, 9907, 9910, 9910, 9913, 9920, 9922, 9924, 9926]
2023-06-22 04:21:08,273 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6222929373287368, 0.7038804914699903, 0.7440997083001857, 0.7655794219040043, 0.7789268982586405, 0.7890921948201185, 0.7964288871210112, 0.8050030937859101, 0.8106603023070803, 0.8152567842305313, 0.8192345089719791, 0.8224166887651374, 0.8253336869088659, 0.829046230000884, 0.8321400159108989, 0.834615044638911, 0.8373552550163529, 0.8390347387960753, 0.840802616458941, 0.8419517369398037, 0.843277645186953, 0.8446919473172456, 0.8460178555643949, 0.8473437638115442, 0.8482277026429771, 0.8499071864226996, 0.8507911252541324, 0.8513214885529922, 0.852205427384425, 0.8528241845664281, 0.8537965172810041, 0.8542384866967205, 0.8547688499955803, 0.8553876071775833, 0.8558295765932997, 0.8560947582427296, 0.8570670909573057, 0.8576858481393088, 0.8582162114381685, 0.8586581808538849, 0.8590117563864581, 0.8596305135684611, 0.8601608768673208, 0.8608680279324671, 0.8613983912313268, 0.8621055422964731, 0.8629010872447627, 0.8636966321930523, 0.864226995491912, 0.8649341465570582, 0.8651993282064881, 0.8654645098559179, 0.8658180853884911, 0.8663484486873508, 0.8667904181030672, 0.8671439936356404, 0.8674091752850702, 0.8675859630513568, 0.8677627508176434, 0.8683815079996464, 0.8688234774153628, 0.8690886590647927, 0.8694422345973659, 0.869795810129939, 0.8698842040130823, 0.8701493856625122, 0.8703261734287987, 0.8705913550782286, 0.8706797489613719, 0.8708565367276584, 0.8709449306108017, 0.8713869000265182, 0.8714752939096615, 0.871652081675948, 0.8720056572085212, 0.8720940510916645, 0.8724476266242376, 0.8727128082736675, 0.8730663838062406, 0.8735083532219571, 0.8735967471051004, 0.8737735348713869, 0.8743038981702467, 0.8744806859365332, 0.8744806859365332, 0.8744806859365332, 0.8747458675859631, 0.8749226553522497, 0.8750994431185362, 0.8753646247679661, 0.8755414125342527, 0.8755414125342527, 0.8757182003005392, 0.875983381949969, 0.875983381949969, 0.876248563599399, 0.876867320781402, 0.8770441085476886, 0.877220896313975, 0.8773976840802616]
2023-06-22 04:21:17,104 - __main__ - INFO - writing new test top-k
2023-06-22 04:21:17,104 - __main__ - INFO - writing new test data
2023-06-22 04:21:19,166 - __main__ - INFO -  global_step = 6000
2023-06-22 09:53:36,537 - __main__ - INFO - Training/evaluation parameters Namespace(model_type='nghuyong/ernie-2.0-base-en', model_name_or_path='../TQ/triviaqa_fintinue.pkl', model_name_or_path_ict=None, output_dir='output/co_training_tq_simANS_test', num_epoch=0, config_name='', tokenizer_name='', corpus_path='', max_seq_length=256, max_query_length=32, triplet=False, log_dir='tensorboard_log/co_training_tq_simANS_test', optimizer='adamW', per_gpu_train_batch_size=8, gradient_accumulation_steps=1, learning_rate=2e-06, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=2.0, max_steps=10000, warmup_steps=1000, logging_steps=100, save_steps=2000, no_cuda=False, seed=42, fp16=False, fp16_opt_level='O1', gradient_checkpointing=True, contr_loss=False, normal_loss=True, origin_data_dir='output/co_training_tq_simANS_test/temp/train_ce.json', load_optimizer_scheduler=False, single_warmup=True, adv_data_path=None, ann_data_path=None, fix_embedding=False, continue_train=False, adv_loss_alpha=0.3, reranker_model_path='../TQ/checkpoint-reranker34000', reranker_model_type='nghuyong/ernie-2.0-large-en', number_neg=15, adv_lambda=0.0, adv_steps=3, local_rank=0, server_ip='', server_port='', test_qa_path='', train_qa_path='', dev_qa_path='', passage_path='', iteration_step=2000, iteration_reranker_step=500, temperature_normal=1.0, scale_simmila=False, reranker_learning_rate=5e-07, load_cache=False, ann_dir='output/co_training_tq_simANS_test/temp', normal_term='cross_e', global_step=6000, a=0.5, b=0, n_gpu=1, device=device(type='cuda', index=0), world_size=4, rank=0)
2023-06-22 09:53:38,378 - __main__ - INFO - Loading checkpoint @ step=6000
2023-06-22 09:53:38,378 - __main__ - INFO - Loading saved model state ...
2023-06-22 09:53:48,677 - __main__ - INFO - Loading checkpoint @ step=6000
2023-06-22 09:53:48,677 - __main__ - INFO - Loading saved model state ...
2023-06-22 09:54:03,129 - __main__ - INFO - ***** Running training *****
2023-06-22 09:54:03,129 - __main__ - INFO -   Max steps = 10000
2023-06-22 09:54:03,129 - __main__ - INFO -   Instantaneous batch size per GPU = 8
2023-06-22 09:54:03,129 - __main__ - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 32
2023-06-22 09:54:03,129 - __main__ - INFO -   Gradient Accumulation steps = 1
2023-06-22 09:54:03,129 - __main__ - INFO -   Dataset example num = 70152
2023-06-22 09:54:03,129 - __main__ - INFO -   step each epoch = 8769
2023-06-22 10:07:10,478 - __main__ - INFO - {"learning_rate": 8.897777777777777e-07, "loss": 0.15786733105808765, "normal_loss": 0.0, "contr_loss": 0.15786733105808765, "step": 6100}
2023-06-22 10:20:16,622 - __main__ - INFO - {"learning_rate": 8.897777777777777e-07, "loss": 0.11055485790280954, "normal_loss": 0.0, "contr_loss": 0.11055485790280954, "step": 6200}
2023-06-22 10:33:24,390 - __main__ - INFO - {"learning_rate": 8.897777777777777e-07, "loss": 0.0723255458196354, "normal_loss": 0.0, "contr_loss": 0.0723255458196354, "step": 6300}
2023-06-22 10:46:39,184 - __main__ - INFO - {"learning_rate": 8.897777777777777e-07, "loss": 0.139963535672141, "normal_loss": 0.0, "contr_loss": 0.139963535672141, "step": 6400}
2023-06-22 10:59:54,596 - __main__ - INFO - {"learning_rate": 8.897777777777777e-07, "loss": 0.11966387562462501, "normal_loss": 0.0, "contr_loss": 0.11966387562462501, "step": 6500}
2023-06-22 11:07:00,107 - __main__ - INFO - {"learning_rate": 8.604444444444445e-07, "loss": 0.2598319694737438, "normal_loss": 0.25935652769752776, "contr_loss": 0.0004754417762160301, "step": 6600}
2023-06-22 11:14:03,267 - __main__ - INFO - {"learning_rate": 8.308148148148148e-07, "loss": 0.21856493443017824, "normal_loss": 0.21856493443017824, "contr_loss": 0.0, "step": 6700}
2023-06-22 11:21:04,645 - __main__ - INFO - {"learning_rate": 8.011851851851852e-07, "loss": 0.1929358327272348, "normal_loss": 0.1929358327272348, "contr_loss": 0.0, "step": 6800}
2023-06-22 11:28:05,588 - __main__ - INFO - {"learning_rate": 7.715555555555555e-07, "loss": 0.21368605588329956, "normal_loss": 0.21368605588329956, "contr_loss": 0.0, "step": 6900}
2023-06-22 11:35:10,145 - __main__ - INFO - {"learning_rate": 7.419259259259259e-07, "loss": 0.20557489569589962, "normal_loss": 0.20557489569589962, "contr_loss": 0.0, "step": 7000}
2023-06-22 11:42:14,152 - __main__ - INFO - {"learning_rate": 7.122962962962963e-07, "loss": 0.1813682835927466, "normal_loss": 0.1813682835927466, "contr_loss": 0.0, "step": 7100}
2023-06-22 11:49:15,523 - __main__ - INFO - {"learning_rate": 6.826666666666666e-07, "loss": 0.20213351576538116, "normal_loss": 0.20213351576538116, "contr_loss": 0.0, "step": 7200}
2023-06-22 11:56:19,387 - __main__ - INFO - {"learning_rate": 6.530370370370371e-07, "loss": 0.15800157166318968, "normal_loss": 0.15800157166318968, "contr_loss": 0.0, "step": 7300}
2023-06-22 12:03:17,650 - __main__ - INFO - {"learning_rate": 6.234074074074074e-07, "loss": 0.2013927852944471, "normal_loss": 0.2013927852944471, "contr_loss": 0.0, "step": 7400}
2023-06-22 12:10:21,075 - __main__ - INFO - {"learning_rate": 5.937777777777777e-07, "loss": 0.2834764101263136, "normal_loss": 0.2834764101263136, "contr_loss": 0.0, "step": 7500}
2023-06-22 12:17:22,910 - __main__ - INFO - {"learning_rate": 5.641481481481482e-07, "loss": 0.17598263739433606, "normal_loss": 0.17598263739433606, "contr_loss": 0.0, "step": 7600}
2023-06-22 12:24:27,954 - __main__ - INFO - {"learning_rate": 5.345185185185185e-07, "loss": 0.19778349645319396, "normal_loss": 0.19778349645319396, "contr_loss": 0.0, "step": 7700}
2023-06-22 12:31:30,987 - __main__ - INFO - {"learning_rate": 5.048888888888889e-07, "loss": 0.17279679427156225, "normal_loss": 0.17279679427156225, "contr_loss": 0.0, "step": 7800}
2023-06-22 12:38:33,866 - __main__ - INFO - {"learning_rate": 4.7525925925925926e-07, "loss": 0.16043156304833248, "normal_loss": 0.16043156304833248, "contr_loss": 0.0, "step": 7900}
2023-06-22 12:45:35,534 - __main__ - INFO - {"learning_rate": 4.4562962962962964e-07, "loss": 0.20430268210649957, "normal_loss": 0.20430268210649957, "contr_loss": 0.0, "step": 8000}
2023-06-22 12:45:41,473 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint
2023-06-22 12:45:51,538 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint-reranker
2023-06-22 12:45:54,462 - __main__ - INFO -  global_step = 8000
2023-06-22 12:46:23,463 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-22 12:50:05,644 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-22 12:50:05,715 - __main__ - INFO - Embedding generation for 5253831 passages from idx 0 to 5253831
2023-06-22 12:50:21,217 - __main__ - INFO - Encoded passages 512
2023-06-22 12:53:51,206 - __main__ - INFO - Encoded passages 51712
2023-06-22 12:57:21,826 - __main__ - INFO - Encoded passages 102912
2023-06-22 13:00:52,507 - __main__ - INFO - Encoded passages 154112
2023-06-22 13:04:23,069 - __main__ - INFO - Encoded passages 205312
2023-06-22 13:07:53,645 - __main__ - INFO - Encoded passages 256512
2023-06-22 13:11:24,233 - __main__ - INFO - Encoded passages 307712
2023-06-22 13:14:54,827 - __main__ - INFO - Encoded passages 358912
2023-06-22 13:18:25,378 - __main__ - INFO - Encoded passages 410112
2023-06-22 13:21:55,906 - __main__ - INFO - Encoded passages 461312
2023-06-22 13:25:26,432 - __main__ - INFO - Encoded passages 512512
2023-06-22 13:28:56,951 - __main__ - INFO - Encoded passages 563712
2023-06-22 13:32:27,465 - __main__ - INFO - Encoded passages 614912
2023-06-22 13:35:57,968 - __main__ - INFO - Encoded passages 666112
2023-06-22 13:39:28,474 - __main__ - INFO - Encoded passages 717312
2023-06-22 13:42:58,983 - __main__ - INFO - Encoded passages 768512
2023-06-22 13:46:29,540 - __main__ - INFO - Encoded passages 819712
2023-06-22 13:50:00,046 - __main__ - INFO - Encoded passages 870912
2023-06-22 13:53:30,584 - __main__ - INFO - Encoded passages 922112
2023-06-22 13:57:01,102 - __main__ - INFO - Encoded passages 973312
2023-06-22 14:00:31,631 - __main__ - INFO - Encoded passages 1024512
2023-06-22 14:04:02,074 - __main__ - INFO - Encoded passages 1075712
2023-06-22 14:07:32,628 - __main__ - INFO - Encoded passages 1126912
2023-06-22 14:11:03,240 - __main__ - INFO - Encoded passages 1178112
2023-06-22 14:14:33,813 - __main__ - INFO - Encoded passages 1229312
2023-06-22 14:18:04,342 - __main__ - INFO - Encoded passages 1280512
2023-06-22 14:20:31,794 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_0.pb.
2023-06-22 14:20:42,653 - __main__ - INFO - Encoded passages 512
2023-06-22 14:24:13,329 - __main__ - INFO - Encoded passages 51712
2023-06-22 14:27:44,041 - __main__ - INFO - Encoded passages 102912
2023-06-22 14:31:14,691 - __main__ - INFO - Encoded passages 154112
2023-06-22 14:34:45,331 - __main__ - INFO - Encoded passages 205312
2023-06-22 14:38:15,905 - __main__ - INFO - Encoded passages 256512
2023-06-22 14:41:46,489 - __main__ - INFO - Encoded passages 307712
2023-06-22 14:45:17,147 - __main__ - INFO - Encoded passages 358912
2023-06-22 14:48:47,755 - __main__ - INFO - Encoded passages 410112
2023-06-22 14:52:18,324 - __main__ - INFO - Encoded passages 461312
2023-06-22 14:55:48,900 - __main__ - INFO - Encoded passages 512512
2023-06-22 14:59:19,477 - __main__ - INFO - Encoded passages 563712
2023-06-22 15:02:50,042 - __main__ - INFO - Encoded passages 614912
2023-06-22 15:06:20,706 - __main__ - INFO - Encoded passages 666112
2023-06-22 15:09:51,344 - __main__ - INFO - Encoded passages 717312
2023-06-22 15:13:21,931 - __main__ - INFO - Encoded passages 768512
2023-06-22 15:16:52,535 - __main__ - INFO - Encoded passages 819712
2023-06-22 15:20:23,149 - __main__ - INFO - Encoded passages 870912
2023-06-22 15:23:53,767 - __main__ - INFO - Encoded passages 922112
2023-06-22 15:27:24,416 - __main__ - INFO - Encoded passages 973312
2023-06-22 15:30:54,991 - __main__ - INFO - Encoded passages 1024512
2023-06-22 15:34:25,597 - __main__ - INFO - Encoded passages 1075712
2023-06-22 15:37:56,242 - __main__ - INFO - Encoded passages 1126912
2023-06-22 15:41:26,852 - __main__ - INFO - Encoded passages 1178112
2023-06-22 15:44:57,466 - __main__ - INFO - Encoded passages 1229312
2023-06-22 15:48:28,042 - __main__ - INFO - Encoded passages 1280512
2023-06-22 15:50:57,755 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_1.pb.
2023-06-22 15:51:08,304 - __main__ - INFO - Encoded passages 512
2023-06-22 15:54:39,001 - __main__ - INFO - Encoded passages 51712
2023-06-22 15:58:09,676 - __main__ - INFO - Encoded passages 102912
2023-06-22 16:01:40,303 - __main__ - INFO - Encoded passages 154112
2023-06-22 16:05:10,880 - __main__ - INFO - Encoded passages 205312
2023-06-22 16:08:41,510 - __main__ - INFO - Encoded passages 256512
2023-06-22 16:12:12,177 - __main__ - INFO - Encoded passages 307712
2023-06-22 16:15:42,741 - __main__ - INFO - Encoded passages 358912
2023-06-22 16:19:13,302 - __main__ - INFO - Encoded passages 410112
2023-06-22 16:22:43,862 - __main__ - INFO - Encoded passages 461312
2023-06-22 16:26:14,410 - __main__ - INFO - Encoded passages 512512
2023-06-22 16:29:44,928 - __main__ - INFO - Encoded passages 563712
2023-06-22 16:33:15,487 - __main__ - INFO - Encoded passages 614912
2023-06-22 16:36:46,076 - __main__ - INFO - Encoded passages 666112
2023-06-22 16:40:16,642 - __main__ - INFO - Encoded passages 717312
2023-06-22 16:43:47,253 - __main__ - INFO - Encoded passages 768512
2023-06-22 16:47:17,962 - __main__ - INFO - Encoded passages 819712
2023-06-22 16:50:48,569 - __main__ - INFO - Encoded passages 870912
2023-06-22 16:54:19,219 - __main__ - INFO - Encoded passages 922112
2023-06-22 16:57:49,820 - __main__ - INFO - Encoded passages 973312
2023-06-22 17:01:20,405 - __main__ - INFO - Encoded passages 1024512
2023-06-22 17:04:51,036 - __main__ - INFO - Encoded passages 1075712
2023-06-22 17:08:21,700 - __main__ - INFO - Encoded passages 1126912
2023-06-22 17:11:52,380 - __main__ - INFO - Encoded passages 1178112
2023-06-22 17:15:23,001 - __main__ - INFO - Encoded passages 1229312
2023-06-22 17:18:53,597 - __main__ - INFO - Encoded passages 1280512
2023-06-22 17:21:23,064 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_2.pb.
2023-06-22 17:21:32,260 - __main__ - INFO - Encoded passages 512
2023-06-22 17:25:02,988 - __main__ - INFO - Encoded passages 51712
2023-06-22 17:28:33,700 - __main__ - INFO - Encoded passages 102912
2023-06-22 17:32:04,289 - __main__ - INFO - Encoded passages 154112
2023-06-22 17:35:34,876 - __main__ - INFO - Encoded passages 205312
2023-06-22 17:39:05,446 - __main__ - INFO - Encoded passages 256512
2023-06-22 17:42:36,039 - __main__ - INFO - Encoded passages 307712
2023-06-22 17:46:06,706 - __main__ - INFO - Encoded passages 358912
2023-06-22 17:49:37,402 - __main__ - INFO - Encoded passages 410112
2023-06-22 17:53:08,049 - __main__ - INFO - Encoded passages 461312
2023-06-22 17:56:38,684 - __main__ - INFO - Encoded passages 512512
2023-06-22 18:00:09,260 - __main__ - INFO - Encoded passages 563712
2023-06-22 18:03:39,803 - __main__ - INFO - Encoded passages 614912
2023-06-22 18:07:10,450 - __main__ - INFO - Encoded passages 666112
2023-06-22 18:10:41,082 - __main__ - INFO - Encoded passages 717312
2023-06-22 18:14:11,708 - __main__ - INFO - Encoded passages 768512
2023-06-22 18:17:42,292 - __main__ - INFO - Encoded passages 819712
2023-06-22 18:21:12,912 - __main__ - INFO - Encoded passages 870912
2023-06-22 18:24:43,501 - __main__ - INFO - Encoded passages 922112
2023-06-22 18:28:14,097 - __main__ - INFO - Encoded passages 973312
2023-06-22 18:31:44,664 - __main__ - INFO - Encoded passages 1024512
2023-06-22 18:35:15,252 - __main__ - INFO - Encoded passages 1075712
2023-06-22 18:38:45,839 - __main__ - INFO - Encoded passages 1126912
2023-06-22 18:42:16,407 - __main__ - INFO - Encoded passages 1178112
2023-06-22 18:45:47,021 - __main__ - INFO - Encoded passages 1229312
2023-06-22 18:49:17,677 - __main__ - INFO - Encoded passages 1280512
2023-06-22 18:51:45,207 - __main__ - INFO - Total passages processed 1313460. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_3.pb.
2023-06-22 18:51:45,609 - __main__ - INFO -  global_step = 8000
2023-06-22 18:56:56,986 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-22 18:59:53,609 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-22 18:59:53,610 - __main__ - INFO - load_passage_begin
2023-06-22 19:00:31,988 - __main__ - INFO - load_passage_id_begin
2023-06-22 19:01:19,418 - __main__ - INFO - load_passage_done
2023-06-22 19:01:21,323 - __main__ - INFO - Loadingtrainanswers
2023-06-22 19:01:32,945 - __main__ - INFO - Encoded question 512
2023-06-22 19:02:48,319 - __main__ - INFO - Loadingdevanswers
2023-06-22 19:02:56,817 - __main__ - INFO - Encoded question 512
2023-06-22 19:03:06,687 - __main__ - INFO - Loadingtestanswers
2023-06-22 19:03:15,119 - __main__ - INFO - Encoded question 512
2023-06-22 19:03:28,213 - __main__ - INFO - ***** Begin passage_embedding reorder *****
2023-06-22 19:04:27,877 - __main__ - INFO - ***** end passage_embedding reorder  *****
2023-06-22 19:04:34,559 - __main__ - INFO - ***** begin add passages  *****
2023-06-22 19:11:10,131 - __main__ - INFO - ***** end build index  *****
2023-06-22 19:15:21,858 - __main__ - INFO - Per question validation results len=78785
2023-06-22 19:15:22,274 - __main__ - INFO - Validation results: top k documents hits [64077, 66309, 67224, 67643, 67922, 68120, 68274, 68397, 68495, 68579, 68642, 68686, 68743, 68783, 68828, 68864, 68896, 68943, 68969, 69003, 69032, 69054, 69079, 69103, 69124, 69141, 69168, 69184, 69203, 69221, 69235, 69252, 69274, 69288, 69296, 69309, 69321, 69333, 69351, 69362, 69371, 69383, 69394, 69407, 69413, 69427, 69438, 69448, 69458, 69466, 69471, 69478, 69483, 69487, 69498, 69502, 69509, 69512, 69517, 69522, 69530, 69539, 69541, 69546, 69552, 69559, 69563, 69567, 69572, 69575, 69585, 69589, 69593, 69598, 69603, 69612, 69617, 69619, 69623, 69626, 69630, 69634, 69643, 69645, 69647, 69653, 69655, 69659, 69664, 69668, 69669, 69675, 69677, 69679, 69684, 69688, 69692, 69695, 69700, 69703]
2023-06-22 19:15:22,275 - __main__ - INFO - Validation results: top k documents hits accuracy [0.8133147172685156, 0.8416449831820778, 0.8532588690740623, 0.8585771403185886, 0.8621184235577839, 0.8646315923081805, 0.8665862791140445, 0.8681474900044425, 0.8693913816081742, 0.8704575744113727, 0.8712572190137716, 0.8718157009583043, 0.8725391889319033, 0.8730468997905693, 0.8736180745065685, 0.8740750142793678, 0.8744811829663007, 0.8750777432252332, 0.8754077552833661, 0.8758393095132322, 0.876207399885765, 0.8764866408580313, 0.8768039601446976, 0.8771085866598972, 0.8773751348606968, 0.8775909119756299, 0.8779336168052294, 0.8781367011486958, 0.8783778638065621, 0.8786063336929618, 0.8787840324934949, 0.878999809608428, 0.8792790505806943, 0.8794567493812274, 0.8795582915529606, 0.879723297582027, 0.8798756108396268, 0.8800279240972266, 0.8802563939836263, 0.8803960144697595, 0.8805102494129593, 0.8806625626705591, 0.8808021831566922, 0.8809671891857587, 0.8810433458145586, 0.8812210446150917, 0.8813606651012249, 0.8814875928158914, 0.8816145205305579, 0.8817160627022911, 0.8817795265596243, 0.8818683759598909, 0.8819318398172241, 0.8819826109030907, 0.8821222313892239, 0.8821730024750905, 0.882261851875357, 0.8822999301897569, 0.8823633940470902, 0.8824268579044234, 0.8825284000761566, 0.8826426350193565, 0.8826680205622898, 0.882731484419623, 0.8828076410484229, 0.8828964904486895, 0.882947261534556, 0.8829980326204226, 0.8830614964777559, 0.8830995747921558, 0.8832265025068223, 0.8832772735926889, 0.8833280446785555, 0.8833915085358888, 0.883454972393222, 0.8835692073364219, 0.8836326711937551, 0.8836580567366884, 0.8837088278225551, 0.8837469061369551, 0.8837976772228217, 0.8838484483086883, 0.8839626832518881, 0.8839880687948214, 0.8840134543377547, 0.8840896109665546, 0.8841149965094879, 0.8841657675953545, 0.8842292314526877, 0.8842800025385543, 0.884292695310021, 0.8843688519388209, 0.8843942374817542, 0.8844196230246875, 0.8844830868820207, 0.8845338579678873, 0.8845846290537539, 0.8846227073681538, 0.8846861712254871, 0.884724249539887]
2023-06-22 19:15:36,938 - __main__ - INFO - writing new train top-k
2023-06-22 19:15:36,939 - __main__ - INFO - writing new train data
2023-06-22 19:18:02,565 - __main__ - INFO - Per question validation results len=8837
2023-06-22 19:18:02,625 - __main__ - INFO - Validation results: top k documents hits [5660, 6243, 6542, 6733, 6868, 6961, 7032, 7087, 7141, 7174, 7214, 7240, 7273, 7301, 7321, 7339, 7360, 7377, 7395, 7407, 7424, 7438, 7448, 7460, 7466, 7473, 7478, 7486, 7494, 7500, 7515, 7520, 7525, 7536, 7545, 7552, 7558, 7567, 7577, 7581, 7591, 7596, 7602, 7605, 7608, 7614, 7614, 7620, 7623, 7626, 7629, 7633, 7637, 7641, 7647, 7647, 7651, 7653, 7657, 7659, 7661, 7667, 7668, 7668, 7670, 7674, 7674, 7675, 7676, 7680, 7682, 7684, 7687, 7693, 7694, 7694, 7696, 7697, 7700, 7701, 7704, 7705, 7711, 7711, 7713, 7715, 7718, 7719, 7719, 7721, 7723, 7724, 7725, 7726, 7728, 7730, 7732, 7734, 7734, 7736]
2023-06-22 19:18:02,625 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6404888536833767, 0.7064614688242616, 0.740296480706122, 0.7619101505035646, 0.7771868281090868, 0.7877107615706688, 0.7957451623854249, 0.8019689940024896, 0.8080796650446984, 0.8118139640149372, 0.816340387009166, 0.8192825619554147, 0.8230168609256535, 0.8261853570216137, 0.8284485685187281, 0.830485458866131, 0.8328618309381012, 0.8347855607106484, 0.8368224510580514, 0.83818037795632, 0.8401041077288672, 0.8416883557768473, 0.8428199615254045, 0.8441778884236731, 0.8448568518728076, 0.8456489758967976, 0.8462147787710762, 0.847120063369922, 0.8480253479687677, 0.848704311417902, 0.8504017200407378, 0.8509675229150164, 0.851533325789295, 0.8527780921127079, 0.8537965372864094, 0.8545886613103995, 0.8552676247595338, 0.8562860699332353, 0.8574176756817925, 0.8578703179812154, 0.8590019237297726, 0.8595677266040511, 0.8602466900531854, 0.8605861717777527, 0.8609256535023198, 0.8616046169514541, 0.8616046169514541, 0.8622835804005884, 0.8626230621251556, 0.8629625438497227, 0.8633020255742899, 0.8637546678737128, 0.8642073101731357, 0.8646599524725586, 0.8653389159216929, 0.8653389159216929, 0.8657915582211158, 0.8660178793708272, 0.8664705216702501, 0.8666968428199615, 0.866923163969673, 0.8676021274188073, 0.867715287993663, 0.867715287993663, 0.8679416091433745, 0.8683942514427974, 0.8683942514427974, 0.868507412017653, 0.8686205725925088, 0.8690732148919317, 0.8692995360416431, 0.8695258571913546, 0.8698653389159217, 0.870544302365056, 0.8706574629399118, 0.8706574629399118, 0.8708837840896232, 0.8709969446644789, 0.8713364263890461, 0.8714495869639017, 0.871789068688469, 0.8719022292633246, 0.8725811927124589, 0.8725811927124589, 0.8728075138621704, 0.8730338350118818, 0.873373316736449, 0.8734864773113047, 0.8734864773113047, 0.8737127984610161, 0.8739391196107277, 0.8740522801855833, 0.8741654407604391, 0.8742786013352948, 0.8745049224850062, 0.8747312436347177, 0.8749575647844291, 0.8751838859341405, 0.8751838859341405, 0.875410207083852]
2023-06-22 19:18:11,320 - __main__ - INFO - writing new dev top-k
2023-06-22 19:18:11,320 - __main__ - INFO - writing new dev data
2023-06-22 19:19:20,618 - __main__ - INFO - Per question validation results len=11313
2023-06-22 19:19:20,690 - __main__ - INFO - Validation results: top k documents hits [7235, 8026, 8412, 8643, 8818, 8920, 9010, 9091, 9150, 9212, 9258, 9299, 9344, 9368, 9391, 9421, 9446, 9468, 9479, 9498, 9513, 9528, 9540, 9554, 9565, 9578, 9592, 9600, 9610, 9620, 9636, 9646, 9650, 9654, 9666, 9674, 9680, 9684, 9691, 9698, 9708, 9712, 9717, 9723, 9732, 9742, 9748, 9750, 9752, 9759, 9763, 9767, 9774, 9783, 9788, 9790, 9795, 9800, 9804, 9807, 9813, 9815, 9819, 9823, 9829, 9835, 9838, 9841, 9843, 9845, 9846, 9846, 9849, 9852, 9858, 9862, 9863, 9863, 9866, 9867, 9871, 9876, 9878, 9879, 9881, 9884, 9888, 9890, 9893, 9896, 9897, 9897, 9898, 9900, 9903, 9907, 9911, 9914, 9916, 9918]
2023-06-22 19:19:20,691 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6395297445416778, 0.7094493061080174, 0.7435693450013259, 0.7639883320074251, 0.7794572615575002, 0.7884734376381154, 0.7964288871210112, 0.8035887916556175, 0.8088040307610713, 0.8142844515159551, 0.8183505701405462, 0.821974719349421, 0.8259524440908689, 0.8280738972863078, 0.8301069565986033, 0.8327587730929019, 0.8349686201714841, 0.8369132856006364, 0.8378856183152126, 0.8395651020949351, 0.8408910103420844, 0.8422169185892336, 0.843277645186953, 0.8445151595509591, 0.8454874922655352, 0.8466366127463979, 0.847874127110404, 0.8485812781755503, 0.8494652170069831, 0.850349155838416, 0.8517634579687086, 0.8526473968001415, 0.8530009723327145, 0.8533545478652877, 0.8544152744630071, 0.8551224255281534, 0.8556527888270131, 0.8560063643595863, 0.8566251215415893, 0.8572438787235923, 0.8581278175550252, 0.8584813930875983, 0.8589233625033148, 0.8594537258021745, 0.8602492707504641, 0.861133209581897, 0.8616635728807567, 0.8618403606470433, 0.8620171484133298, 0.8626359055953328, 0.862989481127906, 0.8633430566604791, 0.863961813842482, 0.8647573587907716, 0.8651993282064881, 0.8653761159727746, 0.8658180853884911, 0.8662600548042075, 0.8666136303367807, 0.8668788119862105, 0.8674091752850702, 0.8675859630513568, 0.86793953858393, 0.8682931141165031, 0.8688234774153628, 0.8693538407142226, 0.8696190223636524, 0.8698842040130823, 0.8700609917793689, 0.8702377795456554, 0.8703261734287987, 0.8703261734287987, 0.8705913550782286, 0.8708565367276584, 0.8713869000265182, 0.8717404755590913, 0.8718288694422346, 0.8718288694422346, 0.8720940510916645, 0.8721824449748078, 0.8725360205073809, 0.8729779899230973, 0.8731547776893839, 0.8732431715725272, 0.8734199593388138, 0.8736851409882436, 0.8740387165208168, 0.8742155042871034, 0.8744806859365332, 0.8747458675859631, 0.8748342614691064, 0.8748342614691064, 0.8749226553522497, 0.8750994431185362, 0.8753646247679661, 0.8757182003005392, 0.8760717758331124, 0.8763369574825423, 0.8765137452488287, 0.8766905330151153]
2023-06-22 19:19:29,818 - __main__ - INFO - writing new test top-k
2023-06-22 19:19:29,819 - __main__ - INFO - writing new test data
2023-06-22 19:19:31,802 - __main__ - INFO -  global_step = 8000
2023-06-23 00:23:44,344 - __main__ - INFO - Training/evaluation parameters Namespace(model_type='nghuyong/ernie-2.0-base-en', model_name_or_path='../TQ/triviaqa_fintinue.pkl', model_name_or_path_ict=None, output_dir='output/co_training_tq_simANS_test', num_epoch=0, config_name='', tokenizer_name='', corpus_path='', max_seq_length=256, max_query_length=32, triplet=False, log_dir='tensorboard_log/co_training_tq_simANS_test', optimizer='adamW', per_gpu_train_batch_size=8, gradient_accumulation_steps=1, learning_rate=2e-06, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=2.0, max_steps=10000, warmup_steps=1000, logging_steps=100, save_steps=2000, no_cuda=False, seed=42, fp16=False, fp16_opt_level='O1', gradient_checkpointing=True, contr_loss=False, normal_loss=True, origin_data_dir='output/co_training_tq_simANS_test/temp/train_ce.json', load_optimizer_scheduler=False, single_warmup=True, adv_data_path=None, ann_data_path=None, fix_embedding=False, continue_train=False, adv_loss_alpha=0.3, reranker_model_path='../TQ/checkpoint-reranker34000', reranker_model_type='nghuyong/ernie-2.0-large-en', number_neg=15, adv_lambda=0.0, adv_steps=3, local_rank=0, server_ip='', server_port='', test_qa_path='', train_qa_path='', dev_qa_path='', passage_path='', iteration_step=2000, iteration_reranker_step=500, temperature_normal=1.0, scale_simmila=False, reranker_learning_rate=5e-07, load_cache=False, ann_dir='output/co_training_tq_simANS_test/temp', normal_term='cross_e', global_step=8000, a=0.5, b=0, n_gpu=1, device=device(type='cuda', index=0), world_size=4, rank=0)
2023-06-23 00:23:56,448 - __main__ - INFO - Loading checkpoint @ step=8000
2023-06-23 00:23:56,449 - __main__ - INFO - Loading saved model state ...
2023-06-23 00:24:09,373 - __main__ - INFO - Loading checkpoint @ step=8000
2023-06-23 00:24:09,373 - __main__ - INFO - Loading saved model state ...
2023-06-23 00:24:22,307 - __main__ - INFO - ***** Running training *****
2023-06-23 00:24:22,307 - __main__ - INFO -   Max steps = 10000
2023-06-23 00:24:22,307 - __main__ - INFO -   Instantaneous batch size per GPU = 8
2023-06-23 00:24:22,307 - __main__ - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 32
2023-06-23 00:24:22,307 - __main__ - INFO -   Gradient Accumulation steps = 1
2023-06-23 00:24:22,307 - __main__ - INFO -   Dataset example num = 70018
2023-06-23 00:24:22,307 - __main__ - INFO -   step each epoch = 8752
2023-06-23 00:35:26,264 - __main__ - INFO - {"learning_rate": 4.4562962962962964e-07, "loss": 0.16700019913924735, "normal_loss": 0.0, "contr_loss": 0.16700019913924735, "step": 8100}
2023-06-23 00:46:36,486 - __main__ - INFO - {"learning_rate": 4.4562962962962964e-07, "loss": 0.1641462570586009, "normal_loss": 0.0, "contr_loss": 0.1641462570586009, "step": 8200}
2023-06-23 00:57:45,898 - __main__ - INFO - {"learning_rate": 4.4562962962962964e-07, "loss": 0.11918128824861923, "normal_loss": 0.0, "contr_loss": 0.11918128824861923, "step": 8300}
2023-06-23 01:08:54,549 - __main__ - INFO - {"learning_rate": 4.4562962962962964e-07, "loss": 0.13757058336369027, "normal_loss": 0.0, "contr_loss": 0.13757058336369027, "step": 8400}
2023-06-23 01:20:04,686 - __main__ - INFO - {"learning_rate": 4.4562962962962964e-07, "loss": 0.1417523431718496, "normal_loss": 0.0, "contr_loss": 0.1417523431718496, "step": 8500}
2023-06-23 01:26:02,773 - __main__ - INFO - {"learning_rate": 4.1629629629629625e-07, "loss": 0.2827879758994095, "normal_loss": 0.2788585575739853, "contr_loss": 0.003929418325424194, "step": 8600}
2023-06-23 01:31:59,072 - __main__ - INFO - {"learning_rate": 3.8666666666666664e-07, "loss": 0.2833097451063804, "normal_loss": 0.2833097451063804, "contr_loss": 0.0, "step": 8700}
2023-06-23 01:37:54,483 - __main__ - INFO - {"learning_rate": 3.57037037037037e-07, "loss": 0.29279631572542714, "normal_loss": 0.29279631572542714, "contr_loss": 0.0, "step": 8800}
2023-06-23 01:43:46,408 - __main__ - INFO - {"learning_rate": 3.274074074074074e-07, "loss": 0.2633800274808891, "normal_loss": 0.2633800274808891, "contr_loss": 0.0, "step": 8900}
2023-06-23 01:49:36,062 - __main__ - INFO - {"learning_rate": 2.9777777777777773e-07, "loss": 0.2255022950482089, "normal_loss": 0.2255022950482089, "contr_loss": 0.0, "step": 9000}
2023-06-23 01:55:30,486 - __main__ - INFO - {"learning_rate": 2.681481481481481e-07, "loss": 0.21616173195187002, "normal_loss": 0.21616173195187002, "contr_loss": 0.0, "step": 9100}
2023-06-23 02:01:26,248 - __main__ - INFO - {"learning_rate": 2.385185185185185e-07, "loss": 0.24826039284467696, "normal_loss": 0.24826039284467696, "contr_loss": 0.0, "step": 9200}
2023-06-23 02:07:23,589 - __main__ - INFO - {"learning_rate": 2.088888888888889e-07, "loss": 0.23892687535611912, "normal_loss": 0.23892687535611912, "contr_loss": 0.0, "step": 9300}
2023-06-23 02:13:21,213 - __main__ - INFO - {"learning_rate": 1.7925925925925925e-07, "loss": 0.20181868400308303, "normal_loss": 0.20181868400308303, "contr_loss": 0.0, "step": 9400}
2023-06-23 02:19:20,674 - __main__ - INFO - {"learning_rate": 1.4962962962962963e-07, "loss": 0.25531283740187066, "normal_loss": 0.25531283740187066, "contr_loss": 0.0, "step": 9500}
2023-06-23 02:25:16,827 - __main__ - INFO - {"learning_rate": 1.2e-07, "loss": 0.2821908562275348, "normal_loss": 0.2821908562275348, "contr_loss": 0.0, "step": 9600}
2023-06-23 02:31:08,674 - __main__ - INFO - {"learning_rate": 9.037037037037036e-08, "loss": 0.2518730505986605, "normal_loss": 0.2518730505986605, "contr_loss": 0.0, "step": 9700}
2023-06-23 02:37:01,185 - __main__ - INFO - {"learning_rate": 6.074074074074074e-08, "loss": 0.2621626984688919, "normal_loss": 0.2621626984688919, "contr_loss": 0.0, "step": 9800}
2023-06-23 02:42:55,227 - __main__ - INFO - {"learning_rate": 3.111111111111111e-08, "loss": 0.2385303244413808, "normal_loss": 0.2385303244413808, "contr_loss": 0.0, "step": 9900}
2023-06-23 02:48:51,415 - __main__ - INFO - {"learning_rate": 1.4814814814814814e-09, "loss": 0.20115613625384868, "normal_loss": 0.20115613625384868, "contr_loss": 0.0, "step": 10000}
2023-06-23 02:48:57,742 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint
2023-06-23 02:49:06,165 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint-reranker
2023-06-23 02:49:08,848 - __main__ - INFO -  global_step = 10000
2023-06-23 02:49:38,743 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-23 02:53:01,291 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-23 02:53:01,367 - __main__ - INFO - Embedding generation for 5253831 passages from idx 0 to 5253831
2023-06-23 02:53:15,742 - __main__ - INFO - Encoded passages 512
2023-06-23 02:56:45,685 - __main__ - INFO - Encoded passages 51712
2023-06-23 03:00:16,213 - __main__ - INFO - Encoded passages 102912
2023-06-23 03:03:46,686 - __main__ - INFO - Encoded passages 154112
2023-06-23 03:07:17,314 - __main__ - INFO - Encoded passages 205312
2023-06-23 03:10:47,903 - __main__ - INFO - Encoded passages 256512
2023-06-23 03:14:18,380 - __main__ - INFO - Encoded passages 307712
2023-06-23 03:17:48,857 - __main__ - INFO - Encoded passages 358912
2023-06-23 03:21:19,328 - __main__ - INFO - Encoded passages 410112
2023-06-23 03:24:49,821 - __main__ - INFO - Encoded passages 461312
2023-06-23 03:28:20,285 - __main__ - INFO - Encoded passages 512512
2023-06-23 03:31:50,756 - __main__ - INFO - Encoded passages 563712
2023-06-23 03:35:21,262 - __main__ - INFO - Encoded passages 614912
2023-06-23 03:38:51,715 - __main__ - INFO - Encoded passages 666112
2023-06-23 03:42:22,267 - __main__ - INFO - Encoded passages 717312
2023-06-23 03:45:52,748 - __main__ - INFO - Encoded passages 768512
2023-06-23 03:49:23,226 - __main__ - INFO - Encoded passages 819712
2023-06-23 03:52:53,672 - __main__ - INFO - Encoded passages 870912
2023-06-23 03:56:24,163 - __main__ - INFO - Encoded passages 922112
2023-06-23 03:59:54,696 - __main__ - INFO - Encoded passages 973312
2023-06-23 04:03:25,261 - __main__ - INFO - Encoded passages 1024512
2023-06-23 04:06:55,755 - __main__ - INFO - Encoded passages 1075712
2023-06-23 04:10:26,212 - __main__ - INFO - Encoded passages 1126912
2023-06-23 04:13:56,757 - __main__ - INFO - Encoded passages 1178112
2023-06-23 04:17:27,264 - __main__ - INFO - Encoded passages 1229312
2023-06-23 04:20:57,771 - __main__ - INFO - Encoded passages 1280512
2023-06-23 04:23:25,302 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_0.pb.
2023-06-23 04:23:36,015 - __main__ - INFO - Encoded passages 512
2023-06-23 04:27:06,672 - __main__ - INFO - Encoded passages 51712
2023-06-23 04:30:37,361 - __main__ - INFO - Encoded passages 102912
2023-06-23 04:34:07,975 - __main__ - INFO - Encoded passages 154112
2023-06-23 04:37:38,586 - __main__ - INFO - Encoded passages 205312
2023-06-23 04:41:09,135 - __main__ - INFO - Encoded passages 256512
2023-06-23 04:44:39,808 - __main__ - INFO - Encoded passages 307712
2023-06-23 04:48:10,437 - __main__ - INFO - Encoded passages 358912
2023-06-23 04:51:41,053 - __main__ - INFO - Encoded passages 410112
2023-06-23 04:55:11,695 - __main__ - INFO - Encoded passages 461312
2023-06-23 04:58:42,404 - __main__ - INFO - Encoded passages 512512
2023-06-23 05:02:13,026 - __main__ - INFO - Encoded passages 563712
2023-06-23 05:05:43,671 - __main__ - INFO - Encoded passages 614912
2023-06-23 05:09:14,251 - __main__ - INFO - Encoded passages 666112
2023-06-23 05:12:44,777 - __main__ - INFO - Encoded passages 717312
2023-06-23 05:16:15,308 - __main__ - INFO - Encoded passages 768512
2023-06-23 05:19:45,923 - __main__ - INFO - Encoded passages 819712
2023-06-23 05:23:16,496 - __main__ - INFO - Encoded passages 870912
2023-06-23 05:26:47,018 - __main__ - INFO - Encoded passages 922112
2023-06-23 05:30:17,621 - __main__ - INFO - Encoded passages 973312
2023-06-23 05:33:48,165 - __main__ - INFO - Encoded passages 1024512
2023-06-23 05:37:18,727 - __main__ - INFO - Encoded passages 1075712
2023-06-23 05:40:49,304 - __main__ - INFO - Encoded passages 1126912
2023-06-23 05:44:19,821 - __main__ - INFO - Encoded passages 1178112
2023-06-23 05:47:50,427 - __main__ - INFO - Encoded passages 1229312
2023-06-23 05:51:21,037 - __main__ - INFO - Encoded passages 1280512
2023-06-23 05:53:49,381 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_1.pb.
2023-06-23 05:53:59,597 - __main__ - INFO - Encoded passages 512
2023-06-23 05:57:30,278 - __main__ - INFO - Encoded passages 51712
2023-06-23 06:01:00,980 - __main__ - INFO - Encoded passages 102912
2023-06-23 06:04:31,561 - __main__ - INFO - Encoded passages 154112
2023-06-23 06:08:02,147 - __main__ - INFO - Encoded passages 205312
2023-06-23 06:11:32,753 - __main__ - INFO - Encoded passages 256512
2023-06-23 06:15:03,333 - __main__ - INFO - Encoded passages 307712
2023-06-23 06:18:33,882 - __main__ - INFO - Encoded passages 358912
2023-06-23 06:22:04,429 - __main__ - INFO - Encoded passages 410112
2023-06-23 06:25:34,969 - __main__ - INFO - Encoded passages 461312
2023-06-23 06:29:05,616 - __main__ - INFO - Encoded passages 512512
2023-06-23 06:32:36,230 - __main__ - INFO - Encoded passages 563712
2023-06-23 06:36:06,846 - __main__ - INFO - Encoded passages 614912
2023-06-23 06:39:37,408 - __main__ - INFO - Encoded passages 666112
2023-06-23 06:43:07,984 - __main__ - INFO - Encoded passages 717312
2023-06-23 06:46:38,580 - __main__ - INFO - Encoded passages 768512
2023-06-23 06:50:09,210 - __main__ - INFO - Encoded passages 819712
2023-06-23 06:53:39,817 - __main__ - INFO - Encoded passages 870912
2023-06-23 06:57:10,433 - __main__ - INFO - Encoded passages 922112
2023-06-23 07:00:41,058 - __main__ - INFO - Encoded passages 973312
2023-06-23 07:04:11,658 - __main__ - INFO - Encoded passages 1024512
2023-06-23 07:07:42,205 - __main__ - INFO - Encoded passages 1075712
2023-06-23 07:11:12,856 - __main__ - INFO - Encoded passages 1126912
2023-06-23 07:14:43,468 - __main__ - INFO - Encoded passages 1178112
2023-06-23 07:18:14,062 - __main__ - INFO - Encoded passages 1229312
2023-06-23 07:21:44,649 - __main__ - INFO - Encoded passages 1280512
2023-06-23 07:24:14,559 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_2.pb.
2023-06-23 07:24:24,697 - __main__ - INFO - Encoded passages 512
2023-06-23 07:27:55,435 - __main__ - INFO - Encoded passages 51712
2023-06-23 07:31:26,097 - __main__ - INFO - Encoded passages 102912
2023-06-23 07:34:56,752 - __main__ - INFO - Encoded passages 154112
2023-06-23 07:38:27,337 - __main__ - INFO - Encoded passages 205312
2023-06-23 07:41:57,890 - __main__ - INFO - Encoded passages 256512
2023-06-23 07:45:28,463 - __main__ - INFO - Encoded passages 307712
2023-06-23 07:48:59,076 - __main__ - INFO - Encoded passages 358912
2023-06-23 07:52:29,681 - __main__ - INFO - Encoded passages 410112
2023-06-23 07:56:00,200 - __main__ - INFO - Encoded passages 461312
2023-06-23 07:59:30,772 - __main__ - INFO - Encoded passages 512512
2023-06-23 08:03:01,372 - __main__ - INFO - Encoded passages 563712
2023-06-23 08:06:32,014 - __main__ - INFO - Encoded passages 614912
2023-06-23 08:10:02,605 - __main__ - INFO - Encoded passages 666112
2023-06-23 08:13:33,194 - __main__ - INFO - Encoded passages 717312
2023-06-23 08:17:03,831 - __main__ - INFO - Encoded passages 768512
2023-06-23 08:20:34,430 - __main__ - INFO - Encoded passages 819712
2023-06-23 08:24:05,003 - __main__ - INFO - Encoded passages 870912
2023-06-23 08:27:35,597 - __main__ - INFO - Encoded passages 922112
2023-06-23 08:31:06,177 - __main__ - INFO - Encoded passages 973312
2023-06-23 08:34:36,736 - __main__ - INFO - Encoded passages 1024512
2023-06-23 08:38:07,350 - __main__ - INFO - Encoded passages 1075712
2023-06-23 08:41:37,970 - __main__ - INFO - Encoded passages 1126912
2023-06-23 08:45:08,545 - __main__ - INFO - Encoded passages 1178112
2023-06-23 08:48:39,153 - __main__ - INFO - Encoded passages 1229312
2023-06-23 08:52:09,755 - __main__ - INFO - Encoded passages 1280512
2023-06-23 08:54:37,564 - __main__ - INFO - Total passages processed 1313460. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_3.pb.
2023-06-23 08:54:38,002 - __main__ - INFO -  global_step = 10000
2023-06-23 08:59:51,866 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-23 09:02:50,496 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-23 09:02:50,498 - __main__ - INFO - load_passage_begin
2023-06-23 09:03:27,991 - __main__ - INFO - load_passage_id_begin
2023-06-23 09:04:23,318 - __main__ - INFO - load_passage_done
2023-06-23 09:04:25,181 - __main__ - INFO - Loadingtrainanswers
2023-06-23 09:04:37,110 - __main__ - INFO - Encoded question 512
2023-06-23 09:05:52,361 - __main__ - INFO - Loadingdevanswers
2023-06-23 09:06:00,432 - __main__ - INFO - Encoded question 512
2023-06-23 09:06:10,257 - __main__ - INFO - Loadingtestanswers
2023-06-23 09:06:18,660 - __main__ - INFO - Encoded question 512
2023-06-23 09:06:31,717 - __main__ - INFO - ***** Begin passage_embedding reorder *****
2023-06-23 09:07:24,354 - __main__ - INFO - ***** end passage_embedding reorder  *****
2023-06-23 09:07:31,036 - __main__ - INFO - ***** begin add passages  *****
2023-06-23 09:15:30,468 - __main__ - INFO - ***** end build index  *****
2023-06-23 09:19:40,862 - __main__ - INFO - Per question validation results len=78785
2023-06-23 09:19:41,286 - __main__ - INFO - Validation results: top k documents hits [64840, 66915, 67653, 68009, 68265, 68434, 68570, 68664, 68734, 68807, 68860, 68918, 68961, 69007, 69050, 69080, 69114, 69141, 69171, 69205, 69227, 69248, 69270, 69300, 69318, 69336, 69354, 69372, 69384, 69402, 69417, 69429, 69440, 69455, 69471, 69483, 69495, 69501, 69510, 69515, 69526, 69535, 69544, 69554, 69559, 69568, 69577, 69583, 69591, 69598, 69607, 69616, 69621, 69625, 69632, 69645, 69656, 69663, 69671, 69676, 69686, 69694, 69702, 69708, 69713, 69722, 69723, 69728, 69734, 69740, 69745, 69753, 69758, 69764, 69771, 69774, 69782, 69784, 69790, 69792, 69800, 69800, 69803, 69805, 69807, 69810, 69814, 69819, 69826, 69831, 69833, 69837, 69839, 69844, 69846, 69855, 69858, 69862, 69865, 69868]
2023-06-23 09:19:41,287 - __main__ - INFO - Validation results: top k documents hits accuracy [0.8229993018975693, 0.8493368026908675, 0.858704068033255, 0.8632226946753824, 0.8664720441708447, 0.8686171225487085, 0.8703433394681729, 0.8715364599860379, 0.8724249539887035, 0.8733515263057688, 0.8740242431935012, 0.874760423938567, 0.8753062131116329, 0.8758900805990988, 0.8764358697721647, 0.8768166529161643, 0.8772482071460304, 0.8775909119756299, 0.8779716951196294, 0.8784032493494954, 0.8786824903217617, 0.8789490385225615, 0.8792282794948277, 0.8796090626388272, 0.8798375325252269, 0.8800660024116266, 0.8802944722980263, 0.880522942184426, 0.8806752554420257, 0.8809037253284254, 0.8810941169004252, 0.881246430158025, 0.8813860506441582, 0.8815764422161579, 0.8817795265596243, 0.8819318398172241, 0.8820841530748239, 0.8821603097036238, 0.8822745446468236, 0.8823380085041569, 0.88247762899029, 0.8825918639334899, 0.8827060988766897, 0.8828330265913562, 0.8828964904486895, 0.8830107253918893, 0.8831249603350891, 0.883201116963889, 0.8833026591356222, 0.8833915085358888, 0.8835057434790886, 0.8836199784222885, 0.8836834422796217, 0.8837342133654884, 0.883823062765755, 0.8839880687948214, 0.8841276892809545, 0.8842165386812211, 0.8843180808529543, 0.8843815447102875, 0.884508472424954, 0.8846100145966872, 0.8847115567684204, 0.8847877133972203, 0.8848511772545535, 0.8849654121977534, 0.88497810496922, 0.8850415688265533, 0.8851177254553532, 0.8851938820841531, 0.8852573459414863, 0.8853588881132195, 0.8854223519705527, 0.8854985085993526, 0.8855873579996192, 0.8856254363140191, 0.8857269784857523, 0.8857523640286856, 0.8858285206574855, 0.8858539062004188, 0.885955448372152, 0.885955448372152, 0.885993526686552, 0.8860189122294853, 0.8860442977724186, 0.8860823760868185, 0.8861331471726852, 0.8861966110300185, 0.886285460430285, 0.8863489242876182, 0.8863743098305515, 0.8864250809164181, 0.8864504664593514, 0.8865139303166847, 0.886539315859618, 0.8866535508028178, 0.8866916291172178, 0.8867424002030844, 0.8867804785174843, 0.8868185568318843]
2023-06-23 09:19:56,087 - __main__ - INFO - writing new train top-k
2023-06-23 09:19:56,088 - __main__ - INFO - writing new train data
2023-06-23 09:22:26,938 - __main__ - INFO - Per question validation results len=8837
2023-06-23 09:22:27,001 - __main__ - INFO - Validation results: top k documents hits [5590, 6287, 6606, 6800, 6933, 7012, 7087, 7146, 7184, 7225, 7272, 7294, 7322, 7341, 7361, 7386, 7404, 7420, 7430, 7446, 7455, 7465, 7485, 7492, 7501, 7508, 7517, 7525, 7535, 7545, 7554, 7562, 7572, 7576, 7587, 7591, 7595, 7601, 7604, 7615, 7618, 7620, 7629, 7637, 7641, 7642, 7645, 7648, 7653, 7656, 7658, 7662, 7666, 7668, 7668, 7673, 7676, 7680, 7683, 7686, 7692, 7694, 7695, 7699, 7702, 7705, 7707, 7708, 7709, 7709, 7712, 7714, 7715, 7721, 7725, 7728, 7730, 7732, 7734, 7737, 7740, 7741, 7743, 7746, 7750, 7751, 7751, 7752, 7752, 7754, 7756, 7758, 7758, 7758, 7760, 7761, 7762, 7762, 7762, 7763]
2023-06-23 09:22:27,001 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6325676134434763, 0.7114405341179133, 0.747538757496888, 0.7694919090188979, 0.7845422654747086, 0.7934819508883105, 0.8019689940024896, 0.8086454679189771, 0.8129455697634944, 0.817585153332579, 0.8229037003507977, 0.8253932329976237, 0.8285617290935838, 0.8307117800158424, 0.8329749915129568, 0.8358040058843499, 0.8378408962317528, 0.8396514654294444, 0.8407830711780016, 0.8425936403756931, 0.8436120855493946, 0.8447436912979518, 0.8470069027950662, 0.8477990268190563, 0.8488174719927577, 0.8496095960167478, 0.8506280411904492, 0.851533325789295, 0.8526649315378522, 0.8537965372864094, 0.8548149824601109, 0.8557202670589567, 0.8568518728075138, 0.8573045151069367, 0.8585492814303497, 0.8590019237297726, 0.8594545660291955, 0.8601335294783298, 0.8604730112028969, 0.8617177775263098, 0.862057259250877, 0.8622835804005884, 0.8633020255742899, 0.8642073101731357, 0.8646599524725586, 0.8647731130474143, 0.8651125947719814, 0.8654520764965487, 0.8660178793708272, 0.8663573610953944, 0.8665836822451058, 0.8670363245445287, 0.8674889668439516, 0.867715287993663, 0.867715287993663, 0.8682810908679416, 0.8686205725925088, 0.8690732148919317, 0.8694126966164988, 0.869752178341066, 0.8704311417902003, 0.8706574629399118, 0.8707706235147674, 0.8712232658141903, 0.8715627475387575, 0.8719022292633246, 0.872128550413036, 0.8722417109878918, 0.8723548715627475, 0.8723548715627475, 0.8726943532873147, 0.8729206744370261, 0.8730338350118818, 0.8737127984610161, 0.8741654407604391, 0.8745049224850062, 0.8747312436347177, 0.8749575647844291, 0.8751838859341405, 0.8755233676587078, 0.8758628493832749, 0.8759760099581306, 0.8762023311078421, 0.8765418128324092, 0.876994455131832, 0.8771076157066878, 0.8771076157066878, 0.8772207762815435, 0.8772207762815435, 0.8774470974312549, 0.8776734185809664, 0.8778997397306778, 0.8778997397306778, 0.8778997397306778, 0.8781260608803892, 0.878239221455245, 0.8783523820301007, 0.8783523820301007, 0.8783523820301007, 0.8784655426049565]
2023-06-23 09:22:36,427 - __main__ - INFO - writing new dev top-k
2023-06-23 09:22:36,427 - __main__ - INFO - writing new dev data
2023-06-23 09:23:46,048 - __main__ - INFO - Per question validation results len=11313
2023-06-23 09:23:46,125 - __main__ - INFO - Validation results: top k documents hits [7232, 8079, 8482, 8718, 8868, 8985, 9082, 9163, 9236, 9286, 9320, 9360, 9397, 9430, 9460, 9487, 9512, 9538, 9557, 9571, 9587, 9601, 9610, 9628, 9638, 9649, 9658, 9673, 9681, 9691, 9698, 9704, 9714, 9723, 9725, 9731, 9741, 9750, 9756, 9763, 9768, 9775, 9783, 9791, 9798, 9801, 9804, 9808, 9819, 9823, 9827, 9829, 9834, 9838, 9840, 9845, 9848, 9850, 9855, 9859, 9862, 9865, 9868, 9873, 9876, 9878, 9881, 9884, 9886, 9891, 9892, 9897, 9904, 9907, 9910, 9912, 9913, 9918, 9922, 9926, 9930, 9934, 9935, 9939, 9942, 9943, 9947, 9947, 9949, 9950, 9951, 9953, 9957, 9961, 9963, 9964, 9965, 9966, 9966, 9968]
2023-06-23 09:23:46,125 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6392645628922479, 0.7141341819146115, 0.7497569168213559, 0.7706178732431715, 0.7838769557146645, 0.794219040042429, 0.8027932467073279, 0.809953151241934, 0.816405904711394, 0.8208255988685583, 0.82383099089543, 0.8273667462211615, 0.8306373198974631, 0.8335543180411915, 0.8362061345354902, 0.8385927693803589, 0.840802616458941, 0.8431008574206665, 0.8447803412003889, 0.8460178555643949, 0.8474321576946875, 0.8486696720586936, 0.8494652170069831, 0.8510563069035623, 0.8519402457349952, 0.8529125784495712, 0.8537081233978608, 0.8550340316450101, 0.8557411827101564, 0.8566251215415893, 0.8572438787235923, 0.857774242022452, 0.8586581808538849, 0.8594537258021745, 0.8596305135684611, 0.8601608768673208, 0.8610448156987537, 0.8618403606470433, 0.862370723945903, 0.862989481127906, 0.8634314505436224, 0.8640502077256254, 0.8647573587907716, 0.8654645098559179, 0.8660832670379209, 0.8663484486873508, 0.8666136303367807, 0.8669672058693538, 0.86793953858393, 0.8682931141165031, 0.8686466896490763, 0.8688234774153628, 0.8692654468310793, 0.8696190223636524, 0.869795810129939, 0.8702377795456554, 0.8705029611950853, 0.8706797489613719, 0.8711217183770883, 0.8714752939096615, 0.8717404755590913, 0.8720056572085212, 0.872270838857951, 0.8727128082736675, 0.8729779899230973, 0.8731547776893839, 0.8734199593388138, 0.8736851409882436, 0.8738619287545302, 0.8743038981702467, 0.8743922920533899, 0.8748342614691064, 0.8754530186511094, 0.8757182003005392, 0.875983381949969, 0.8761601697162557, 0.876248563599399, 0.8766905330151153, 0.8770441085476886, 0.8773976840802616, 0.8777512596128348, 0.8781048351454079, 0.8781932290285512, 0.8785468045611243, 0.8788119862105542, 0.8789003800936975, 0.8792539556262706, 0.8792539556262706, 0.8794307433925572, 0.8795191372757005, 0.8796075311588438, 0.8797843189251304, 0.8801378944577035, 0.8804914699902767, 0.8806682577565632, 0.8807566516397065, 0.8808450455228498, 0.8809334394059931, 0.8809334394059931, 0.8811102271722797]
2023-06-23 09:23:54,980 - __main__ - INFO - writing new test top-k
2023-06-23 09:23:54,980 - __main__ - INFO - writing new test data
2023-06-23 09:23:56,808 - __main__ - INFO -  global_step = 10000
2023-06-23 14:49:06,658 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-23 14:52:28,603 - __main__ - INFO -  global_step = 12000
2023-06-23 14:52:49,987 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-23 14:55:45,429 - __main__ - INFO -  global_step = 12000
2023-06-24 13:25:06,773 - __main__ - INFO - Training/evaluation parameters Namespace(model_type='nghuyong/ernie-2.0-base-en', model_name_or_path='../TQ/triviaqa_fintinue.pkl', model_name_or_path_ict=None, output_dir='output/co_training_tq_simANS_test', num_epoch=0, config_name='', tokenizer_name='', corpus_path='', max_seq_length=256, max_query_length=32, triplet=False, log_dir='tensorboard_log/co_training_tq_simANS_test', optimizer='adamW', per_gpu_train_batch_size=8, gradient_accumulation_steps=1, learning_rate=2e-06, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=2.0, max_steps=20000, warmup_steps=1000, logging_steps=100, save_steps=2000, no_cuda=False, seed=42, fp16=False, fp16_opt_level='O1', gradient_checkpointing=True, contr_loss=False, normal_loss=True, origin_data_dir='output/co_training_tq_simANS_test/temp/train_ce.json', load_optimizer_scheduler=False, single_warmup=True, adv_data_path=None, ann_data_path=None, fix_embedding=False, continue_train=False, adv_loss_alpha=0.3, reranker_model_path='../TQ/checkpoint-reranker34000', reranker_model_type='nghuyong/ernie-2.0-large-en', number_neg=15, adv_lambda=0.0, adv_steps=3, local_rank=0, server_ip='', server_port='', test_qa_path='', train_qa_path='', dev_qa_path='', passage_path='', iteration_step=2000, iteration_reranker_step=500, temperature_normal=1.0, scale_simmila=False, reranker_learning_rate=5e-07, load_cache=False, ann_dir='output/co_training_tq_simANS_test/temp', normal_term='cross_e', global_step=10000, a=0.5, b=0, n_gpu=1, device=device(type='cuda', index=0), world_size=4, rank=0)
2023-06-24 13:25:17,961 - __main__ - INFO - Loading checkpoint @ step=10000
2023-06-24 13:25:17,961 - __main__ - INFO - Loading saved model state ...
2023-06-24 13:25:39,021 - __main__ - INFO - Loading checkpoint @ step=10000
2023-06-24 13:25:39,021 - __main__ - INFO - Loading saved model state ...
2023-06-24 13:25:52,257 - __main__ - INFO - ***** Running training *****
2023-06-24 13:25:52,257 - __main__ - INFO -   Max steps = 20000
2023-06-24 13:25:52,257 - __main__ - INFO -   Instantaneous batch size per GPU = 8
2023-06-24 13:25:52,257 - __main__ - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 32
2023-06-24 13:25:52,257 - __main__ - INFO -   Gradient Accumulation steps = 1
2023-06-24 13:25:52,257 - __main__ - INFO -   Dataset example num = 70076
2023-06-24 13:25:52,257 - __main__ - INFO -   step each epoch = 8759
2023-06-24 13:38:03,167 - __main__ - INFO - {"learning_rate": 1.4814814814814814e-09, "loss": 0.13246870850746517, "normal_loss": 0.0, "contr_loss": 0.13246870850746517, "step": 10100}
2023-06-24 13:50:03,756 - __main__ - INFO - {"learning_rate": 1.4814814814814814e-09, "loss": 0.1328388548273324, "normal_loss": 0.0, "contr_loss": 0.1328388548273324, "step": 10200}
2023-06-24 14:02:15,060 - __main__ - INFO - {"learning_rate": 1.4814814814814814e-09, "loss": 0.09476720079072493, "normal_loss": 0.0, "contr_loss": 0.09476720079072493, "step": 10300}
2023-06-24 14:14:22,898 - __main__ - INFO - {"learning_rate": 1.4814814814814814e-09, "loss": 0.09643338291508144, "normal_loss": 0.0, "contr_loss": 0.09643338291508144, "step": 10400}
2023-06-24 14:26:35,401 - __main__ - INFO - {"learning_rate": 1.4814814814814814e-09, "loss": 0.12445341509595437, "normal_loss": 0.0, "contr_loss": 0.12445341509595437, "step": 10500}
2023-06-24 14:33:09,631 - __main__ - INFO - {"learning_rate": 1.0971851851851851e-06, "loss": 0.22726186866068018, "normal_loss": 0.22726172099413816, "contr_loss": 1.4766654203413053e-07, "step": 10600}
2023-06-24 14:39:41,300 - __main__ - INFO - {"learning_rate": 1.0823703703703703e-06, "loss": 0.25340812121896306, "normal_loss": 0.25340812121896306, "contr_loss": 0.0, "step": 10700}
2023-06-24 14:46:07,652 - __main__ - INFO - {"learning_rate": 1.0675555555555556e-06, "loss": 0.23768230229688925, "normal_loss": 0.23768230229688925, "contr_loss": 0.0, "step": 10800}
2023-06-24 14:52:35,975 - __main__ - INFO - {"learning_rate": 1.0527407407407408e-06, "loss": 0.19909682796653214, "normal_loss": 0.19909682796653214, "contr_loss": 0.0, "step": 10900}
2023-06-24 14:58:59,549 - __main__ - INFO - {"learning_rate": 1.0379259259259258e-06, "loss": 0.2698846754897386, "normal_loss": 0.2698846754897386, "contr_loss": 0.0, "step": 11000}
2023-06-24 15:05:36,650 - __main__ - INFO - {"learning_rate": 1.023111111111111e-06, "loss": 0.19760651318822056, "normal_loss": 0.19760651318822056, "contr_loss": 0.0, "step": 11100}
2023-06-24 15:12:05,311 - __main__ - INFO - {"learning_rate": 1.0082962962962962e-06, "loss": 0.18221047368075233, "normal_loss": 0.18221047368075233, "contr_loss": 0.0, "step": 11200}
2023-06-24 15:18:41,551 - __main__ - INFO - {"learning_rate": 9.934814814814814e-07, "loss": 0.22872354824125068, "normal_loss": 0.22872354824125068, "contr_loss": 0.0, "step": 11300}
2023-06-24 15:25:12,284 - __main__ - INFO - {"learning_rate": 9.786666666666666e-07, "loss": 0.22377629646682182, "normal_loss": 0.22377629646682182, "contr_loss": 0.0, "step": 11400}
2023-06-24 15:31:43,755 - __main__ - INFO - {"learning_rate": 9.638518518518519e-07, "loss": 0.2241764457145473, "normal_loss": 0.2241764457145473, "contr_loss": 0.0, "step": 11500}
2023-06-24 15:38:16,549 - __main__ - INFO - {"learning_rate": 9.49037037037037e-07, "loss": 0.19471544183019432, "normal_loss": 0.19471544183019432, "contr_loss": 0.0, "step": 11600}
2023-06-24 15:44:49,842 - __main__ - INFO - {"learning_rate": 9.342222222222221e-07, "loss": 0.25742736167216207, "normal_loss": 0.25742736167216207, "contr_loss": 0.0, "step": 11700}
2023-06-24 15:51:21,306 - __main__ - INFO - {"learning_rate": 9.194074074074074e-07, "loss": 0.23147742256958737, "normal_loss": 0.23147742256958737, "contr_loss": 0.0, "step": 11800}
2023-06-24 15:57:48,185 - __main__ - INFO - {"learning_rate": 9.045925925925926e-07, "loss": 0.28095289795805, "normal_loss": 0.28095289795805, "contr_loss": 0.0, "step": 11900}
2023-06-24 16:04:19,562 - __main__ - INFO - {"learning_rate": 8.897777777777777e-07, "loss": 0.18761523776047398, "normal_loss": 0.18761523776047398, "contr_loss": 0.0, "step": 12000}
2023-06-24 16:04:25,915 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint
2023-06-24 16:04:34,450 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint-reranker
2023-06-24 16:04:37,405 - __main__ - INFO -  global_step = 12000
2023-06-24 16:05:07,957 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-24 16:08:30,798 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-24 16:08:30,899 - __main__ - INFO - Embedding generation for 5253831 passages from idx 0 to 5253831
2023-06-24 16:08:46,244 - __main__ - INFO - Encoded passages 512
2023-06-24 16:12:16,169 - __main__ - INFO - Encoded passages 51712
2023-06-24 16:15:46,582 - __main__ - INFO - Encoded passages 102912
2023-06-24 16:19:17,080 - __main__ - INFO - Encoded passages 154112
2023-06-24 16:22:47,483 - __main__ - INFO - Encoded passages 205312
2023-06-24 16:26:17,905 - __main__ - INFO - Encoded passages 256512
2023-06-24 16:29:48,331 - __main__ - INFO - Encoded passages 307712
2023-06-24 16:33:18,745 - __main__ - INFO - Encoded passages 358912
2023-06-24 16:36:49,194 - __main__ - INFO - Encoded passages 410112
2023-06-24 16:40:19,591 - __main__ - INFO - Encoded passages 461312
2023-06-24 16:43:50,060 - __main__ - INFO - Encoded passages 512512
2023-06-24 16:47:20,467 - __main__ - INFO - Encoded passages 563712
2023-06-24 16:50:50,858 - __main__ - INFO - Encoded passages 614912
2023-06-24 16:54:21,244 - __main__ - INFO - Encoded passages 666112
2023-06-24 16:57:51,673 - __main__ - INFO - Encoded passages 717312
2023-06-24 17:01:22,099 - __main__ - INFO - Encoded passages 768512
2023-06-24 17:04:52,491 - __main__ - INFO - Encoded passages 819712
2023-06-24 17:08:22,894 - __main__ - INFO - Encoded passages 870912
2023-06-24 17:11:53,336 - __main__ - INFO - Encoded passages 922112
2023-06-24 17:15:23,772 - __main__ - INFO - Encoded passages 973312
2023-06-24 17:18:54,219 - __main__ - INFO - Encoded passages 1024512
2023-06-24 17:22:24,644 - __main__ - INFO - Encoded passages 1075712
2023-06-24 17:25:55,061 - __main__ - INFO - Encoded passages 1126912
2023-06-24 17:29:25,485 - __main__ - INFO - Encoded passages 1178112
2023-06-24 17:32:55,882 - __main__ - INFO - Encoded passages 1229312
2023-06-24 17:36:26,304 - __main__ - INFO - Encoded passages 1280512
2023-06-24 17:38:52,874 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_0.pb.
2023-06-24 17:39:02,994 - __main__ - INFO - Encoded passages 512
2023-06-24 17:42:33,412 - __main__ - INFO - Encoded passages 51712
2023-06-24 17:46:04,001 - __main__ - INFO - Encoded passages 102912
2023-06-24 17:49:34,638 - __main__ - INFO - Encoded passages 154112
2023-06-24 17:53:05,176 - __main__ - INFO - Encoded passages 205312
2023-06-24 17:56:35,655 - __main__ - INFO - Encoded passages 256512
2023-06-24 18:00:06,132 - __main__ - INFO - Encoded passages 307712
2023-06-24 18:03:36,623 - __main__ - INFO - Encoded passages 358912
2023-06-24 18:07:07,109 - __main__ - INFO - Encoded passages 410112
2023-06-24 18:10:37,614 - __main__ - INFO - Encoded passages 461312
2023-06-24 18:14:08,071 - __main__ - INFO - Encoded passages 512512
2023-06-24 18:17:38,575 - __main__ - INFO - Encoded passages 563712
2023-06-24 18:21:09,113 - __main__ - INFO - Encoded passages 614912
2023-06-24 18:24:39,614 - __main__ - INFO - Encoded passages 666112
2023-06-24 18:28:10,095 - __main__ - INFO - Encoded passages 717312
2023-06-24 18:31:40,622 - __main__ - INFO - Encoded passages 768512
2023-06-24 18:35:11,074 - __main__ - INFO - Encoded passages 819712
2023-06-24 18:38:41,585 - __main__ - INFO - Encoded passages 870912
2023-06-24 18:42:12,077 - __main__ - INFO - Encoded passages 922112
2023-06-24 18:45:42,525 - __main__ - INFO - Encoded passages 973312
2023-06-24 18:49:13,020 - __main__ - INFO - Encoded passages 1024512
2023-06-24 18:52:43,484 - __main__ - INFO - Encoded passages 1075712
2023-06-24 18:56:13,983 - __main__ - INFO - Encoded passages 1126912
2023-06-24 18:59:44,458 - __main__ - INFO - Encoded passages 1178112
2023-06-24 19:03:14,939 - __main__ - INFO - Encoded passages 1229312
2023-06-24 19:06:45,439 - __main__ - INFO - Encoded passages 1280512
2023-06-24 19:09:14,327 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_1.pb.
2023-06-24 19:09:23,474 - __main__ - INFO - Encoded passages 512
2023-06-24 19:12:53,890 - __main__ - INFO - Encoded passages 51712
2023-06-24 19:16:24,457 - __main__ - INFO - Encoded passages 102912
2023-06-24 19:19:55,039 - __main__ - INFO - Encoded passages 154112
2023-06-24 19:23:25,585 - __main__ - INFO - Encoded passages 205312
2023-06-24 19:26:56,088 - __main__ - INFO - Encoded passages 256512
2023-06-24 19:30:26,602 - __main__ - INFO - Encoded passages 307712
2023-06-24 19:33:57,088 - __main__ - INFO - Encoded passages 358912
2023-06-24 19:37:27,565 - __main__ - INFO - Encoded passages 410112
2023-06-24 19:40:58,013 - __main__ - INFO - Encoded passages 461312
2023-06-24 19:44:28,517 - __main__ - INFO - Encoded passages 512512
2023-06-24 19:47:58,998 - __main__ - INFO - Encoded passages 563712
2023-06-24 19:51:29,444 - __main__ - INFO - Encoded passages 614912
2023-06-24 19:54:59,927 - __main__ - INFO - Encoded passages 666112
2023-06-24 19:58:30,421 - __main__ - INFO - Encoded passages 717312
2023-06-24 20:02:00,912 - __main__ - INFO - Encoded passages 768512
2023-06-24 20:05:31,370 - __main__ - INFO - Encoded passages 819712
2023-06-24 20:09:01,858 - __main__ - INFO - Encoded passages 870912
2023-06-24 20:12:32,332 - __main__ - INFO - Encoded passages 922112
2023-06-24 20:16:02,814 - __main__ - INFO - Encoded passages 973312
2023-06-24 20:19:33,329 - __main__ - INFO - Encoded passages 1024512
2023-06-24 20:23:03,826 - __main__ - INFO - Encoded passages 1075712
2023-06-24 20:26:34,318 - __main__ - INFO - Encoded passages 1126912
2023-06-24 20:30:04,821 - __main__ - INFO - Encoded passages 1178112
2023-06-24 20:33:35,373 - __main__ - INFO - Encoded passages 1229312
2023-06-24 20:37:05,855 - __main__ - INFO - Encoded passages 1280512
2023-06-24 20:39:32,280 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_2.pb.
2023-06-24 20:39:42,760 - __main__ - INFO - Encoded passages 512
2023-06-24 20:43:13,230 - __main__ - INFO - Encoded passages 51712
2023-06-24 20:46:43,821 - __main__ - INFO - Encoded passages 102912
2023-06-24 20:50:14,359 - __main__ - INFO - Encoded passages 154112
2023-06-24 20:53:44,836 - __main__ - INFO - Encoded passages 205312
2023-06-24 20:57:15,350 - __main__ - INFO - Encoded passages 256512
2023-06-24 21:00:45,856 - __main__ - INFO - Encoded passages 307712
2023-06-24 21:04:16,354 - __main__ - INFO - Encoded passages 358912
2023-06-24 21:07:46,811 - __main__ - INFO - Encoded passages 410112
2023-06-24 21:11:17,349 - __main__ - INFO - Encoded passages 461312
2023-06-24 21:14:47,831 - __main__ - INFO - Encoded passages 512512
2023-06-24 21:18:18,322 - __main__ - INFO - Encoded passages 563712
2023-06-24 21:21:48,794 - __main__ - INFO - Encoded passages 614912
2023-06-24 21:25:19,308 - __main__ - INFO - Encoded passages 666112
2023-06-24 21:28:49,807 - __main__ - INFO - Encoded passages 717312
2023-06-24 21:32:20,272 - __main__ - INFO - Encoded passages 768512
2023-06-24 21:35:50,695 - __main__ - INFO - Encoded passages 819712
2023-06-24 21:39:21,197 - __main__ - INFO - Encoded passages 870912
2023-06-24 21:42:51,725 - __main__ - INFO - Encoded passages 922112
2023-06-24 21:46:22,184 - __main__ - INFO - Encoded passages 973312
2023-06-24 21:49:52,631 - __main__ - INFO - Encoded passages 1024512
2023-06-24 21:53:23,178 - __main__ - INFO - Encoded passages 1075712
2023-06-24 21:56:53,657 - __main__ - INFO - Encoded passages 1126912
2023-06-24 22:00:24,129 - __main__ - INFO - Encoded passages 1178112
2023-06-24 22:03:54,636 - __main__ - INFO - Encoded passages 1229312
2023-06-24 22:07:25,200 - __main__ - INFO - Encoded passages 1280512
2023-06-24 22:09:52,315 - __main__ - INFO - Total passages processed 1313460. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_3.pb.
2023-06-24 22:09:52,735 - __main__ - INFO -  global_step = 12000
2023-06-24 22:15:32,024 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-24 22:18:29,726 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-24 22:18:29,727 - __main__ - INFO - load_passage_begin
2023-06-24 22:19:06,716 - __main__ - INFO - load_passage_id_begin
2023-06-24 22:20:02,124 - __main__ - INFO - load_passage_done
2023-06-24 22:20:04,025 - __main__ - INFO - Loadingtrainanswers
2023-06-24 22:20:15,904 - __main__ - INFO - Encoded question 512
2023-06-24 22:21:31,011 - __main__ - INFO - Loadingdevanswers
2023-06-24 22:21:39,107 - __main__ - INFO - Encoded question 512
2023-06-24 22:21:48,976 - __main__ - INFO - Loadingtestanswers
2023-06-24 22:21:57,473 - __main__ - INFO - Encoded question 512
2023-06-24 22:22:10,790 - __main__ - INFO - ***** Begin passage_embedding reorder *****
2023-06-24 22:23:20,273 - __main__ - INFO - ***** end passage_embedding reorder  *****
2023-06-24 22:23:26,706 - __main__ - INFO - ***** begin add passages  *****
2023-06-24 23:02:28,541 - __main__ - INFO - ***** end build index  *****
2023-06-24 23:06:35,665 - __main__ - INFO - Per question validation results len=78785
2023-06-24 23:06:36,084 - __main__ - INFO - Validation results: top k documents hits [64283, 66531, 67380, 67764, 68017, 68213, 68349, 68471, 68569, 68643, 68700, 68765, 68825, 68864, 68911, 68947, 68976, 69010, 69031, 69056, 69084, 69107, 69139, 69159, 69175, 69192, 69212, 69232, 69245, 69261, 69277, 69295, 69310, 69324, 69336, 69349, 69355, 69372, 69388, 69398, 69412, 69425, 69438, 69455, 69468, 69478, 69485, 69491, 69501, 69505, 69514, 69520, 69527, 69535, 69545, 69554, 69564, 69571, 69573, 69579, 69585, 69594, 69602, 69604, 69608, 69613, 69621, 69634, 69643, 69647, 69654, 69658, 69663, 69665, 69670, 69676, 69684, 69686, 69689, 69694, 69697, 69703, 69704, 69713, 69717, 69718, 69722, 69728, 69729, 69731, 69735, 69737, 69739, 69742, 69748, 69750, 69753, 69759, 69764, 69769]
2023-06-24 23:06:36,084 - __main__ - INFO - Validation results: top k documents hits accuracy [0.8159294281906454, 0.844462778447674, 0.8552389414228597, 0.8601129656660532, 0.8633242368471156, 0.8658120200545789, 0.8675382369740433, 0.8690867550929745, 0.8703306466967062, 0.8712699117852383, 0.8719933997588374, 0.8728184299041696, 0.8735799961921685, 0.8740750142793678, 0.8746715745383005, 0.8751285143110998, 0.8754966046836327, 0.8759281589134987, 0.8761947071142984, 0.8765120264009647, 0.8768674240020309, 0.8771593577457638, 0.8775655264326966, 0.8778193818620296, 0.878022466205496, 0.878238243320429, 0.878492098749762, 0.878745954179095, 0.8789109602081615, 0.8791140445516279, 0.8793171288950943, 0.879545598781494, 0.8797359903534937, 0.8799136891540268, 0.8800660024116266, 0.880231008440693, 0.8803071650694929, 0.880522942184426, 0.8807260265278923, 0.8808529542425588, 0.8810306530430919, 0.8811956590721584, 0.8813606651012249, 0.8815764422161579, 0.8817414482452244, 0.8818683759598909, 0.8819572253601574, 0.8820333819889573, 0.8821603097036238, 0.8822110807894904, 0.8823253157326902, 0.8824014723614901, 0.8824903217617567, 0.8825918639334899, 0.8827187916481564, 0.8828330265913562, 0.8829599543060227, 0.8830488037062892, 0.8830741892492225, 0.8831503458780224, 0.8832265025068223, 0.8833407374500222, 0.8834422796217554, 0.8834676651646887, 0.8835184362505553, 0.8835819001078885, 0.8836834422796217, 0.8838484483086883, 0.8839626832518881, 0.8840134543377547, 0.8841023037380212, 0.8841530748238878, 0.8842165386812211, 0.8842419242241544, 0.8843053880814876, 0.8843815447102875, 0.8844830868820207, 0.884508472424954, 0.884546550739354, 0.8846100145966872, 0.8846480929110871, 0.884724249539887, 0.8847369423113537, 0.8848511772545535, 0.8849019483404201, 0.8849146411118868, 0.8849654121977534, 0.8850415688265533, 0.8850542615980199, 0.8850796471409532, 0.8851304182268198, 0.8851558037697531, 0.8851811893126864, 0.8852192676270864, 0.8852954242558863, 0.8853208097988196, 0.8853588881132195, 0.8854350447420194, 0.8854985085993526, 0.8855619724566859]
2023-06-24 23:06:50,710 - __main__ - INFO - writing new train top-k
2023-06-24 23:06:50,710 - __main__ - INFO - writing new train data
2023-06-24 23:09:26,573 - __main__ - INFO - Per question validation results len=8837
2023-06-24 23:09:26,634 - __main__ - INFO - Validation results: top k documents hits [5584, 6206, 6542, 6708, 6840, 6939, 7011, 7079, 7116, 7148, 7201, 7230, 7257, 7277, 7304, 7324, 7351, 7369, 7387, 7398, 7416, 7424, 7432, 7443, 7457, 7471, 7477, 7488, 7497, 7501, 7511, 7523, 7532, 7539, 7550, 7556, 7561, 7565, 7568, 7573, 7574, 7581, 7583, 7588, 7591, 7594, 7600, 7605, 7609, 7615, 7618, 7622, 7623, 7629, 7630, 7633, 7635, 7638, 7645, 7649, 7654, 7657, 7658, 7660, 7661, 7664, 7666, 7668, 7670, 7672, 7672, 7675, 7676, 7677, 7678, 7681, 7683, 7686, 7689, 7690, 7691, 7695, 7695, 7698, 7699, 7701, 7702, 7704, 7706, 7706, 7707, 7708, 7709, 7711, 7713, 7715, 7717, 7719, 7720, 7724]
2023-06-24 23:09:26,634 - __main__ - INFO - Validation results: top k documents hits accuracy [0.631888649994342, 0.7022745275546, 0.740296480706122, 0.7590811361321715, 0.7740183320131266, 0.7852212289238429, 0.7933687903134548, 0.8010637094036438, 0.8052506506733054, 0.8088717890686885, 0.8148692995360416, 0.8181509562068575, 0.821206291727962, 0.8234695032250764, 0.8265248387461809, 0.8287880502432953, 0.8318433857643996, 0.8338802761118026, 0.8359171664592057, 0.8371619327826185, 0.8391988231300215, 0.8401041077288672, 0.841009392327713, 0.842254158651126, 0.843838406699106, 0.8454226547470861, 0.8461016181962204, 0.8473463845196334, 0.8483648296933348, 0.8488174719927577, 0.8499490777413149, 0.8513070046395835, 0.8523254498132851, 0.853117573837275, 0.854362340160688, 0.8550413036098223, 0.855607106484101, 0.8560597487835239, 0.856399230508091, 0.8569650333823696, 0.8570781939572253, 0.8578703179812154, 0.8580966391309268, 0.8586624420052054, 0.8590019237297726, 0.8593414054543397, 0.860020368903474, 0.8605861717777527, 0.8610388140771755, 0.8617177775263098, 0.862057259250877, 0.8625099015502998, 0.8626230621251556, 0.8633020255742899, 0.8634151861491456, 0.8637546678737128, 0.8639809890234242, 0.8643204707479915, 0.8651125947719814, 0.8655652370714043, 0.866131039945683, 0.8664705216702501, 0.8665836822451058, 0.8668100033948173, 0.866923163969673, 0.8672626456942402, 0.8674889668439516, 0.867715287993663, 0.8679416091433745, 0.8681679302930859, 0.8681679302930859, 0.868507412017653, 0.8686205725925088, 0.8687337331673645, 0.8688468937422202, 0.8691863754667873, 0.8694126966164988, 0.869752178341066, 0.8700916600656331, 0.8702048206404889, 0.8703179812153445, 0.8707706235147674, 0.8707706235147674, 0.8711101052393346, 0.8712232658141903, 0.8714495869639017, 0.8715627475387575, 0.871789068688469, 0.8720153898381804, 0.8720153898381804, 0.872128550413036, 0.8722417109878918, 0.8723548715627475, 0.8725811927124589, 0.8728075138621704, 0.8730338350118818, 0.8732601561615932, 0.8734864773113047, 0.8735996378861605, 0.8740522801855833]
2023-06-24 23:09:35,319 - __main__ - INFO - writing new dev top-k
2023-06-24 23:09:35,319 - __main__ - INFO - writing new dev data
2023-06-24 23:10:44,138 - __main__ - INFO - Per question validation results len=11313
2023-06-24 23:10:44,211 - __main__ - INFO - Validation results: top k documents hits [7192, 7971, 8389, 8610, 8761, 8890, 8997, 9061, 9117, 9168, 9214, 9248, 9294, 9322, 9355, 9384, 9413, 9430, 9449, 9460, 9483, 9498, 9512, 9528, 9541, 9550, 9563, 9578, 9595, 9602, 9610, 9620, 9628, 9633, 9644, 9649, 9655, 9663, 9672, 9680, 9683, 9688, 9694, 9701, 9710, 9719, 9726, 9731, 9740, 9747, 9751, 9753, 9754, 9755, 9761, 9765, 9772, 9775, 9780, 9787, 9793, 9794, 9797, 9800, 9803, 9805, 9810, 9813, 9817, 9820, 9822, 9825, 9827, 9830, 9831, 9833, 9835, 9837, 9839, 9842, 9847, 9851, 9858, 9860, 9862, 9862, 9866, 9870, 9874, 9877, 9880, 9885, 9885, 9886, 9888, 9891, 9896, 9900, 9902, 9902]
2023-06-24 23:10:44,211 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6357288075665164, 0.7045876425351366, 0.7415362856890303, 0.7610713338636966, 0.7744188102183329, 0.7858216211438168, 0.7952797666401485, 0.8009369751613188, 0.8058870326173428, 0.8103951206576505, 0.8144612392822417, 0.8174666313091135, 0.8215327499337046, 0.8240077786617166, 0.8269247768054451, 0.8294881994166003, 0.8320516220277557, 0.8335543180411915, 0.835233801820914, 0.8362061345354902, 0.8382391938477858, 0.8395651020949351, 0.840802616458941, 0.8422169185892336, 0.8433660390700963, 0.8441615840183859, 0.8453107044992486, 0.8466366127463979, 0.8481393087598338, 0.8487580659418368, 0.8494652170069831, 0.850349155838416, 0.8510563069035623, 0.8514982763192787, 0.8524706090338549, 0.8529125784495712, 0.853442941748431, 0.8541500928135773, 0.8549456377618668, 0.8556527888270131, 0.855917970476443, 0.8563599398921594, 0.8568903031910192, 0.8575090603730222, 0.8583046053213118, 0.8591001502696013, 0.8597189074516044, 0.8601608768673208, 0.8609564218156104, 0.8615751789976134, 0.8619287545301865, 0.8621055422964731, 0.8621939361796164, 0.8622823300627597, 0.8628126933616194, 0.8631662688941926, 0.8637850260761956, 0.8640502077256254, 0.8644921771413419, 0.8651109343233448, 0.8656412976222045, 0.8657296915053478, 0.8659948731547777, 0.8662600548042075, 0.8665252364536374, 0.8667020242199239, 0.8671439936356404, 0.8674091752850702, 0.8677627508176434, 0.8680279324670733, 0.8682047202333598, 0.8684699018827897, 0.8686466896490763, 0.8689118712985061, 0.8690002651816494, 0.869177052947936, 0.8693538407142226, 0.8695306284805091, 0.8697074162467957, 0.8699725978962256, 0.870414567311942, 0.8707681428445152, 0.8713869000265182, 0.8715636877928047, 0.8717404755590913, 0.8717404755590913, 0.8720940510916645, 0.8724476266242376, 0.8728012021568108, 0.8730663838062406, 0.8733315654556705, 0.8737735348713869, 0.8737735348713869, 0.8738619287545302, 0.8740387165208168, 0.8743038981702467, 0.8747458675859631, 0.8750994431185362, 0.8752762308848228, 0.8752762308848228]
2023-06-24 23:10:53,388 - __main__ - INFO - writing new test top-k
2023-06-24 23:10:53,388 - __main__ - INFO - writing new test data
2023-06-24 23:10:55,654 - __main__ - INFO -  global_step = 12000
2023-06-25 05:10:50,436 - __main__ - INFO - Training/evaluation parameters Namespace(model_type='nghuyong/ernie-2.0-base-en', model_name_or_path='../TQ/triviaqa_fintinue.pkl', model_name_or_path_ict=None, output_dir='output/co_training_tq_simANS_test', num_epoch=0, config_name='', tokenizer_name='', corpus_path='', max_seq_length=256, max_query_length=32, triplet=False, log_dir='tensorboard_log/co_training_tq_simANS_test', optimizer='adamW', per_gpu_train_batch_size=8, gradient_accumulation_steps=1, learning_rate=2e-06, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=2.0, max_steps=20000, warmup_steps=1000, logging_steps=100, save_steps=2000, no_cuda=False, seed=42, fp16=False, fp16_opt_level='O1', gradient_checkpointing=True, contr_loss=False, normal_loss=True, origin_data_dir='output/co_training_tq_simANS_test/temp/train_ce.json', load_optimizer_scheduler=False, single_warmup=True, adv_data_path=None, ann_data_path=None, fix_embedding=False, continue_train=False, adv_loss_alpha=0.3, reranker_model_path='../TQ/checkpoint-reranker34000', reranker_model_type='nghuyong/ernie-2.0-large-en', number_neg=15, adv_lambda=0.0, adv_steps=3, local_rank=0, server_ip='', server_port='', test_qa_path='', train_qa_path='', dev_qa_path='', passage_path='', iteration_step=2000, iteration_reranker_step=500, temperature_normal=1.0, scale_simmila=False, reranker_learning_rate=5e-07, load_cache=False, ann_dir='output/co_training_tq_simANS_test/temp', normal_term='cross_e', global_step=12000, a=0.5, b=0, n_gpu=1, device=device(type='cuda', index=0), world_size=4, rank=0)
2023-06-25 05:11:01,338 - __main__ - INFO - Loading checkpoint @ step=12000
2023-06-25 05:11:01,338 - __main__ - INFO - Loading saved model state ...
2023-06-25 05:11:21,106 - __main__ - INFO - Loading checkpoint @ step=12000
2023-06-25 05:11:21,106 - __main__ - INFO - Loading saved model state ...
2023-06-25 05:11:35,186 - __main__ - INFO - ***** Running training *****
2023-06-25 05:11:35,186 - __main__ - INFO -   Max steps = 20000
2023-06-25 05:11:35,186 - __main__ - INFO -   Instantaneous batch size per GPU = 8
2023-06-25 05:11:35,186 - __main__ - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 32
2023-06-25 05:11:35,186 - __main__ - INFO -   Gradient Accumulation steps = 1
2023-06-25 05:11:35,186 - __main__ - INFO -   Dataset example num = 70076
2023-06-25 05:11:35,186 - __main__ - INFO -   step each epoch = 8759
2023-06-25 05:22:57,942 - __main__ - INFO - {"learning_rate": 8.897777777777777e-07, "loss": 0.16522389512480004, "normal_loss": 0.0, "contr_loss": 0.16522389512480004, "step": 12100}
2023-06-25 05:34:09,175 - __main__ - INFO - {"learning_rate": 8.897777777777777e-07, "loss": 0.14263654168176798, "normal_loss": 0.0, "contr_loss": 0.14263654168176798, "step": 12200}
2023-06-25 05:45:31,056 - __main__ - INFO - {"learning_rate": 8.897777777777777e-07, "loss": 0.0779026578337266, "normal_loss": 0.0, "contr_loss": 0.0779026578337266, "step": 12300}
2023-06-25 05:56:54,517 - __main__ - INFO - {"learning_rate": 8.897777777777777e-07, "loss": 0.10922337105527617, "normal_loss": 0.0, "contr_loss": 0.10922337105527617, "step": 12400}
2023-06-25 06:08:18,347 - __main__ - INFO - {"learning_rate": 8.897777777777777e-07, "loss": 0.09161074165171158, "normal_loss": 0.0, "contr_loss": 0.09161074165171158, "step": 12500}
2023-06-25 06:14:18,557 - __main__ - INFO - {"learning_rate": 8.75111111111111e-07, "loss": 0.2639629621902714, "normal_loss": 0.2553442783752689, "contr_loss": 0.00861868381500244, "step": 12600}
2023-06-25 06:20:19,415 - __main__ - INFO - {"learning_rate": 8.602962962962963e-07, "loss": 0.21167634460158297, "normal_loss": 0.21167634460158297, "contr_loss": 0.0, "step": 12700}
2023-06-25 06:26:24,791 - __main__ - INFO - {"learning_rate": 8.454814814814814e-07, "loss": 0.20925526058854302, "normal_loss": 0.20925526058854302, "contr_loss": 0.0, "step": 12800}
2023-06-25 06:32:32,547 - __main__ - INFO - {"learning_rate": 8.306666666666666e-07, "loss": 0.21172829576862567, "normal_loss": 0.21172829576862567, "contr_loss": 0.0, "step": 12900}
2023-06-25 06:38:36,549 - __main__ - INFO - {"learning_rate": 8.158518518518518e-07, "loss": 0.21040888647781686, "normal_loss": 0.21040888647781686, "contr_loss": 0.0, "step": 13000}
2023-06-25 06:44:42,947 - __main__ - INFO - {"learning_rate": 8.01037037037037e-07, "loss": 0.226752506144403, "normal_loss": 0.226752506144403, "contr_loss": 0.0, "step": 13100}
2023-06-25 06:50:44,554 - __main__ - INFO - {"learning_rate": 7.862222222222222e-07, "loss": 0.22090001460164785, "normal_loss": 0.22090001460164785, "contr_loss": 0.0, "step": 13200}
2023-06-25 06:56:50,389 - __main__ - INFO - {"learning_rate": 7.714074074074074e-07, "loss": 0.18397707055264617, "normal_loss": 0.18397707055264617, "contr_loss": 0.0, "step": 13300}
2023-06-25 07:02:49,583 - __main__ - INFO - {"learning_rate": 7.565925925925925e-07, "loss": 0.19653289192938245, "normal_loss": 0.19653289192938245, "contr_loss": 0.0, "step": 13400}
2023-06-25 07:08:52,870 - __main__ - INFO - {"learning_rate": 7.417777777777777e-07, "loss": 0.25102222664980217, "normal_loss": 0.25102222664980217, "contr_loss": 0.0, "step": 13500}
2023-06-25 07:14:58,766 - __main__ - INFO - {"learning_rate": 7.269629629629628e-07, "loss": 0.22619683638913557, "normal_loss": 0.22619683638913557, "contr_loss": 0.0, "step": 13600}
2023-06-25 07:21:05,331 - __main__ - INFO - {"learning_rate": 7.121481481481482e-07, "loss": 0.17010684885724914, "normal_loss": 0.17010684885724914, "contr_loss": 0.0, "step": 13700}
2023-06-25 07:27:05,818 - __main__ - INFO - {"learning_rate": 6.973333333333333e-07, "loss": 0.2350008152454393, "normal_loss": 0.2350008152454393, "contr_loss": 0.0, "step": 13800}
2023-06-25 07:33:09,772 - __main__ - INFO - {"learning_rate": 6.825185185185185e-07, "loss": 0.18369110938481753, "normal_loss": 0.18369110938481753, "contr_loss": 0.0, "step": 13900}
2023-06-25 07:39:19,734 - __main__ - INFO - {"learning_rate": 6.677037037037036e-07, "loss": 0.22306804381369147, "normal_loss": 0.22306804381369147, "contr_loss": 0.0, "step": 14000}
2023-06-25 07:39:25,439 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint
2023-06-25 07:39:34,670 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint-reranker
2023-06-25 07:39:37,795 - __main__ - INFO -  global_step = 14000
2023-06-25 07:40:06,049 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-25 07:44:00,295 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-25 07:44:00,371 - __main__ - INFO - Embedding generation for 5253831 passages from idx 0 to 5253831
2023-06-25 07:44:14,981 - __main__ - INFO - Encoded passages 512
2023-06-25 07:47:45,055 - __main__ - INFO - Encoded passages 51712
2023-06-25 07:51:15,772 - __main__ - INFO - Encoded passages 102912
2023-06-25 07:54:46,550 - __main__ - INFO - Encoded passages 154112
2023-06-25 07:58:17,035 - __main__ - INFO - Encoded passages 205312
2023-06-25 08:01:47,546 - __main__ - INFO - Encoded passages 256512
2023-06-25 08:05:18,047 - __main__ - INFO - Encoded passages 307712
2023-06-25 08:08:48,555 - __main__ - INFO - Encoded passages 358912
2023-06-25 08:12:19,066 - __main__ - INFO - Encoded passages 410112
2023-06-25 08:15:49,512 - __main__ - INFO - Encoded passages 461312
2023-06-25 08:19:20,010 - __main__ - INFO - Encoded passages 512512
2023-06-25 08:22:50,524 - __main__ - INFO - Encoded passages 563712
2023-06-25 08:26:21,051 - __main__ - INFO - Encoded passages 614912
2023-06-25 08:29:51,549 - __main__ - INFO - Encoded passages 666112
2023-06-25 08:33:22,058 - __main__ - INFO - Encoded passages 717312
2023-06-25 08:36:52,569 - __main__ - INFO - Encoded passages 768512
2023-06-25 08:40:23,071 - __main__ - INFO - Encoded passages 819712
2023-06-25 08:43:53,557 - __main__ - INFO - Encoded passages 870912
2023-06-25 08:47:24,076 - __main__ - INFO - Encoded passages 922112
2023-06-25 08:50:54,560 - __main__ - INFO - Encoded passages 973312
2023-06-25 08:54:25,052 - __main__ - INFO - Encoded passages 1024512
2023-06-25 08:57:55,516 - __main__ - INFO - Encoded passages 1075712
2023-06-25 09:01:25,945 - __main__ - INFO - Encoded passages 1126912
2023-06-25 09:04:56,500 - __main__ - INFO - Encoded passages 1178112
2023-06-25 09:08:27,005 - __main__ - INFO - Encoded passages 1229312
2023-06-25 09:11:57,495 - __main__ - INFO - Encoded passages 1280512
2023-06-25 09:14:25,307 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_0.pb.
2023-06-25 09:14:36,388 - __main__ - INFO - Encoded passages 512
2023-06-25 09:18:07,065 - __main__ - INFO - Encoded passages 51712
2023-06-25 09:21:37,670 - __main__ - INFO - Encoded passages 102912
2023-06-25 09:25:08,277 - __main__ - INFO - Encoded passages 154112
2023-06-25 09:28:38,850 - __main__ - INFO - Encoded passages 205312
2023-06-25 09:32:09,453 - __main__ - INFO - Encoded passages 256512
2023-06-25 09:35:40,012 - __main__ - INFO - Encoded passages 307712
2023-06-25 09:39:10,528 - __main__ - INFO - Encoded passages 358912
2023-06-25 09:42:41,054 - __main__ - INFO - Encoded passages 410112
2023-06-25 09:46:11,586 - __main__ - INFO - Encoded passages 461312
2023-06-25 09:49:42,047 - __main__ - INFO - Encoded passages 512512
2023-06-25 09:53:12,607 - __main__ - INFO - Encoded passages 563712
2023-06-25 09:56:43,197 - __main__ - INFO - Encoded passages 614912
2023-06-25 10:00:13,723 - __main__ - INFO - Encoded passages 666112
2023-06-25 10:03:44,222 - __main__ - INFO - Encoded passages 717312
2023-06-25 10:07:14,762 - __main__ - INFO - Encoded passages 768512
2023-06-25 10:10:45,338 - __main__ - INFO - Encoded passages 819712
2023-06-25 10:14:15,889 - __main__ - INFO - Encoded passages 870912
2023-06-25 10:17:46,424 - __main__ - INFO - Encoded passages 922112
2023-06-25 10:21:16,989 - __main__ - INFO - Encoded passages 973312
2023-06-25 10:24:47,558 - __main__ - INFO - Encoded passages 1024512
2023-06-25 10:28:18,065 - __main__ - INFO - Encoded passages 1075712
2023-06-25 10:31:48,610 - __main__ - INFO - Encoded passages 1126912
2023-06-25 10:35:19,137 - __main__ - INFO - Encoded passages 1178112
2023-06-25 10:38:49,722 - __main__ - INFO - Encoded passages 1229312
2023-06-25 10:42:20,291 - __main__ - INFO - Encoded passages 1280512
2023-06-25 10:44:46,985 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_1.pb.
2023-06-25 10:44:57,617 - __main__ - INFO - Encoded passages 512
2023-06-25 10:48:28,195 - __main__ - INFO - Encoded passages 51712
2023-06-25 10:51:58,785 - __main__ - INFO - Encoded passages 102912
2023-06-25 10:55:29,316 - __main__ - INFO - Encoded passages 154112
2023-06-25 10:58:59,932 - __main__ - INFO - Encoded passages 205312
2023-06-25 11:02:30,503 - __main__ - INFO - Encoded passages 256512
2023-06-25 11:06:00,998 - __main__ - INFO - Encoded passages 307712
2023-06-25 11:09:31,538 - __main__ - INFO - Encoded passages 358912
2023-06-25 11:13:02,076 - __main__ - INFO - Encoded passages 410112
2023-06-25 11:16:32,607 - __main__ - INFO - Encoded passages 461312
2023-06-25 11:20:03,188 - __main__ - INFO - Encoded passages 512512
2023-06-25 11:23:33,748 - __main__ - INFO - Encoded passages 563712
2023-06-25 11:27:04,322 - __main__ - INFO - Encoded passages 614912
2023-06-25 11:30:34,890 - __main__ - INFO - Encoded passages 666112
2023-06-25 11:34:05,414 - __main__ - INFO - Encoded passages 717312
2023-06-25 11:37:35,957 - __main__ - INFO - Encoded passages 768512
2023-06-25 11:41:06,456 - __main__ - INFO - Encoded passages 819712
2023-06-25 11:44:37,059 - __main__ - INFO - Encoded passages 870912
2023-06-25 11:48:07,670 - __main__ - INFO - Encoded passages 922112
2023-06-25 11:51:38,244 - __main__ - INFO - Encoded passages 973312
2023-06-25 11:55:08,823 - __main__ - INFO - Encoded passages 1024512
2023-06-25 11:58:39,387 - __main__ - INFO - Encoded passages 1075712
2023-06-25 12:02:09,947 - __main__ - INFO - Encoded passages 1126912
2023-06-25 12:05:40,506 - __main__ - INFO - Encoded passages 1178112
2023-06-25 12:09:11,126 - __main__ - INFO - Encoded passages 1229312
2023-06-25 12:12:41,697 - __main__ - INFO - Encoded passages 1280512
2023-06-25 12:15:11,643 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_2.pb.
2023-06-25 12:15:21,701 - __main__ - INFO - Encoded passages 512
2023-06-25 12:18:52,348 - __main__ - INFO - Encoded passages 51712
2023-06-25 12:22:22,946 - __main__ - INFO - Encoded passages 102912
2023-06-25 12:25:53,515 - __main__ - INFO - Encoded passages 154112
2023-06-25 12:29:24,130 - __main__ - INFO - Encoded passages 205312
2023-06-25 12:32:54,737 - __main__ - INFO - Encoded passages 256512
2023-06-25 12:36:25,336 - __main__ - INFO - Encoded passages 307712
2023-06-25 12:39:55,804 - __main__ - INFO - Encoded passages 358912
2023-06-25 12:43:26,326 - __main__ - INFO - Encoded passages 410112
2023-06-25 12:46:56,866 - __main__ - INFO - Encoded passages 461312
2023-06-25 12:50:27,412 - __main__ - INFO - Encoded passages 512512
2023-06-25 12:53:58,005 - __main__ - INFO - Encoded passages 563712
2023-06-25 12:57:28,598 - __main__ - INFO - Encoded passages 614912
2023-06-25 13:00:59,123 - __main__ - INFO - Encoded passages 666112
2023-06-25 13:04:29,672 - __main__ - INFO - Encoded passages 717312
2023-06-25 13:08:00,233 - __main__ - INFO - Encoded passages 768512
2023-06-25 13:11:30,788 - __main__ - INFO - Encoded passages 819712
2023-06-25 13:15:01,389 - __main__ - INFO - Encoded passages 870912
2023-06-25 13:18:31,873 - __main__ - INFO - Encoded passages 922112
2023-06-25 13:22:02,447 - __main__ - INFO - Encoded passages 973312
2023-06-25 13:25:32,983 - __main__ - INFO - Encoded passages 1024512
2023-06-25 13:29:03,540 - __main__ - INFO - Encoded passages 1075712
2023-06-25 13:32:34,124 - __main__ - INFO - Encoded passages 1126912
2023-06-25 13:36:04,649 - __main__ - INFO - Encoded passages 1178112
2023-06-25 13:39:35,183 - __main__ - INFO - Encoded passages 1229312
2023-06-25 13:43:05,763 - __main__ - INFO - Encoded passages 1280512
2023-06-25 13:45:34,225 - __main__ - INFO - Total passages processed 1313460. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_3.pb.
2023-06-25 13:45:34,641 - __main__ - INFO -  global_step = 14000
2023-06-25 13:51:04,745 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-25 13:54:02,209 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-25 13:54:02,210 - __main__ - INFO - load_passage_begin
2023-06-25 13:54:38,906 - __main__ - INFO - load_passage_id_begin
2023-06-25 13:55:27,032 - __main__ - INFO - load_passage_done
2023-06-25 13:55:28,918 - __main__ - INFO - Loadingtrainanswers
2023-06-25 13:55:43,759 - __main__ - INFO - Encoded question 512
2023-06-25 13:56:58,949 - __main__ - INFO - Loadingdevanswers
2023-06-25 13:57:07,057 - __main__ - INFO - Encoded question 512
2023-06-25 13:57:16,797 - __main__ - INFO - Loadingtestanswers
2023-06-25 13:57:25,233 - __main__ - INFO - Encoded question 512
2023-06-25 13:57:38,393 - __main__ - INFO - ***** Begin passage_embedding reorder *****
2023-06-25 13:58:42,410 - __main__ - INFO - ***** end passage_embedding reorder  *****
2023-06-25 13:58:49,015 - __main__ - INFO - ***** begin add passages  *****
2023-06-25 14:28:53,257 - __main__ - INFO - ***** end build index  *****
2023-06-25 14:33:01,667 - __main__ - INFO - Per question validation results len=78785
2023-06-25 14:33:02,090 - __main__ - INFO - Validation results: top k documents hits [64899, 67047, 67854, 68213, 68443, 68602, 68733, 68829, 68902, 68957, 69024, 69074, 69128, 69175, 69203, 69238, 69262, 69290, 69314, 69344, 69365, 69392, 69408, 69436, 69455, 69467, 69480, 69489, 69499, 69508, 69523, 69529, 69542, 69558, 69568, 69573, 69582, 69590, 69604, 69617, 69630, 69639, 69644, 69655, 69666, 69672, 69678, 69687, 69697, 69702, 69710, 69718, 69726, 69734, 69740, 69744, 69753, 69763, 69766, 69773, 69780, 69784, 69791, 69797, 69803, 69811, 69818, 69826, 69828, 69832, 69839, 69845, 69851, 69854, 69860, 69866, 69871, 69875, 69882, 69886, 69889, 69891, 69899, 69904, 69907, 69910, 69912, 69913, 69920, 69926, 69931, 69938, 69939, 69943, 69944, 69946, 69948, 69949, 69953, 69957]
2023-06-25 14:33:02,090 - __main__ - INFO - Validation results: top k documents hits accuracy [0.8237481754141017, 0.8510122485244653, 0.8612553150980516, 0.8658120200545789, 0.8687313574919083, 0.8707495081551057, 0.8724122612172368, 0.8736307672780351, 0.8745573395951006, 0.8752554420257663, 0.8761058577140318, 0.8767404962873644, 0.8774259059465634, 0.878022466205496, 0.8783778638065621, 0.8788221108078949, 0.8791267373230945, 0.8794821349241607, 0.8797867614393603, 0.8801675445833598, 0.8804340927841594, 0.8807767976137589, 0.8809798819572253, 0.8813352795582916, 0.8815764422161579, 0.8817287554737577, 0.8818937615028242, 0.882007996446024, 0.8821349241606905, 0.8822491591038903, 0.8824395506758901, 0.88251570730469, 0.8826807133337564, 0.8828837976772228, 0.8830107253918893, 0.8830741892492225, 0.8831884241924224, 0.8832899663641556, 0.8834676651646887, 0.8836326711937551, 0.8837976772228217, 0.8839119121660215, 0.8839753760233547, 0.8841149965094879, 0.884254616995621, 0.8843307736244209, 0.8844069302532208, 0.8845211651964207, 0.8846480929110871, 0.8847115567684204, 0.8848130989401536, 0.8849146411118868, 0.88501618328362, 0.8851177254553532, 0.8851938820841531, 0.8852446531700197, 0.8853588881132195, 0.885485815827886, 0.8855238941422859, 0.8856127435425525, 0.885701592942819, 0.8857523640286856, 0.8858412134289522, 0.8859173700577521, 0.885993526686552, 0.8860950688582853, 0.8861839182585518, 0.886285460430285, 0.8863108459732183, 0.8863616170590849, 0.8864504664593514, 0.8865266230881513, 0.8866027797169512, 0.8866408580313512, 0.8867170146601511, 0.886793171288951, 0.8868566351462842, 0.8869074062321508, 0.8869962556324174, 0.887047026718284, 0.8870851050326839, 0.8871104905756172, 0.8872120327473504, 0.8872754966046836, 0.8873135749190836, 0.8873516532334835, 0.8873770387764168, 0.8873897315478835, 0.88747858094815, 0.8875547375769499, 0.8876182014342832, 0.8877070508345497, 0.8877197436060164, 0.887770514691883, 0.8877832074633496, 0.8878085930062829, 0.8878339785492162, 0.8878466713206828, 0.8878974424065494, 0.887948213492416]
2023-06-25 14:33:16,987 - __main__ - INFO - writing new train top-k
2023-06-25 14:33:16,988 - __main__ - INFO - writing new train data
2023-06-25 14:35:56,937 - __main__ - INFO - Per question validation results len=8837
2023-06-25 14:35:56,995 - __main__ - INFO - Validation results: top k documents hits [5603, 6284, 6630, 6816, 6930, 7022, 7088, 7159, 7194, 7237, 7272, 7303, 7337, 7357, 7375, 7400, 7417, 7437, 7453, 7467, 7480, 7488, 7500, 7514, 7527, 7536, 7548, 7562, 7569, 7576, 7584, 7587, 7591, 7599, 7605, 7613, 7616, 7630, 7639, 7641, 7645, 7648, 7653, 7654, 7662, 7669, 7672, 7679, 7680, 7681, 7683, 7686, 7690, 7691, 7695, 7698, 7703, 7706, 7707, 7709, 7714, 7715, 7721, 7724, 7725, 7729, 7731, 7733, 7734, 7736, 7738, 7741, 7743, 7744, 7744, 7745, 7747, 7750, 7753, 7753, 7757, 7757, 7758, 7759, 7759, 7759, 7763, 7764, 7765, 7767, 7768, 7769, 7774, 7777, 7780, 7782, 7783, 7783, 7783, 7784]
2023-06-25 14:35:56,996 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6340387009166006, 0.7111010523933462, 0.7502546112934254, 0.7713024782165894, 0.7842027837501414, 0.7946135566368677, 0.8020821545773452, 0.8101165553921014, 0.8140771755120516, 0.8189430802308476, 0.8229037003507977, 0.8264116781713251, 0.8302591377164196, 0.832522349213534, 0.8345592395609369, 0.83738825393233, 0.8393119837048773, 0.8415751952019916, 0.8433857643996832, 0.8449700124476632, 0.8464410999207876, 0.8473463845196334, 0.848704311417902, 0.8502885594658821, 0.8517596469390064, 0.8527780921127079, 0.8541360190109766, 0.8557202670589567, 0.8565123910829467, 0.8573045151069367, 0.8582097997057825, 0.8585492814303497, 0.8590019237297726, 0.8599072083286183, 0.8605861717777527, 0.8614914563765984, 0.8618309381011655, 0.8634151861491456, 0.8644336313228471, 0.8646599524725586, 0.8651125947719814, 0.8654520764965487, 0.8660178793708272, 0.866131039945683, 0.8670363245445287, 0.8678284485685187, 0.8681679302930859, 0.8689600543170759, 0.8690732148919317, 0.8691863754667873, 0.8694126966164988, 0.869752178341066, 0.8702048206404889, 0.8703179812153445, 0.8707706235147674, 0.8711101052393346, 0.8716759081136132, 0.8720153898381804, 0.872128550413036, 0.8723548715627475, 0.8729206744370261, 0.8730338350118818, 0.8737127984610161, 0.8740522801855833, 0.8741654407604391, 0.874618083059862, 0.8748444042095734, 0.8750707253592849, 0.8751838859341405, 0.875410207083852, 0.8756365282335634, 0.8759760099581306, 0.8762023311078421, 0.8763154916826977, 0.8763154916826977, 0.8764286522575535, 0.876654973407265, 0.876994455131832, 0.8773339368563993, 0.8773339368563993, 0.8777865791558221, 0.8777865791558221, 0.8778997397306778, 0.8780129003055336, 0.8780129003055336, 0.8780129003055336, 0.8784655426049565, 0.8785787031798121, 0.8786918637546679, 0.8789181849043793, 0.879031345479235, 0.8791445060540908, 0.8797103089283693, 0.8800497906529365, 0.8803892723775036, 0.8806155935272151, 0.8807287541020709, 0.8807287541020709, 0.8807287541020709, 0.8808419146769265]
2023-06-25 14:36:05,695 - __main__ - INFO - writing new dev top-k
2023-06-25 14:36:05,695 - __main__ - INFO - writing new dev data
2023-06-25 14:37:21,316 - __main__ - INFO - Per question validation results len=11313
2023-06-25 14:37:21,389 - __main__ - INFO - Validation results: top k documents hits [7269, 8104, 8473, 8722, 8892, 9018, 9102, 9175, 9246, 9305, 9352, 9393, 9426, 9456, 9479, 9510, 9537, 9555, 9579, 9593, 9606, 9619, 9632, 9646, 9657, 9673, 9679, 9690, 9700, 9708, 9717, 9725, 9735, 9753, 9756, 9761, 9770, 9778, 9787, 9793, 9799, 9802, 9805, 9813, 9823, 9825, 9826, 9834, 9841, 9843, 9845, 9848, 9852, 9857, 9862, 9865, 9868, 9869, 9874, 9877, 9883, 9886, 9891, 9892, 9896, 9899, 9900, 9903, 9906, 9908, 9912, 9916, 9917, 9920, 9923, 9925, 9926, 9929, 9936, 9941, 9943, 9949, 9954, 9956, 9959, 9963, 9966, 9970, 9972, 9977, 9978, 9980, 9980, 9983, 9985, 9987, 9990, 9991, 9991, 9992]
2023-06-25 14:37:21,389 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6425351365685494, 0.7163440289931937, 0.7489613718730663, 0.7709714487757447, 0.7859984089101034, 0.7971360381861575, 0.8045611243701936, 0.8110138778396535, 0.8172898435428269, 0.8225050826482807, 0.8266595951560152, 0.8302837443648899, 0.8332007425086184, 0.835852559002917, 0.8378856183152126, 0.8406258286926545, 0.8430124635375232, 0.8446035534341023, 0.8467250066295412, 0.8479625209935473, 0.84911164147441, 0.8502607619552727, 0.8514098824361355, 0.8526473968001415, 0.8536197295147175, 0.8550340316450101, 0.8555643949438699, 0.856536727658446, 0.8574206664898789, 0.8581278175550252, 0.8589233625033148, 0.8596305135684611, 0.8605144523998939, 0.8621055422964731, 0.862370723945903, 0.8628126933616194, 0.863608238309909, 0.8643153893750553, 0.8651109343233448, 0.8656412976222045, 0.8661716609210642, 0.8664368425704941, 0.8667020242199239, 0.8674091752850702, 0.8682931141165031, 0.8684699018827897, 0.868558295765933, 0.8692654468310793, 0.8698842040130823, 0.8700609917793689, 0.8702377795456554, 0.8705029611950853, 0.8708565367276584, 0.8712985061433749, 0.8717404755590913, 0.8720056572085212, 0.872270838857951, 0.8723592327410943, 0.8728012021568108, 0.8730663838062406, 0.8735967471051004, 0.8738619287545302, 0.8743038981702467, 0.8743922920533899, 0.8747458675859631, 0.8750110492353929, 0.8750994431185362, 0.8753646247679661, 0.875629806417396, 0.8758065941836825, 0.8761601697162557, 0.8765137452488287, 0.876602139131972, 0.876867320781402, 0.8771325024308317, 0.8773092901971183, 0.8773976840802616, 0.8776628657296915, 0.8782816229116945, 0.8787235923274109, 0.8789003800936975, 0.8794307433925572, 0.8798727128082736, 0.8800495005745602, 0.8803146822239901, 0.8806682577565632, 0.8809334394059931, 0.8812870149385662, 0.8814638027048528, 0.8819057721205693, 0.8819941660037125, 0.8821709537699991, 0.8821709537699991, 0.882436135419429, 0.8826129231857156, 0.8827897109520021, 0.883054892601432, 0.8831432864845753, 0.8831432864845753, 0.8832316803677186]
2023-06-25 14:37:30,293 - __main__ - INFO - writing new test top-k
2023-06-25 14:37:30,293 - __main__ - INFO - writing new test data
2023-06-25 14:37:32,460 - __main__ - INFO -  global_step = 14000
2023-06-25 21:01:31,832 - __main__ - INFO - Training/evaluation parameters Namespace(model_type='nghuyong/ernie-2.0-base-en', model_name_or_path='../TQ/triviaqa_fintinue.pkl', model_name_or_path_ict=None, output_dir='output/co_training_tq_simANS_test', num_epoch=0, config_name='', tokenizer_name='', corpus_path='', max_seq_length=256, max_query_length=32, triplet=False, log_dir='tensorboard_log/co_training_tq_simANS_test', optimizer='adamW', per_gpu_train_batch_size=8, gradient_accumulation_steps=1, learning_rate=2e-06, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=2.0, max_steps=20000, warmup_steps=1000, logging_steps=100, save_steps=2000, no_cuda=False, seed=42, fp16=False, fp16_opt_level='O1', gradient_checkpointing=True, contr_loss=False, normal_loss=True, origin_data_dir='output/co_training_tq_simANS_test/temp/train_ce.json', load_optimizer_scheduler=False, single_warmup=True, adv_data_path=None, ann_data_path=None, fix_embedding=False, continue_train=False, adv_loss_alpha=0.3, reranker_model_path='../TQ/checkpoint-reranker34000', reranker_model_type='nghuyong/ernie-2.0-large-en', number_neg=15, adv_lambda=0.0, adv_steps=3, local_rank=0, server_ip='', server_port='', test_qa_path='', train_qa_path='', dev_qa_path='', passage_path='', iteration_step=2000, iteration_reranker_step=500, temperature_normal=1.0, scale_simmila=False, reranker_learning_rate=5e-07, load_cache=False, ann_dir='output/co_training_tq_simANS_test/temp', normal_term='cross_e', global_step=14000, a=0.5, b=0, n_gpu=1, device=device(type='cuda', index=0), world_size=4, rank=0)
2023-06-25 21:01:33,335 - __main__ - INFO - Loading checkpoint @ step=14000
2023-06-25 21:01:33,335 - __main__ - INFO - Loading saved model state ...
2023-06-25 21:01:43,237 - __main__ - INFO - Loading checkpoint @ step=14000
2023-06-25 21:01:43,238 - __main__ - INFO - Loading saved model state ...
2023-06-25 21:01:57,584 - __main__ - INFO - ***** Running training *****
2023-06-25 21:01:57,584 - __main__ - INFO -   Max steps = 20000
2023-06-25 21:01:57,584 - __main__ - INFO -   Instantaneous batch size per GPU = 8
2023-06-25 21:01:57,584 - __main__ - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 32
2023-06-25 21:01:57,584 - __main__ - INFO -   Gradient Accumulation steps = 1
2023-06-25 21:01:57,584 - __main__ - INFO -   Dataset example num = 70113
2023-06-25 21:01:57,584 - __main__ - INFO -   step each epoch = 8764
2023-06-25 21:15:06,518 - __main__ - INFO - {"learning_rate": 6.677037037037036e-07, "loss": 0.19307062563900218, "normal_loss": 0.0, "contr_loss": 0.19307062563900218, "step": 14100}
2023-06-25 21:28:26,187 - __main__ - INFO - {"learning_rate": 6.677037037037036e-07, "loss": 0.12075764552140754, "normal_loss": 0.0, "contr_loss": 0.12075764552140754, "step": 14200}
2023-06-25 21:41:21,866 - __main__ - INFO - {"learning_rate": 6.677037037037036e-07, "loss": 0.1351754609728141, "normal_loss": 0.0, "contr_loss": 0.1351754609728141, "step": 14300}
2023-06-25 21:54:32,453 - __main__ - INFO - {"learning_rate": 6.677037037037036e-07, "loss": 0.10962502536658576, "normal_loss": 0.0, "contr_loss": 0.10962502536658576, "step": 14400}
2023-06-25 22:07:34,986 - __main__ - INFO - {"learning_rate": 6.677037037037036e-07, "loss": 0.18442222705233235, "normal_loss": 0.0, "contr_loss": 0.18442222705233235, "step": 14500}
2023-06-25 22:14:40,493 - __main__ - INFO - {"learning_rate": 6.530370370370371e-07, "loss": 0.23469309852007428, "normal_loss": 0.23469096521817845, "contr_loss": 2.1333018958102914e-06, "step": 14600}
2023-06-25 22:21:42,323 - __main__ - INFO - {"learning_rate": 6.382222222222222e-07, "loss": 0.24586811484012286, "normal_loss": 0.24586811484012286, "contr_loss": 0.0, "step": 14700}
2023-06-25 22:28:41,665 - __main__ - INFO - {"learning_rate": 6.234074074074074e-07, "loss": 0.19435470224183518, "normal_loss": 0.19435470224183518, "contr_loss": 0.0, "step": 14800}
2023-06-25 22:35:40,599 - __main__ - INFO - {"learning_rate": 6.085925925925925e-07, "loss": 0.211915997590404, "normal_loss": 0.211915997590404, "contr_loss": 0.0, "step": 14900}
2023-06-25 22:42:39,919 - __main__ - INFO - {"learning_rate": 5.937777777777777e-07, "loss": 0.25144477920490316, "normal_loss": 0.25144477920490316, "contr_loss": 0.0, "step": 15000}
2023-06-25 22:49:39,725 - __main__ - INFO - {"learning_rate": 5.78962962962963e-07, "loss": 0.1945186793326866, "normal_loss": 0.1945186793326866, "contr_loss": 0.0, "step": 15100}
2023-06-25 22:56:41,704 - __main__ - INFO - {"learning_rate": 5.641481481481482e-07, "loss": 0.1990158837812487, "normal_loss": 0.1990158837812487, "contr_loss": 0.0, "step": 15200}
2023-06-25 23:03:42,018 - __main__ - INFO - {"learning_rate": 5.493333333333333e-07, "loss": 0.19478021881746826, "normal_loss": 0.19478021881746826, "contr_loss": 0.0, "step": 15300}
2023-06-25 23:10:43,490 - __main__ - INFO - {"learning_rate": 5.345185185185185e-07, "loss": 0.23535522131831385, "normal_loss": 0.23535522131831385, "contr_loss": 0.0, "step": 15400}
2023-06-25 23:17:42,163 - __main__ - INFO - {"learning_rate": 5.197037037037036e-07, "loss": 0.25346426659845744, "normal_loss": 0.25346426659845744, "contr_loss": 0.0, "step": 15500}
2023-06-25 23:24:43,598 - __main__ - INFO - {"learning_rate": 5.048888888888889e-07, "loss": 0.20492561396909878, "normal_loss": 0.20492561396909878, "contr_loss": 0.0, "step": 15600}
2023-06-25 23:31:45,769 - __main__ - INFO - {"learning_rate": 4.90074074074074e-07, "loss": 0.19135205633028818, "normal_loss": 0.19135205633028818, "contr_loss": 0.0, "step": 15700}
2023-06-25 23:38:44,730 - __main__ - INFO - {"learning_rate": 4.7525925925925926e-07, "loss": 0.21032375062233769, "normal_loss": 0.21032375062233769, "contr_loss": 0.0, "step": 15800}
2023-06-25 23:45:44,672 - __main__ - INFO - {"learning_rate": 4.604444444444444e-07, "loss": 0.2251298422573018, "normal_loss": 0.2251298422573018, "contr_loss": 0.0, "step": 15900}
2023-06-25 23:52:39,849 - __main__ - INFO - {"learning_rate": 4.4562962962962964e-07, "loss": 0.219568381664576, "normal_loss": 0.219568381664576, "contr_loss": 0.0, "step": 16000}
2023-06-25 23:52:45,589 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint
2023-06-25 23:52:54,137 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint-reranker
2023-06-25 23:52:57,081 - __main__ - INFO -  global_step = 16000
2023-06-25 23:53:27,688 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-25 23:57:38,232 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-25 23:57:38,315 - __main__ - INFO - Embedding generation for 5253831 passages from idx 0 to 5253831
2023-06-25 23:57:53,910 - __main__ - INFO - Encoded passages 512
2023-06-26 00:01:23,810 - __main__ - INFO - Encoded passages 51712
2023-06-26 00:04:54,292 - __main__ - INFO - Encoded passages 102912
2023-06-26 00:08:24,792 - __main__ - INFO - Encoded passages 154112
2023-06-26 00:11:55,198 - __main__ - INFO - Encoded passages 205312
2023-06-26 00:15:25,630 - __main__ - INFO - Encoded passages 256512
2023-06-26 00:18:56,069 - __main__ - INFO - Encoded passages 307712
2023-06-26 00:22:26,500 - __main__ - INFO - Encoded passages 358912
2023-06-26 00:25:56,908 - __main__ - INFO - Encoded passages 410112
2023-06-26 00:29:27,314 - __main__ - INFO - Encoded passages 461312
2023-06-26 00:32:57,771 - __main__ - INFO - Encoded passages 512512
2023-06-26 00:36:28,213 - __main__ - INFO - Encoded passages 563712
2023-06-26 00:39:58,627 - __main__ - INFO - Encoded passages 614912
2023-06-26 00:43:29,059 - __main__ - INFO - Encoded passages 666112
2023-06-26 00:46:59,463 - __main__ - INFO - Encoded passages 717312
2023-06-26 00:50:29,894 - __main__ - INFO - Encoded passages 768512
2023-06-26 00:54:00,307 - __main__ - INFO - Encoded passages 819712
2023-06-26 00:57:30,734 - __main__ - INFO - Encoded passages 870912
2023-06-26 01:01:01,190 - __main__ - INFO - Encoded passages 922112
2023-06-26 01:04:31,635 - __main__ - INFO - Encoded passages 973312
2023-06-26 01:08:02,087 - __main__ - INFO - Encoded passages 1024512
2023-06-26 01:11:32,532 - __main__ - INFO - Encoded passages 1075712
2023-06-26 01:15:03,011 - __main__ - INFO - Encoded passages 1126912
2023-06-26 01:18:33,430 - __main__ - INFO - Encoded passages 1178112
2023-06-26 01:22:03,832 - __main__ - INFO - Encoded passages 1229312
2023-06-26 01:25:34,277 - __main__ - INFO - Encoded passages 1280512
2023-06-26 01:28:01,804 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_0.pb.
2023-06-26 01:28:11,794 - __main__ - INFO - Encoded passages 512
2023-06-26 01:31:42,521 - __main__ - INFO - Encoded passages 51712
2023-06-26 01:35:13,387 - __main__ - INFO - Encoded passages 102912
2023-06-26 01:38:44,216 - __main__ - INFO - Encoded passages 154112
2023-06-26 01:42:15,036 - __main__ - INFO - Encoded passages 205312
2023-06-26 01:45:45,830 - __main__ - INFO - Encoded passages 256512
2023-06-26 01:49:16,619 - __main__ - INFO - Encoded passages 307712
2023-06-26 01:52:47,383 - __main__ - INFO - Encoded passages 358912
2023-06-26 01:56:18,167 - __main__ - INFO - Encoded passages 410112
2023-06-26 01:59:48,953 - __main__ - INFO - Encoded passages 461312
2023-06-26 02:03:19,703 - __main__ - INFO - Encoded passages 512512
2023-06-26 02:06:50,450 - __main__ - INFO - Encoded passages 563712
2023-06-26 02:10:21,251 - __main__ - INFO - Encoded passages 614912
2023-06-26 02:13:52,022 - __main__ - INFO - Encoded passages 666112
2023-06-26 02:17:22,815 - __main__ - INFO - Encoded passages 717312
2023-06-26 02:20:53,573 - __main__ - INFO - Encoded passages 768512
2023-06-26 02:24:24,320 - __main__ - INFO - Encoded passages 819712
2023-06-26 02:27:55,109 - __main__ - INFO - Encoded passages 870912
2023-06-26 02:31:25,839 - __main__ - INFO - Encoded passages 922112
2023-06-26 02:34:56,559 - __main__ - INFO - Encoded passages 973312
2023-06-26 02:38:27,306 - __main__ - INFO - Encoded passages 1024512
2023-06-26 02:41:58,013 - __main__ - INFO - Encoded passages 1075712
2023-06-26 02:45:28,774 - __main__ - INFO - Encoded passages 1126912
2023-06-26 02:48:59,475 - __main__ - INFO - Encoded passages 1178112
2023-06-26 02:52:30,210 - __main__ - INFO - Encoded passages 1229312
2023-06-26 02:56:00,954 - __main__ - INFO - Encoded passages 1280512
2023-06-26 02:58:27,900 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_1.pb.
2023-06-26 02:58:38,735 - __main__ - INFO - Encoded passages 512
2023-06-26 03:02:09,313 - __main__ - INFO - Encoded passages 51712
2023-06-26 03:05:40,223 - __main__ - INFO - Encoded passages 102912
2023-06-26 03:09:11,054 - __main__ - INFO - Encoded passages 154112
2023-06-26 03:12:41,805 - __main__ - INFO - Encoded passages 205312
2023-06-26 03:16:12,575 - __main__ - INFO - Encoded passages 256512
2023-06-26 03:19:43,318 - __main__ - INFO - Encoded passages 307712
2023-06-26 03:23:14,058 - __main__ - INFO - Encoded passages 358912
2023-06-26 03:26:44,756 - __main__ - INFO - Encoded passages 410112
2023-06-26 03:30:15,486 - __main__ - INFO - Encoded passages 461312
2023-06-26 03:33:46,193 - __main__ - INFO - Encoded passages 512512
2023-06-26 03:37:16,920 - __main__ - INFO - Encoded passages 563712
2023-06-26 03:40:47,667 - __main__ - INFO - Encoded passages 614912
2023-06-26 03:44:18,435 - __main__ - INFO - Encoded passages 666112
2023-06-26 03:47:49,237 - __main__ - INFO - Encoded passages 717312
2023-06-26 03:51:20,039 - __main__ - INFO - Encoded passages 768512
2023-06-26 03:54:50,819 - __main__ - INFO - Encoded passages 819712
2023-06-26 03:58:21,574 - __main__ - INFO - Encoded passages 870912
2023-06-26 04:01:52,363 - __main__ - INFO - Encoded passages 922112
2023-06-26 04:05:23,099 - __main__ - INFO - Encoded passages 973312
2023-06-26 04:08:53,869 - __main__ - INFO - Encoded passages 1024512
2023-06-26 04:12:24,604 - __main__ - INFO - Encoded passages 1075712
2023-06-26 04:15:55,398 - __main__ - INFO - Encoded passages 1126912
2023-06-26 04:19:26,175 - __main__ - INFO - Encoded passages 1178112
2023-06-26 04:22:56,967 - __main__ - INFO - Encoded passages 1229312
2023-06-26 04:26:27,702 - __main__ - INFO - Encoded passages 1280512
2023-06-26 04:28:55,364 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_2.pb.
2023-06-26 04:29:06,161 - __main__ - INFO - Encoded passages 512
2023-06-26 04:32:36,928 - __main__ - INFO - Encoded passages 51712
2023-06-26 04:36:07,680 - __main__ - INFO - Encoded passages 102912
2023-06-26 04:39:38,480 - __main__ - INFO - Encoded passages 154112
2023-06-26 04:43:09,299 - __main__ - INFO - Encoded passages 205312
2023-06-26 04:46:40,039 - __main__ - INFO - Encoded passages 256512
2023-06-26 04:50:10,771 - __main__ - INFO - Encoded passages 307712
2023-06-26 04:53:41,545 - __main__ - INFO - Encoded passages 358912
2023-06-26 04:57:12,298 - __main__ - INFO - Encoded passages 410112
2023-06-26 05:00:43,052 - __main__ - INFO - Encoded passages 461312
2023-06-26 05:04:13,836 - __main__ - INFO - Encoded passages 512512
2023-06-26 05:07:44,606 - __main__ - INFO - Encoded passages 563712
2023-06-26 05:11:15,405 - __main__ - INFO - Encoded passages 614912
2023-06-26 05:14:46,175 - __main__ - INFO - Encoded passages 666112
2023-06-26 05:18:16,954 - __main__ - INFO - Encoded passages 717312
2023-06-26 05:21:47,716 - __main__ - INFO - Encoded passages 768512
2023-06-26 05:25:18,525 - __main__ - INFO - Encoded passages 819712
2023-06-26 05:28:49,263 - __main__ - INFO - Encoded passages 870912
2023-06-26 05:32:20,019 - __main__ - INFO - Encoded passages 922112
2023-06-26 05:35:50,764 - __main__ - INFO - Encoded passages 973312
2023-06-26 05:39:21,486 - __main__ - INFO - Encoded passages 1024512
2023-06-26 05:42:52,246 - __main__ - INFO - Encoded passages 1075712
2023-06-26 05:46:22,990 - __main__ - INFO - Encoded passages 1126912
2023-06-26 05:49:53,765 - __main__ - INFO - Encoded passages 1178112
2023-06-26 05:53:24,520 - __main__ - INFO - Encoded passages 1229312
2023-06-26 05:56:55,221 - __main__ - INFO - Encoded passages 1280512
2023-06-26 05:59:22,948 - __main__ - INFO - Total passages processed 1313460. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_3.pb.
2023-06-26 05:59:23,385 - __main__ - INFO -  global_step = 16000
2023-06-26 06:04:46,485 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-26 06:07:44,320 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-26 06:07:44,321 - __main__ - INFO - load_passage_begin
2023-06-26 06:08:22,386 - __main__ - INFO - load_passage_id_begin
2023-06-26 06:09:11,970 - __main__ - INFO - load_passage_done
2023-06-26 06:09:13,938 - __main__ - INFO - Loadingtrainanswers
2023-06-26 06:09:26,026 - __main__ - INFO - Encoded question 512
2023-06-26 06:10:41,442 - __main__ - INFO - Loadingdevanswers
2023-06-26 06:10:49,589 - __main__ - INFO - Encoded question 512
2023-06-26 06:10:59,423 - __main__ - INFO - Loadingtestanswers
2023-06-26 06:11:08,014 - __main__ - INFO - Encoded question 512
2023-06-26 06:11:21,356 - __main__ - INFO - ***** Begin passage_embedding reorder *****
2023-06-26 06:12:19,695 - __main__ - INFO - ***** end passage_embedding reorder  *****
2023-06-26 06:12:26,742 - __main__ - INFO - ***** begin add passages  *****
2023-06-26 06:17:29,507 - __main__ - INFO - ***** end build index  *****
2023-06-26 06:21:39,324 - __main__ - INFO - Per question validation results len=78785
2023-06-26 06:21:39,746 - __main__ - INFO - Validation results: top k documents hits [64769, 66845, 67640, 67989, 68251, 68449, 68593, 68688, 68770, 68845, 68905, 68958, 69010, 69047, 69089, 69122, 69140, 69169, 69197, 69219, 69240, 69265, 69286, 69307, 69324, 69348, 69366, 69380, 69398, 69423, 69434, 69444, 69454, 69462, 69475, 69490, 69497, 69510, 69525, 69532, 69544, 69555, 69559, 69569, 69575, 69586, 69593, 69596, 69603, 69611, 69619, 69624, 69634, 69637, 69645, 69653, 69657, 69661, 69664, 69667, 69671, 69675, 69680, 69687, 69690, 69695, 69705, 69711, 69713, 69715, 69716, 69720, 69722, 69730, 69736, 69738, 69739, 69742, 69745, 69749, 69751, 69752, 69755, 69763, 69769, 69772, 69774, 69778, 69779, 69785, 69789, 69790, 69795, 69799, 69805, 69811, 69813, 69817, 69820, 69824]
2023-06-26 06:21:39,746 - __main__ - INFO - Validation results: top k documents hits accuracy [0.8220981151234372, 0.8484483086882021, 0.8585390620041886, 0.8629688392460494, 0.8662943453703116, 0.8688075141207082, 0.8706352732119058, 0.8718410865012376, 0.8728818937615028, 0.8738338516215015, 0.8745954179095006, 0.875268134797233, 0.8759281589134987, 0.8763977914577648, 0.8769308878593641, 0.8773497493177635, 0.8775782192041632, 0.8779463095766961, 0.8783017071777622, 0.8785809481500285, 0.8788474963508282, 0.8791648156374945, 0.8794313638382941, 0.8796979120390938, 0.8799136891540268, 0.8802183156692264, 0.880446785555626, 0.8806244843561591, 0.8808529542425588, 0.8811702735292251, 0.8813098940153583, 0.8814368217300248, 0.8815637494446913, 0.8816652916164245, 0.8818302976454909, 0.8820206892174907, 0.8821095386177572, 0.8822745446468236, 0.8824649362188234, 0.8825537856190899, 0.8827060988766897, 0.8828457193628229, 0.8828964904486895, 0.8830234181633559, 0.8830995747921558, 0.883239195278289, 0.8833280446785555, 0.8833661229929555, 0.883454972393222, 0.8835565145649552, 0.8836580567366884, 0.8837215205940218, 0.8838484483086883, 0.8838865266230882, 0.8839880687948214, 0.8840896109665546, 0.8841403820524212, 0.8841911531382878, 0.8842292314526877, 0.8842673097670877, 0.8843180808529543, 0.8843688519388209, 0.8844323157961541, 0.8845211651964207, 0.8845592435108206, 0.8846227073681538, 0.8847496350828203, 0.8848257917116202, 0.8848511772545535, 0.8848765627974868, 0.8848892555689535, 0.8849400266548201, 0.8849654121977534, 0.8850669543694866, 0.8851431109982865, 0.8851684965412198, 0.8851811893126864, 0.8852192676270864, 0.8852573459414863, 0.8853081170273529, 0.8853335025702862, 0.8853461953417529, 0.8853842736561528, 0.885485815827886, 0.8855619724566859, 0.8856000507710858, 0.8856254363140191, 0.8856762073998857, 0.8856889001713524, 0.8857650568001523, 0.8858158278860189, 0.8858285206574855, 0.8858919845148188, 0.8859427556006854, 0.8860189122294853, 0.8860950688582853, 0.8861204544012186, 0.8861712254870852, 0.8862093038014851, 0.8862600748873517]
2023-06-26 06:21:54,443 - __main__ - INFO - writing new train top-k
2023-06-26 06:21:54,444 - __main__ - INFO - writing new train data
2023-06-26 06:24:31,208 - __main__ - INFO - Per question validation results len=8837
2023-06-26 06:24:31,282 - __main__ - INFO - Validation results: top k documents hits [5634, 6252, 6581, 6759, 6876, 6961, 7028, 7096, 7142, 7178, 7211, 7244, 7273, 7310, 7333, 7354, 7372, 7393, 7418, 7433, 7442, 7455, 7467, 7474, 7484, 7492, 7498, 7513, 7522, 7528, 7532, 7540, 7548, 7556, 7560, 7567, 7572, 7581, 7586, 7595, 7596, 7598, 7599, 7605, 7608, 7614, 7620, 7623, 7629, 7632, 7634, 7641, 7648, 7650, 7655, 7657, 7660, 7661, 7663, 7667, 7669, 7670, 7673, 7677, 7680, 7684, 7686, 7687, 7688, 7690, 7692, 7695, 7695, 7698, 7701, 7703, 7703, 7704, 7707, 7709, 7711, 7712, 7713, 7715, 7717, 7718, 7719, 7720, 7722, 7722, 7722, 7722, 7723, 7726, 7727, 7728, 7729, 7729, 7733, 7735]
2023-06-26 06:24:31,283 - __main__ - INFO - Validation results: top k documents hits accuracy [0.637546678737128, 0.7074799139979631, 0.7447097431254951, 0.7648523254498133, 0.7780921127079325, 0.7877107615706688, 0.795292520086002, 0.802987439176191, 0.8081928256195542, 0.8122666063143601, 0.8160009052845989, 0.8197352042548376, 0.8230168609256535, 0.8272038021953152, 0.8298064954169967, 0.8321828674889669, 0.8342197578363698, 0.83659612990834, 0.8394251442797329, 0.8411225529025688, 0.8421409980762702, 0.8436120855493946, 0.8449700124476632, 0.8457621364716533, 0.8468937422202105, 0.8477990268190563, 0.8484779902681906, 0.8501753988910263, 0.8511938440647279, 0.8518728075138622, 0.8523254498132851, 0.8532307344121308, 0.8541360190109766, 0.8550413036098223, 0.8554939459092452, 0.8562860699332353, 0.8568518728075138, 0.8578703179812154, 0.8584361208554939, 0.8594545660291955, 0.8595677266040511, 0.8597940477537626, 0.8599072083286183, 0.8605861717777527, 0.8609256535023198, 0.8616046169514541, 0.8622835804005884, 0.8626230621251556, 0.8633020255742899, 0.863641507298857, 0.8638678284485685, 0.8646599524725586, 0.8654520764965487, 0.8656783976462601, 0.8662442005205386, 0.8664705216702501, 0.8668100033948173, 0.866923163969673, 0.8671494851193844, 0.8676021274188073, 0.8678284485685187, 0.8679416091433745, 0.8682810908679416, 0.8687337331673645, 0.8690732148919317, 0.8695258571913546, 0.869752178341066, 0.8698653389159217, 0.8699784994907774, 0.8702048206404889, 0.8704311417902003, 0.8707706235147674, 0.8707706235147674, 0.8711101052393346, 0.8714495869639017, 0.8716759081136132, 0.8716759081136132, 0.871789068688469, 0.872128550413036, 0.8723548715627475, 0.8725811927124589, 0.8726943532873147, 0.8728075138621704, 0.8730338350118818, 0.8732601561615932, 0.873373316736449, 0.8734864773113047, 0.8735996378861605, 0.8738259590358719, 0.8738259590358719, 0.8738259590358719, 0.8738259590358719, 0.8739391196107277, 0.8742786013352948, 0.8743917619101506, 0.8745049224850062, 0.874618083059862, 0.874618083059862, 0.8750707253592849, 0.8752970465089963]
2023-06-26 06:24:39,931 - __main__ - INFO - writing new dev top-k
2023-06-26 06:24:39,931 - __main__ - INFO - writing new dev data
2023-06-26 06:25:49,572 - __main__ - INFO - Per question validation results len=11313
2023-06-26 06:25:49,646 - __main__ - INFO - Validation results: top k documents hits [7230, 8004, 8425, 8664, 8830, 8942, 9026, 9111, 9161, 9211, 9267, 9314, 9358, 9390, 9412, 9435, 9461, 9475, 9495, 9500, 9518, 9528, 9549, 9562, 9576, 9591, 9604, 9617, 9628, 9638, 9645, 9653, 9662, 9672, 9679, 9682, 9689, 9692, 9702, 9711, 9718, 9721, 9727, 9733, 9740, 9744, 9749, 9756, 9759, 9767, 9770, 9776, 9779, 9781, 9784, 9789, 9791, 9799, 9802, 9807, 9811, 9811, 9814, 9818, 9824, 9828, 9833, 9840, 9844, 9848, 9853, 9857, 9861, 9867, 9873, 9875, 9876, 9880, 9881, 9883, 9886, 9886, 9887, 9888, 9888, 9890, 9890, 9892, 9893, 9897, 9898, 9899, 9900, 9905, 9908, 9911, 9914, 9914, 9917, 9919]
2023-06-26 06:25:49,646 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6390877751259613, 0.707504640678865, 0.7447184654821887, 0.7658446035534341, 0.7805179881552197, 0.7904181030672678, 0.7978431892513038, 0.8053566693184832, 0.8097763634756475, 0.8141960576328118, 0.8191461150888358, 0.8233006275965703, 0.827189958454875, 0.83001856271546, 0.8319632281446124, 0.833996287456908, 0.8362945284186334, 0.8375320427826395, 0.8392999204455052, 0.8397418898612216, 0.8413329797578007, 0.8422169185892336, 0.8440731901352426, 0.8452223106161053, 0.8464598249801114, 0.8477857332272607, 0.8489348537081234, 0.8500839741889861, 0.8510563069035623, 0.8519402457349952, 0.8525590029169982, 0.8532661539821444, 0.854061698930434, 0.8549456377618668, 0.8555643949438699, 0.8558295765932997, 0.8564483337753027, 0.8567135154247326, 0.8575974542561655, 0.858392999204455, 0.8590117563864581, 0.8592769380358879, 0.8598073013347476, 0.8603376646336074, 0.8609564218156104, 0.8613099973481835, 0.8617519667639, 0.862370723945903, 0.8626359055953328, 0.8633430566604791, 0.863608238309909, 0.8641386016087687, 0.8644037832581986, 0.8645805710244852, 0.864845752673915, 0.8652877220896315, 0.8654645098559179, 0.8661716609210642, 0.8664368425704941, 0.8668788119862105, 0.8672323875187837, 0.8672323875187837, 0.8674975691682135, 0.8678511447007867, 0.8683815079996464, 0.8687350835322196, 0.869177052947936, 0.869795810129939, 0.8701493856625122, 0.8705029611950853, 0.8709449306108017, 0.8712985061433749, 0.871652081675948, 0.8721824449748078, 0.8727128082736675, 0.8728895960399541, 0.8729779899230973, 0.8733315654556705, 0.8734199593388138, 0.8735967471051004, 0.8738619287545302, 0.8738619287545302, 0.8739503226376735, 0.8740387165208168, 0.8740387165208168, 0.8742155042871034, 0.8742155042871034, 0.8743922920533899, 0.8744806859365332, 0.8748342614691064, 0.8749226553522497, 0.8750110492353929, 0.8750994431185362, 0.8755414125342527, 0.8758065941836825, 0.8760717758331124, 0.8763369574825423, 0.8763369574825423, 0.876602139131972, 0.8767789268982586]
2023-06-26 06:25:58,476 - __main__ - INFO - writing new test top-k
2023-06-26 06:25:58,476 - __main__ - INFO - writing new test data
2023-06-26 06:26:00,960 - __main__ - INFO -  global_step = 16000
2023-06-26 12:22:13,645 - __main__ - INFO - Training/evaluation parameters Namespace(model_type='nghuyong/ernie-2.0-base-en', model_name_or_path='../TQ/triviaqa_fintinue.pkl', model_name_or_path_ict=None, output_dir='output/co_training_tq_simANS_test', num_epoch=0, config_name='', tokenizer_name='', corpus_path='', max_seq_length=256, max_query_length=32, triplet=False, log_dir='tensorboard_log/co_training_tq_simANS_test', optimizer='adamW', per_gpu_train_batch_size=8, gradient_accumulation_steps=1, learning_rate=2e-06, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=2.0, max_steps=20000, warmup_steps=1000, logging_steps=100, save_steps=2000, no_cuda=False, seed=42, fp16=False, fp16_opt_level='O1', gradient_checkpointing=True, contr_loss=False, normal_loss=True, origin_data_dir='output/co_training_tq_simANS_test/temp/train_ce.json', load_optimizer_scheduler=False, single_warmup=True, adv_data_path=None, ann_data_path=None, fix_embedding=False, continue_train=False, adv_loss_alpha=0.3, reranker_model_path='../TQ/checkpoint-reranker34000', reranker_model_type='nghuyong/ernie-2.0-large-en', number_neg=15, adv_lambda=0.0, adv_steps=3, local_rank=0, server_ip='', server_port='', test_qa_path='', train_qa_path='', dev_qa_path='', passage_path='', iteration_step=2000, iteration_reranker_step=500, temperature_normal=1.0, scale_simmila=False, reranker_learning_rate=5e-07, load_cache=False, ann_dir='output/co_training_tq_simANS_test/temp', normal_term='cross_e', global_step=16000, a=0.5, b=0, n_gpu=1, device=device(type='cuda', index=0), world_size=4, rank=0)
2023-06-26 12:22:23,772 - __main__ - INFO - Loading checkpoint @ step=16000
2023-06-26 12:22:23,772 - __main__ - INFO - Loading saved model state ...
2023-06-26 12:22:32,763 - __main__ - INFO - Loading checkpoint @ step=16000
2023-06-26 12:22:32,763 - __main__ - INFO - Loading saved model state ...
2023-06-26 12:22:46,072 - __main__ - INFO - ***** Running training *****
2023-06-26 12:22:46,072 - __main__ - INFO -   Max steps = 20000
2023-06-26 12:22:46,072 - __main__ - INFO -   Instantaneous batch size per GPU = 8
2023-06-26 12:22:46,072 - __main__ - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 32
2023-06-26 12:22:46,072 - __main__ - INFO -   Gradient Accumulation steps = 1
2023-06-26 12:22:46,072 - __main__ - INFO -   Dataset example num = 70052
2023-06-26 12:22:46,072 - __main__ - INFO -   step each epoch = 8756
2023-06-26 12:33:59,826 - __main__ - INFO - {"learning_rate": 4.4562962962962964e-07, "loss": 0.152081469514344, "normal_loss": 0.0, "contr_loss": 0.152081469514344, "step": 16100}
2023-06-26 12:45:04,572 - __main__ - INFO - {"learning_rate": 4.4562962962962964e-07, "loss": 0.14195448971207952, "normal_loss": 0.0, "contr_loss": 0.14195448971207952, "step": 16200}
2023-06-26 12:56:08,450 - __main__ - INFO - {"learning_rate": 4.4562962962962964e-07, "loss": 0.09909600700882948, "normal_loss": 0.0, "contr_loss": 0.09909600700882948, "step": 16300}
2023-06-26 13:07:22,602 - __main__ - INFO - {"learning_rate": 4.4562962962962964e-07, "loss": 0.12045541893960035, "normal_loss": 0.0, "contr_loss": 0.12045541893960035, "step": 16400}
2023-06-26 13:18:30,534 - __main__ - INFO - {"learning_rate": 4.4562962962962964e-07, "loss": 0.12059097354522237, "normal_loss": 0.0, "contr_loss": 0.12059097354522237, "step": 16500}
2023-06-26 13:24:28,516 - __main__ - INFO - {"learning_rate": 4.309629629629629e-07, "loss": 0.23237096901342738, "normal_loss": 0.23180028110102285, "contr_loss": 0.0005706879124045372, "step": 16600}
2023-06-26 13:30:25,157 - __main__ - INFO - {"learning_rate": 4.1614814814814816e-07, "loss": 0.25163085721607786, "normal_loss": 0.25163085721607786, "contr_loss": 0.0, "step": 16700}
2023-06-26 13:36:22,607 - __main__ - INFO - {"learning_rate": 4.0133333333333333e-07, "loss": 0.2450525121053215, "normal_loss": 0.2450525121053215, "contr_loss": 0.0, "step": 16800}
2023-06-26 13:42:19,617 - __main__ - INFO - {"learning_rate": 3.8651851851851854e-07, "loss": 0.21603756763070123, "normal_loss": 0.21603756763070123, "contr_loss": 0.0, "step": 16900}
2023-06-26 13:48:16,651 - __main__ - INFO - {"learning_rate": 3.717037037037037e-07, "loss": 0.20648624985362404, "normal_loss": 0.20648624985362404, "contr_loss": 0.0, "step": 17000}
2023-06-26 13:54:12,874 - __main__ - INFO - {"learning_rate": 3.5688888888888887e-07, "loss": 0.22965732482552995, "normal_loss": 0.22965732482552995, "contr_loss": 0.0, "step": 17100}
2023-06-26 14:00:08,626 - __main__ - INFO - {"learning_rate": 3.420740740740741e-07, "loss": 0.2234109253087081, "normal_loss": 0.2234109253087081, "contr_loss": 0.0, "step": 17200}
2023-06-26 14:06:04,548 - __main__ - INFO - {"learning_rate": 3.2725925925925925e-07, "loss": 0.215099822813645, "normal_loss": 0.215099822813645, "contr_loss": 0.0, "step": 17300}
2023-06-26 14:11:56,855 - __main__ - INFO - {"learning_rate": 3.1244444444444447e-07, "loss": 0.2317034265754046, "normal_loss": 0.2317034265754046, "contr_loss": 0.0, "step": 17400}
2023-06-26 14:17:55,940 - __main__ - INFO - {"learning_rate": 2.9762962962962964e-07, "loss": 0.23406992303702281, "normal_loss": 0.23406992303702281, "contr_loss": 0.0, "step": 17500}
2023-06-26 14:23:52,377 - __main__ - INFO - {"learning_rate": 2.828148148148148e-07, "loss": 0.22680313272285274, "normal_loss": 0.22680313272285274, "contr_loss": 0.0, "step": 17600}
2023-06-26 14:29:51,454 - __main__ - INFO - {"learning_rate": 2.68e-07, "loss": 0.2284885945066344, "normal_loss": 0.2284885945066344, "contr_loss": 0.0, "step": 17700}
2023-06-26 14:35:44,872 - __main__ - INFO - {"learning_rate": 2.531851851851852e-07, "loss": 0.21333389414052362, "normal_loss": 0.21333389414052362, "contr_loss": 0.0, "step": 17800}
2023-06-26 14:41:44,921 - __main__ - INFO - {"learning_rate": 2.3837037037037037e-07, "loss": 0.18795754888094962, "normal_loss": 0.18795754888094962, "contr_loss": 0.0, "step": 17900}
2023-06-26 14:47:45,933 - __main__ - INFO - {"learning_rate": 2.2355555555555556e-07, "loss": 0.2559802458639024, "normal_loss": 0.2559802458639024, "contr_loss": 0.0, "step": 18000}
2023-06-26 14:47:51,932 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint
2023-06-26 14:47:59,289 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint-reranker
2023-06-26 14:48:02,207 - __main__ - INFO -  global_step = 18000
2023-06-26 14:48:34,645 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-26 14:51:55,325 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-26 14:51:55,414 - __main__ - INFO - Embedding generation for 5253831 passages from idx 0 to 5253831
2023-06-26 14:52:10,472 - __main__ - INFO - Encoded passages 512
2023-06-26 14:55:40,490 - __main__ - INFO - Encoded passages 51712
2023-06-26 14:59:11,228 - __main__ - INFO - Encoded passages 102912
2023-06-26 15:02:41,929 - __main__ - INFO - Encoded passages 154112
2023-06-26 15:06:12,618 - __main__ - INFO - Encoded passages 205312
2023-06-26 15:09:43,334 - __main__ - INFO - Encoded passages 256512
2023-06-26 15:13:13,995 - __main__ - INFO - Encoded passages 307712
2023-06-26 15:16:44,655 - __main__ - INFO - Encoded passages 358912
2023-06-26 15:20:15,317 - __main__ - INFO - Encoded passages 410112
2023-06-26 15:23:46,044 - __main__ - INFO - Encoded passages 461312
2023-06-26 15:27:16,769 - __main__ - INFO - Encoded passages 512512
2023-06-26 15:30:47,481 - __main__ - INFO - Encoded passages 563712
2023-06-26 15:34:18,220 - __main__ - INFO - Encoded passages 614912
2023-06-26 15:37:48,951 - __main__ - INFO - Encoded passages 666112
2023-06-26 15:41:19,679 - __main__ - INFO - Encoded passages 717312
2023-06-26 15:44:50,398 - __main__ - INFO - Encoded passages 768512
2023-06-26 15:48:21,094 - __main__ - INFO - Encoded passages 819712
2023-06-26 15:51:51,821 - __main__ - INFO - Encoded passages 870912
2023-06-26 15:55:22,568 - __main__ - INFO - Encoded passages 922112
2023-06-26 15:58:53,280 - __main__ - INFO - Encoded passages 973312
2023-06-26 16:02:24,003 - __main__ - INFO - Encoded passages 1024512
2023-06-26 16:05:54,679 - __main__ - INFO - Encoded passages 1075712
2023-06-26 16:09:25,364 - __main__ - INFO - Encoded passages 1126912
2023-06-26 16:12:56,057 - __main__ - INFO - Encoded passages 1178112
2023-06-26 16:16:26,767 - __main__ - INFO - Encoded passages 1229312
2023-06-26 16:19:57,454 - __main__ - INFO - Encoded passages 1280512
2023-06-26 16:22:25,389 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_0.pb.
2023-06-26 16:22:35,898 - __main__ - INFO - Encoded passages 512
2023-06-26 16:26:06,715 - __main__ - INFO - Encoded passages 51712
2023-06-26 16:29:37,530 - __main__ - INFO - Encoded passages 102912
2023-06-26 16:33:08,296 - __main__ - INFO - Encoded passages 154112
2023-06-26 16:36:39,048 - __main__ - INFO - Encoded passages 205312
2023-06-26 16:40:09,744 - __main__ - INFO - Encoded passages 256512
2023-06-26 16:43:40,518 - __main__ - INFO - Encoded passages 307712
2023-06-26 16:47:11,286 - __main__ - INFO - Encoded passages 358912
2023-06-26 16:50:42,061 - __main__ - INFO - Encoded passages 410112
2023-06-26 16:54:12,871 - __main__ - INFO - Encoded passages 461312
2023-06-26 16:57:43,633 - __main__ - INFO - Encoded passages 512512
2023-06-26 17:01:14,408 - __main__ - INFO - Encoded passages 563712
2023-06-26 17:04:45,104 - __main__ - INFO - Encoded passages 614912
2023-06-26 17:08:15,817 - __main__ - INFO - Encoded passages 666112
2023-06-26 17:11:46,531 - __main__ - INFO - Encoded passages 717312
2023-06-26 17:15:17,291 - __main__ - INFO - Encoded passages 768512
2023-06-26 17:18:48,060 - __main__ - INFO - Encoded passages 819712
2023-06-26 17:22:18,835 - __main__ - INFO - Encoded passages 870912
2023-06-26 17:25:49,614 - __main__ - INFO - Encoded passages 922112
2023-06-26 17:29:20,361 - __main__ - INFO - Encoded passages 973312
2023-06-26 17:32:51,065 - __main__ - INFO - Encoded passages 1024512
2023-06-26 17:36:21,754 - __main__ - INFO - Encoded passages 1075712
2023-06-26 17:39:52,460 - __main__ - INFO - Encoded passages 1126912
2023-06-26 17:43:23,212 - __main__ - INFO - Encoded passages 1178112
2023-06-26 17:46:54,034 - __main__ - INFO - Encoded passages 1229312
2023-06-26 17:50:24,812 - __main__ - INFO - Encoded passages 1280512
2023-06-26 17:52:52,930 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_1.pb.
2023-06-26 17:53:02,811 - __main__ - INFO - Encoded passages 512
2023-06-26 17:56:33,471 - __main__ - INFO - Encoded passages 51712
2023-06-26 18:00:04,292 - __main__ - INFO - Encoded passages 102912
2023-06-26 18:03:35,098 - __main__ - INFO - Encoded passages 154112
2023-06-26 18:07:05,840 - __main__ - INFO - Encoded passages 205312
2023-06-26 18:10:36,554 - __main__ - INFO - Encoded passages 256512
2023-06-26 18:14:07,244 - __main__ - INFO - Encoded passages 307712
2023-06-26 18:17:37,988 - __main__ - INFO - Encoded passages 358912
2023-06-26 18:21:08,709 - __main__ - INFO - Encoded passages 410112
2023-06-26 18:24:39,407 - __main__ - INFO - Encoded passages 461312
2023-06-26 18:28:10,135 - __main__ - INFO - Encoded passages 512512
2023-06-26 18:31:40,819 - __main__ - INFO - Encoded passages 563712
2023-06-26 18:35:11,478 - __main__ - INFO - Encoded passages 614912
2023-06-26 18:38:42,204 - __main__ - INFO - Encoded passages 666112
2023-06-26 18:42:12,894 - __main__ - INFO - Encoded passages 717312
2023-06-26 18:45:43,647 - __main__ - INFO - Encoded passages 768512
2023-06-26 18:49:14,432 - __main__ - INFO - Encoded passages 819712
2023-06-26 18:52:45,162 - __main__ - INFO - Encoded passages 870912
2023-06-26 18:56:15,914 - __main__ - INFO - Encoded passages 922112
2023-06-26 18:59:46,618 - __main__ - INFO - Encoded passages 973312
2023-06-26 19:03:17,386 - __main__ - INFO - Encoded passages 1024512
2023-06-26 19:06:48,102 - __main__ - INFO - Encoded passages 1075712
2023-06-26 19:10:18,856 - __main__ - INFO - Encoded passages 1126912
2023-06-26 19:13:49,600 - __main__ - INFO - Encoded passages 1178112
2023-06-26 19:17:20,345 - __main__ - INFO - Encoded passages 1229312
2023-06-26 19:20:51,139 - __main__ - INFO - Encoded passages 1280512
2023-06-26 19:23:20,544 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_2.pb.
2023-06-26 19:23:30,909 - __main__ - INFO - Encoded passages 512
2023-06-26 19:27:01,762 - __main__ - INFO - Encoded passages 51712
2023-06-26 19:30:32,541 - __main__ - INFO - Encoded passages 102912
2023-06-26 19:34:03,366 - __main__ - INFO - Encoded passages 154112
2023-06-26 19:37:34,137 - __main__ - INFO - Encoded passages 205312
2023-06-26 19:41:04,874 - __main__ - INFO - Encoded passages 256512
2023-06-26 19:44:35,589 - __main__ - INFO - Encoded passages 307712
2023-06-26 19:48:06,281 - __main__ - INFO - Encoded passages 358912
2023-06-26 19:51:37,028 - __main__ - INFO - Encoded passages 410112
2023-06-26 19:55:07,814 - __main__ - INFO - Encoded passages 461312
2023-06-26 19:58:38,568 - __main__ - INFO - Encoded passages 512512
2023-06-26 20:02:09,348 - __main__ - INFO - Encoded passages 563712
2023-06-26 20:05:40,105 - __main__ - INFO - Encoded passages 614912
2023-06-26 20:09:10,852 - __main__ - INFO - Encoded passages 666112
2023-06-26 20:12:41,612 - __main__ - INFO - Encoded passages 717312
2023-06-26 20:16:12,332 - __main__ - INFO - Encoded passages 768512
2023-06-26 20:19:43,092 - __main__ - INFO - Encoded passages 819712
2023-06-26 20:23:13,834 - __main__ - INFO - Encoded passages 870912
2023-06-26 20:26:44,563 - __main__ - INFO - Encoded passages 922112
2023-06-26 20:30:15,354 - __main__ - INFO - Encoded passages 973312
2023-06-26 20:33:46,150 - __main__ - INFO - Encoded passages 1024512
2023-06-26 20:37:16,910 - __main__ - INFO - Encoded passages 1075712
2023-06-26 20:40:47,625 - __main__ - INFO - Encoded passages 1126912
2023-06-26 20:44:18,416 - __main__ - INFO - Encoded passages 1178112
2023-06-26 20:47:49,180 - __main__ - INFO - Encoded passages 1229312
2023-06-26 20:51:19,915 - __main__ - INFO - Encoded passages 1280512
2023-06-26 20:53:46,775 - __main__ - INFO - Total passages processed 1313460. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_3.pb.
2023-06-26 20:53:47,186 - __main__ - INFO -  global_step = 18000
2023-06-26 20:59:13,780 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-26 21:02:21,612 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-26 21:02:21,613 - __main__ - INFO - load_passage_begin
2023-06-26 21:02:59,581 - __main__ - INFO - load_passage_id_begin
2023-06-26 21:03:54,978 - __main__ - INFO - load_passage_done
2023-06-26 21:03:56,903 - __main__ - INFO - Loadingtrainanswers
2023-06-26 21:04:08,884 - __main__ - INFO - Encoded question 512
2023-06-26 21:05:24,042 - __main__ - INFO - Loadingdevanswers
2023-06-26 21:05:32,606 - __main__ - INFO - Encoded question 512
2023-06-26 21:05:42,491 - __main__ - INFO - Loadingtestanswers
2023-06-26 21:05:51,184 - __main__ - INFO - Encoded question 512
2023-06-26 21:06:04,374 - __main__ - INFO - ***** Begin passage_embedding reorder *****
2023-06-26 21:07:10,012 - __main__ - INFO - ***** end passage_embedding reorder  *****
2023-06-26 21:07:16,594 - __main__ - INFO - ***** begin add passages  *****
2023-06-26 21:34:36,373 - __main__ - INFO - ***** end build index  *****
2023-06-26 21:38:45,958 - __main__ - INFO - Per question validation results len=78785
2023-06-26 21:38:46,386 - __main__ - INFO - Validation results: top k documents hits [65244, 67227, 67977, 68316, 68552, 68708, 68841, 68908, 68973, 69033, 69092, 69144, 69179, 69212, 69245, 69282, 69312, 69350, 69376, 69398, 69411, 69431, 69455, 69477, 69488, 69498, 69513, 69530, 69537, 69552, 69570, 69581, 69592, 69597, 69602, 69614, 69629, 69639, 69645, 69657, 69672, 69682, 69695, 69701, 69710, 69718, 69724, 69727, 69738, 69748, 69754, 69761, 69769, 69777, 69783, 69791, 69795, 69799, 69804, 69815, 69819, 69827, 69829, 69831, 69832, 69839, 69842, 69846, 69850, 69854, 69858, 69862, 69871, 69873, 69876, 69883, 69887, 69893, 69898, 69902, 69904, 69911, 69915, 69920, 69927, 69929, 69935, 69936, 69937, 69940, 69943, 69947, 69949, 69955, 69959, 69962, 69964, 69972, 69980, 69980]
2023-06-26 21:38:46,386 - __main__ - INFO - Validation results: top k documents hits accuracy [0.8281271815700958, 0.8532969473884623, 0.8628165259884496, 0.8671193755156439, 0.8701148695817732, 0.8720949419305706, 0.8737830805356349, 0.8746334962239005, 0.8754585263692327, 0.8762200926572317, 0.8769689661737641, 0.8776289902900298, 0.8780732372913626, 0.878492098749762, 0.8789109602081615, 0.8793805927524275, 0.879761375896427, 0.8802437012121597, 0.8805737132702925, 0.8808529542425588, 0.8810179602716253, 0.8812718157009582, 0.8815764422161579, 0.8818556831884242, 0.8819953036745574, 0.8821222313892239, 0.8823126229612236, 0.8825284000761566, 0.8826172494764232, 0.8828076410484229, 0.8830361109348226, 0.8831757314209557, 0.8833153519070889, 0.8833788157644221, 0.8834422796217554, 0.8835945928793552, 0.883784984451355, 0.8839119121660215, 0.8839880687948214, 0.8841403820524212, 0.8843307736244209, 0.8844577013390874, 0.8846227073681538, 0.8846988639969537, 0.8848130989401536, 0.8849146411118868, 0.8849907977406867, 0.8850288760550866, 0.8851684965412198, 0.8852954242558863, 0.8853715808846861, 0.8854604302849527, 0.8855619724566859, 0.8856635146284191, 0.885739671257219, 0.8858412134289522, 0.8858919845148188, 0.8859427556006854, 0.8860062194580186, 0.8861458399441519, 0.8861966110300185, 0.8862981532017516, 0.886323538744685, 0.8863489242876182, 0.8863616170590849, 0.8864504664593514, 0.8864885447737514, 0.886539315859618, 0.8865900869454846, 0.8866408580313512, 0.8866916291172178, 0.8867424002030844, 0.8868566351462842, 0.8868820206892175, 0.8869200990036175, 0.887008948403884, 0.8870597194897506, 0.8871358761185505, 0.8871993399758837, 0.8872501110617503, 0.8872754966046836, 0.8873643460049502, 0.8874151170908168, 0.88747858094815, 0.8875674303484166, 0.8875928158913499, 0.8876689725201498, 0.8876816652916164, 0.887694358063083, 0.887732436377483, 0.887770514691883, 0.8878212857777495, 0.8878466713206828, 0.8879228279494827, 0.8879735990353493, 0.8880116773497493, 0.8880370628926826, 0.8881386050644158, 0.888240147236149, 0.888240147236149]
2023-06-26 21:39:01,374 - __main__ - INFO - writing new train top-k
2023-06-26 21:39:01,375 - __main__ - INFO - writing new train data
2023-06-26 21:41:34,597 - __main__ - INFO - Per question validation results len=8837
2023-06-26 21:41:34,659 - __main__ - INFO - Validation results: top k documents hits [5628, 6298, 6625, 6827, 6935, 7026, 7102, 7161, 7208, 7249, 7291, 7323, 7345, 7368, 7383, 7399, 7421, 7436, 7454, 7464, 7472, 7489, 7507, 7514, 7522, 7535, 7540, 7545, 7558, 7568, 7585, 7592, 7600, 7605, 7611, 7618, 7626, 7631, 7636, 7640, 7641, 7646, 7650, 7653, 7657, 7660, 7663, 7663, 7666, 7670, 7675, 7678, 7682, 7686, 7693, 7694, 7700, 7704, 7707, 7708, 7714, 7718, 7719, 7721, 7722, 7726, 7726, 7729, 7731, 7733, 7737, 7739, 7742, 7744, 7746, 7748, 7749, 7749, 7749, 7750, 7753, 7756, 7757, 7758, 7760, 7763, 7763, 7763, 7763, 7766, 7770, 7771, 7775, 7776, 7777, 7781, 7781, 7784, 7784, 7785]
2023-06-26 21:41:34,659 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6368677152879937, 0.7126853004413263, 0.7496888084191468, 0.7725472445400022, 0.7847685866244201, 0.7950661989362906, 0.8036664026253253, 0.8103428765418128, 0.8156614235600317, 0.8203010071291162, 0.8250537512730565, 0.8286748896684395, 0.8311644223152653, 0.8337671155369469, 0.8354645241597828, 0.8372750933574743, 0.8397646260043001, 0.8414620346271359, 0.8434989249745388, 0.844630530723096, 0.8455358153219419, 0.8474595450944891, 0.849496435441892, 0.8502885594658821, 0.8511938440647279, 0.8526649315378522, 0.8532307344121308, 0.8537965372864094, 0.8552676247595338, 0.856399230508091, 0.8583229602806383, 0.8591150843046282, 0.860020368903474, 0.8605861717777527, 0.861265135226887, 0.862057259250877, 0.8629625438497227, 0.8635283467240014, 0.86409414959828, 0.8645467918977029, 0.8646599524725586, 0.8652257553468372, 0.8656783976462601, 0.8660178793708272, 0.8664705216702501, 0.8668100033948173, 0.8671494851193844, 0.8671494851193844, 0.8674889668439516, 0.8679416091433745, 0.868507412017653, 0.8688468937422202, 0.8692995360416431, 0.869752178341066, 0.870544302365056, 0.8706574629399118, 0.8713364263890461, 0.871789068688469, 0.872128550413036, 0.8722417109878918, 0.8729206744370261, 0.873373316736449, 0.8734864773113047, 0.8737127984610161, 0.8738259590358719, 0.8742786013352948, 0.8742786013352948, 0.874618083059862, 0.8748444042095734, 0.8750707253592849, 0.8755233676587078, 0.8757496888084192, 0.8760891705329863, 0.8763154916826977, 0.8765418128324092, 0.8767681339821206, 0.8768812945569764, 0.8768812945569764, 0.8768812945569764, 0.876994455131832, 0.8773339368563993, 0.8776734185809664, 0.8777865791558221, 0.8778997397306778, 0.8781260608803892, 0.8784655426049565, 0.8784655426049565, 0.8784655426049565, 0.8784655426049565, 0.8788050243295236, 0.8792576666289464, 0.8793708272038022, 0.8798234695032251, 0.8799366300780808, 0.8800497906529365, 0.8805024329523594, 0.8805024329523594, 0.8808419146769265, 0.8808419146769265, 0.8809550752517823]
2023-06-26 21:41:43,306 - __main__ - INFO - writing new dev top-k
2023-06-26 21:41:43,306 - __main__ - INFO - writing new dev data
2023-06-26 21:42:53,583 - __main__ - INFO - Per question validation results len=11313
2023-06-26 21:42:53,655 - __main__ - INFO - Validation results: top k documents hits [7292, 8096, 8496, 8748, 8901, 9024, 9114, 9195, 9258, 9318, 9361, 9386, 9423, 9455, 9484, 9509, 9533, 9556, 9572, 9591, 9608, 9624, 9634, 9646, 9654, 9662, 9674, 9684, 9691, 9701, 9711, 9724, 9737, 9745, 9751, 9752, 9754, 9762, 9768, 9777, 9784, 9796, 9807, 9812, 9818, 9825, 9826, 9829, 9837, 9842, 9844, 9848, 9852, 9853, 9858, 9860, 9862, 9868, 9870, 9872, 9878, 9880, 9882, 9887, 9892, 9898, 9898, 9902, 9904, 9908, 9914, 9917, 9919, 9922, 9924, 9926, 9931, 9935, 9937, 9940, 9943, 9944, 9947, 9949, 9950, 9952, 9953, 9955, 9962, 9963, 9966, 9968, 9970, 9972, 9975, 9979, 9980, 9982, 9985, 9985]
2023-06-26 21:42:53,656 - __main__ - INFO - Validation results: top k documents hits accuracy [0.644568195880845, 0.7156368779280474, 0.750994431185362, 0.7732696897374701, 0.786793953858393, 0.7976664014850172, 0.8056218509679131, 0.8127817555025192, 0.8183505701405462, 0.8236542031291435, 0.8274551401043048, 0.829664987182887, 0.8329355608591885, 0.8357641651197737, 0.838327587730929, 0.8405374348095112, 0.84265888800495, 0.8446919473172456, 0.8461062494475382, 0.8477857332272607, 0.8492884292406966, 0.8507027313709892, 0.851586670202422, 0.8526473968001415, 0.8533545478652877, 0.854061698930434, 0.8551224255281534, 0.8560063643595863, 0.8566251215415893, 0.8575090603730222, 0.858392999204455, 0.8595421196853178, 0.8606912401661805, 0.8613983912313268, 0.8619287545301865, 0.8620171484133298, 0.8621939361796164, 0.8629010872447627, 0.8634314505436224, 0.864226995491912, 0.864845752673915, 0.8659064792716344, 0.8668788119862105, 0.867320781401927, 0.8678511447007867, 0.8684699018827897, 0.868558295765933, 0.8688234774153628, 0.8695306284805091, 0.8699725978962256, 0.8701493856625122, 0.8705029611950853, 0.8708565367276584, 0.8709449306108017, 0.8713869000265182, 0.8715636877928047, 0.8717404755590913, 0.872270838857951, 0.8724476266242376, 0.8726244143905242, 0.8731547776893839, 0.8733315654556705, 0.8735083532219571, 0.8739503226376735, 0.8743922920533899, 0.8749226553522497, 0.8749226553522497, 0.8752762308848228, 0.8754530186511094, 0.8758065941836825, 0.8763369574825423, 0.876602139131972, 0.8767789268982586, 0.8770441085476886, 0.877220896313975, 0.8773976840802616, 0.877839653495978, 0.8781932290285512, 0.8783700167948378, 0.8786351984442676, 0.8789003800936975, 0.8789887739768408, 0.8792539556262706, 0.8794307433925572, 0.8795191372757005, 0.8796959250419871, 0.8797843189251304, 0.8799611066914169, 0.8805798638734199, 0.8806682577565632, 0.8809334394059931, 0.8811102271722797, 0.8812870149385662, 0.8814638027048528, 0.8817289843542827, 0.8820825598868558, 0.8821709537699991, 0.8823477415362857, 0.8826129231857156, 0.8826129231857156]
2023-06-26 21:43:02,837 - __main__ - INFO - writing new test top-k
2023-06-26 21:43:02,837 - __main__ - INFO - writing new test data
2023-06-26 21:43:04,935 - __main__ - INFO -  global_step = 18000
2023-06-27 04:02:12,936 - __main__ - INFO - Training/evaluation parameters Namespace(model_type='nghuyong/ernie-2.0-base-en', model_name_or_path='../TQ/triviaqa_fintinue.pkl', model_name_or_path_ict=None, output_dir='output/co_training_tq_simANS_test', num_epoch=0, config_name='', tokenizer_name='', corpus_path='', max_seq_length=256, max_query_length=32, triplet=False, log_dir='tensorboard_log/co_training_tq_simANS_test', optimizer='adamW', per_gpu_train_batch_size=8, gradient_accumulation_steps=1, learning_rate=2e-06, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=2.0, max_steps=20000, warmup_steps=1000, logging_steps=100, save_steps=2000, no_cuda=False, seed=42, fp16=False, fp16_opt_level='O1', gradient_checkpointing=True, contr_loss=False, normal_loss=True, origin_data_dir='output/co_training_tq_simANS_test/temp/train_ce.json', load_optimizer_scheduler=False, single_warmup=True, adv_data_path=None, ann_data_path=None, fix_embedding=False, continue_train=False, adv_loss_alpha=0.3, reranker_model_path='../TQ/checkpoint-reranker34000', reranker_model_type='nghuyong/ernie-2.0-large-en', number_neg=15, adv_lambda=0.0, adv_steps=3, local_rank=0, server_ip='', server_port='', test_qa_path='', train_qa_path='', dev_qa_path='', passage_path='', iteration_step=2000, iteration_reranker_step=500, temperature_normal=1.0, scale_simmila=False, reranker_learning_rate=5e-07, load_cache=False, ann_dir='output/co_training_tq_simANS_test/temp', normal_term='cross_e', global_step=18000, a=0.5, b=0, n_gpu=1, device=device(type='cuda', index=0), world_size=4, rank=0)
2023-06-27 04:02:14,420 - __main__ - INFO - Loading checkpoint @ step=18000
2023-06-27 04:02:14,420 - __main__ - INFO - Loading saved model state ...
2023-06-27 04:02:24,362 - __main__ - INFO - Loading checkpoint @ step=18000
2023-06-27 04:02:24,362 - __main__ - INFO - Loading saved model state ...
2023-06-27 04:02:37,656 - __main__ - INFO - ***** Running training *****
2023-06-27 04:02:37,656 - __main__ - INFO -   Max steps = 20000
2023-06-27 04:02:37,656 - __main__ - INFO -   Instantaneous batch size per GPU = 8
2023-06-27 04:02:37,656 - __main__ - INFO -   Total train batch size (w. parallel, distributed & accumulation) = 32
2023-06-27 04:02:37,656 - __main__ - INFO -   Gradient Accumulation steps = 1
2023-06-27 04:02:37,656 - __main__ - INFO -   Dataset example num = 70106
2023-06-27 04:02:37,656 - __main__ - INFO -   step each epoch = 8763
2023-06-27 04:15:40,854 - __main__ - INFO - {"learning_rate": 2.2355555555555556e-07, "loss": 0.148143447819225, "normal_loss": 0.0, "contr_loss": 0.148143447819225, "step": 18100}
2023-06-27 04:28:43,463 - __main__ - INFO - {"learning_rate": 2.2355555555555556e-07, "loss": 0.14757716725707723, "normal_loss": 0.0, "contr_loss": 0.14757716725707723, "step": 18200}
2023-06-27 04:41:42,117 - __main__ - INFO - {"learning_rate": 2.2355555555555556e-07, "loss": 0.17593266872200275, "normal_loss": 0.0, "contr_loss": 0.17593266872200275, "step": 18300}
2023-06-27 04:54:30,960 - __main__ - INFO - {"learning_rate": 2.2355555555555556e-07, "loss": 0.10274675898394889, "normal_loss": 0.0, "contr_loss": 0.10274675898394889, "step": 18400}
2023-06-27 05:07:26,780 - __main__ - INFO - {"learning_rate": 2.2355555555555556e-07, "loss": 0.16135746574607765, "normal_loss": 0.0, "contr_loss": 0.16135746574607765, "step": 18500}
2023-06-27 05:14:25,044 - __main__ - INFO - {"learning_rate": 2.088888888888889e-07, "loss": 0.28188289449317383, "normal_loss": 0.2814396366546862, "contr_loss": 0.0004432578384876251, "step": 18600}
2023-06-27 05:21:16,441 - __main__ - INFO - {"learning_rate": 1.9407407407407406e-07, "loss": 0.2672154200775549, "normal_loss": 0.2672154200775549, "contr_loss": 0.0, "step": 18700}
2023-06-27 05:28:12,974 - __main__ - INFO - {"learning_rate": 1.7925925925925925e-07, "loss": 0.256601812041481, "normal_loss": 0.256601812041481, "contr_loss": 0.0, "step": 18800}
2023-06-27 05:35:09,168 - __main__ - INFO - {"learning_rate": 1.6444444444444444e-07, "loss": 0.23135659324761945, "normal_loss": 0.23135659324761945, "contr_loss": 0.0, "step": 18900}
2023-06-27 05:42:02,152 - __main__ - INFO - {"learning_rate": 1.4962962962962963e-07, "loss": 0.25120804142963604, "normal_loss": 0.25120804142963604, "contr_loss": 0.0, "step": 19000}
2023-06-27 05:48:59,746 - __main__ - INFO - {"learning_rate": 1.348148148148148e-07, "loss": 0.2784636551316362, "normal_loss": 0.2784636551316362, "contr_loss": 0.0, "step": 19100}
2023-06-27 05:55:56,527 - __main__ - INFO - {"learning_rate": 1.2e-07, "loss": 0.24502948216395454, "normal_loss": 0.24502948216395454, "contr_loss": 0.0, "step": 19200}
2023-06-27 06:02:53,620 - __main__ - INFO - {"learning_rate": 1.0518518518518518e-07, "loss": 0.20599512111693913, "normal_loss": 0.20599512111693913, "contr_loss": 0.0, "step": 19300}
2023-06-27 06:09:51,205 - __main__ - INFO - {"learning_rate": 9.037037037037036e-08, "loss": 0.23285195580450818, "normal_loss": 0.23285195580450818, "contr_loss": 0.0, "step": 19400}
2023-06-27 06:16:46,995 - __main__ - INFO - {"learning_rate": 7.555555555555555e-08, "loss": 0.2473807866469724, "normal_loss": 0.2473807866469724, "contr_loss": 0.0, "step": 19500}
2023-06-27 06:23:43,719 - __main__ - INFO - {"learning_rate": 6.074074074074074e-08, "loss": 0.21735779163078406, "normal_loss": 0.21735779163078406, "contr_loss": 0.0, "step": 19600}
2023-06-27 06:30:39,443 - __main__ - INFO - {"learning_rate": 4.592592592592592e-08, "loss": 0.2315347634855425, "normal_loss": 0.2315347634855425, "contr_loss": 0.0, "step": 19700}
2023-06-27 06:37:31,285 - __main__ - INFO - {"learning_rate": 3.111111111111111e-08, "loss": 0.2679278145925491, "normal_loss": 0.2679278145925491, "contr_loss": 0.0, "step": 19800}
2023-06-27 06:44:29,114 - __main__ - INFO - {"learning_rate": 1.6296296296296295e-08, "loss": 0.21720528176167136, "normal_loss": 0.21720528176167136, "contr_loss": 0.0, "step": 19900}
2023-06-27 06:51:22,917 - __main__ - INFO - {"learning_rate": 1.4814814814814814e-09, "loss": 0.24849683900538366, "normal_loss": 0.24849683900538366, "contr_loss": 0.0, "step": 20000}
2023-06-27 06:51:29,069 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint
2023-06-27 06:51:37,888 - __main__ - INFO - Saved checkpoint at output/co_training_tq_simANS_test/checkpoint-reranker
2023-06-27 06:51:41,055 - __main__ - INFO -  global_step = 20000
2023-06-27 06:52:11,114 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-27 06:55:14,646 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-27 06:55:14,722 - __main__ - INFO - Embedding generation for 5253831 passages from idx 0 to 5253831
2023-06-27 06:55:29,785 - __main__ - INFO - Encoded passages 512
2023-06-27 06:58:59,769 - __main__ - INFO - Encoded passages 51712
2023-06-27 07:02:30,163 - __main__ - INFO - Encoded passages 102912
2023-06-27 07:06:00,651 - __main__ - INFO - Encoded passages 154112
2023-06-27 07:09:31,071 - __main__ - INFO - Encoded passages 205312
2023-06-27 07:13:01,461 - __main__ - INFO - Encoded passages 256512
2023-06-27 07:16:31,873 - __main__ - INFO - Encoded passages 307712
2023-06-27 07:20:02,274 - __main__ - INFO - Encoded passages 358912
2023-06-27 07:23:32,723 - __main__ - INFO - Encoded passages 410112
2023-06-27 07:27:03,134 - __main__ - INFO - Encoded passages 461312
2023-06-27 07:30:33,550 - __main__ - INFO - Encoded passages 512512
2023-06-27 07:34:03,959 - __main__ - INFO - Encoded passages 563712
2023-06-27 07:37:34,356 - __main__ - INFO - Encoded passages 614912
2023-06-27 07:41:04,740 - __main__ - INFO - Encoded passages 666112
2023-06-27 07:44:35,142 - __main__ - INFO - Encoded passages 717312
2023-06-27 07:48:05,541 - __main__ - INFO - Encoded passages 768512
2023-06-27 07:51:35,929 - __main__ - INFO - Encoded passages 819712
2023-06-27 07:55:06,332 - __main__ - INFO - Encoded passages 870912
2023-06-27 07:58:36,739 - __main__ - INFO - Encoded passages 922112
2023-06-27 08:02:07,157 - __main__ - INFO - Encoded passages 973312
2023-06-27 08:05:37,585 - __main__ - INFO - Encoded passages 1024512
2023-06-27 08:09:07,983 - __main__ - INFO - Encoded passages 1075712
2023-06-27 08:12:38,379 - __main__ - INFO - Encoded passages 1126912
2023-06-27 08:16:08,791 - __main__ - INFO - Encoded passages 1178112
2023-06-27 08:19:39,188 - __main__ - INFO - Encoded passages 1229312
2023-06-27 08:23:09,613 - __main__ - INFO - Encoded passages 1280512
2023-06-27 08:25:36,756 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_0.pb.
2023-06-27 08:25:46,650 - __main__ - INFO - Encoded passages 512
2023-06-27 08:29:17,331 - __main__ - INFO - Encoded passages 51712
2023-06-27 08:32:48,184 - __main__ - INFO - Encoded passages 102912
2023-06-27 08:36:18,909 - __main__ - INFO - Encoded passages 154112
2023-06-27 08:39:49,657 - __main__ - INFO - Encoded passages 205312
2023-06-27 08:43:20,377 - __main__ - INFO - Encoded passages 256512
2023-06-27 08:46:51,095 - __main__ - INFO - Encoded passages 307712
2023-06-27 08:50:21,833 - __main__ - INFO - Encoded passages 358912
2023-06-27 08:53:52,549 - __main__ - INFO - Encoded passages 410112
2023-06-27 08:57:23,303 - __main__ - INFO - Encoded passages 461312
2023-06-27 09:00:54,015 - __main__ - INFO - Encoded passages 512512
2023-06-27 09:04:24,752 - __main__ - INFO - Encoded passages 563712
2023-06-27 09:07:55,462 - __main__ - INFO - Encoded passages 614912
2023-06-27 09:11:26,168 - __main__ - INFO - Encoded passages 666112
2023-06-27 09:14:56,880 - __main__ - INFO - Encoded passages 717312
2023-06-27 09:18:27,599 - __main__ - INFO - Encoded passages 768512
2023-06-27 09:21:58,295 - __main__ - INFO - Encoded passages 819712
2023-06-27 09:25:29,006 - __main__ - INFO - Encoded passages 870912
2023-06-27 09:28:59,735 - __main__ - INFO - Encoded passages 922112
2023-06-27 09:32:30,525 - __main__ - INFO - Encoded passages 973312
2023-06-27 09:36:01,292 - __main__ - INFO - Encoded passages 1024512
2023-06-27 09:39:32,042 - __main__ - INFO - Encoded passages 1075712
2023-06-27 09:43:02,780 - __main__ - INFO - Encoded passages 1126912
2023-06-27 09:46:33,458 - __main__ - INFO - Encoded passages 1178112
2023-06-27 09:50:04,194 - __main__ - INFO - Encoded passages 1229312
2023-06-27 09:53:34,862 - __main__ - INFO - Encoded passages 1280512
2023-06-27 09:56:02,701 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_1.pb.
2023-06-27 09:56:12,651 - __main__ - INFO - Encoded passages 512
2023-06-27 09:59:43,425 - __main__ - INFO - Encoded passages 51712
2023-06-27 10:03:14,205 - __main__ - INFO - Encoded passages 102912
2023-06-27 10:06:44,977 - __main__ - INFO - Encoded passages 154112
2023-06-27 10:10:15,706 - __main__ - INFO - Encoded passages 205312
2023-06-27 10:13:46,388 - __main__ - INFO - Encoded passages 256512
2023-06-27 10:17:17,090 - __main__ - INFO - Encoded passages 307712
2023-06-27 10:20:47,818 - __main__ - INFO - Encoded passages 358912
2023-06-27 10:24:18,554 - __main__ - INFO - Encoded passages 410112
2023-06-27 10:27:49,314 - __main__ - INFO - Encoded passages 461312
2023-06-27 10:31:20,067 - __main__ - INFO - Encoded passages 512512
2023-06-27 10:34:50,784 - __main__ - INFO - Encoded passages 563712
2023-06-27 10:38:21,533 - __main__ - INFO - Encoded passages 614912
2023-06-27 10:41:52,255 - __main__ - INFO - Encoded passages 666112
2023-06-27 10:45:22,926 - __main__ - INFO - Encoded passages 717312
2023-06-27 10:48:53,645 - __main__ - INFO - Encoded passages 768512
2023-06-27 10:52:24,336 - __main__ - INFO - Encoded passages 819712
2023-06-27 10:55:55,089 - __main__ - INFO - Encoded passages 870912
2023-06-27 10:59:25,870 - __main__ - INFO - Encoded passages 922112
2023-06-27 11:02:56,649 - __main__ - INFO - Encoded passages 973312
2023-06-27 11:06:27,433 - __main__ - INFO - Encoded passages 1024512
2023-06-27 11:09:58,223 - __main__ - INFO - Encoded passages 1075712
2023-06-27 11:13:29,001 - __main__ - INFO - Encoded passages 1126912
2023-06-27 11:16:59,732 - __main__ - INFO - Encoded passages 1178112
2023-06-27 11:20:30,451 - __main__ - INFO - Encoded passages 1229312
2023-06-27 11:24:01,211 - __main__ - INFO - Encoded passages 1280512
2023-06-27 11:26:29,654 - __main__ - INFO - Total passages processed 1313457. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_2.pb.
2023-06-27 11:26:39,904 - __main__ - INFO - Encoded passages 512
2023-06-27 11:30:10,714 - __main__ - INFO - Encoded passages 51712
2023-06-27 11:33:41,443 - __main__ - INFO - Encoded passages 102912
2023-06-27 11:37:12,239 - __main__ - INFO - Encoded passages 154112
2023-06-27 11:40:42,995 - __main__ - INFO - Encoded passages 205312
2023-06-27 11:44:13,727 - __main__ - INFO - Encoded passages 256512
2023-06-27 11:47:44,468 - __main__ - INFO - Encoded passages 307712
2023-06-27 11:51:15,208 - __main__ - INFO - Encoded passages 358912
2023-06-27 11:54:45,935 - __main__ - INFO - Encoded passages 410112
2023-06-27 11:58:16,653 - __main__ - INFO - Encoded passages 461312
2023-06-27 12:01:47,385 - __main__ - INFO - Encoded passages 512512
2023-06-27 12:05:18,102 - __main__ - INFO - Encoded passages 563712
2023-06-27 12:08:48,797 - __main__ - INFO - Encoded passages 614912
2023-06-27 12:12:19,520 - __main__ - INFO - Encoded passages 666112
2023-06-27 12:15:50,240 - __main__ - INFO - Encoded passages 717312
2023-06-27 12:19:20,994 - __main__ - INFO - Encoded passages 768512
2023-06-27 12:22:51,743 - __main__ - INFO - Encoded passages 819712
2023-06-27 12:26:22,546 - __main__ - INFO - Encoded passages 870912
2023-06-27 12:29:53,290 - __main__ - INFO - Encoded passages 922112
2023-06-27 12:33:24,043 - __main__ - INFO - Encoded passages 973312
2023-06-27 12:36:54,779 - __main__ - INFO - Encoded passages 1024512
2023-06-27 12:40:25,495 - __main__ - INFO - Encoded passages 1075712
2023-06-27 12:43:56,253 - __main__ - INFO - Encoded passages 1126912
2023-06-27 12:47:26,965 - __main__ - INFO - Encoded passages 1178112
2023-06-27 12:50:57,659 - __main__ - INFO - Encoded passages 1229312
2023-06-27 12:54:28,372 - __main__ - INFO - Encoded passages 1280512
2023-06-27 12:56:55,395 - __main__ - INFO - Total passages processed 1313460. Written to output/co_training_tq_simANS_test/temp/temp/psg_embed_id_data_obj_0_3.pb.
2023-06-27 12:56:55,824 - __main__ - INFO -  global_step = 20000
2023-06-27 13:02:24,804 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-27 13:05:21,921 - __main__ - INFO -  model_path = output/co_training_tq_simANS_test/checkpoint
2023-06-27 13:05:21,923 - __main__ - INFO - load_passage_begin
2023-06-27 13:05:59,343 - __main__ - INFO - load_passage_id_begin
2023-06-27 13:06:50,239 - __main__ - INFO - load_passage_done
2023-06-27 13:06:52,115 - __main__ - INFO - Loadingtrainanswers
2023-06-27 13:07:03,972 - __main__ - INFO - Encoded question 512
2023-06-27 13:08:19,168 - __main__ - INFO - Loadingdevanswers
2023-06-27 13:08:27,349 - __main__ - INFO - Encoded question 512
2023-06-27 13:08:37,270 - __main__ - INFO - Loadingtestanswers
2023-06-27 13:08:46,724 - __main__ - INFO - Encoded question 512
2023-06-27 13:09:00,025 - __main__ - INFO - ***** Begin passage_embedding reorder *****
2023-06-27 13:10:02,598 - __main__ - INFO - ***** end passage_embedding reorder  *****
2023-06-27 13:10:09,380 - __main__ - INFO - ***** begin add passages  *****
2023-06-27 13:40:33,651 - __main__ - INFO - ***** end build index  *****
2023-06-27 13:44:41,055 - __main__ - INFO - Per question validation results len=78785
2023-06-27 13:44:41,475 - __main__ - INFO - Validation results: top k documents hits [65265, 67187, 67906, 68277, 68510, 68672, 68793, 68878, 68942, 69003, 69068, 69116, 69151, 69195, 69242, 69271, 69297, 69318, 69338, 69361, 69386, 69407, 69422, 69437, 69450, 69470, 69481, 69499, 69514, 69523, 69538, 69561, 69569, 69582, 69594, 69604, 69611, 69622, 69632, 69640, 69643, 69651, 69657, 69664, 69666, 69671, 69682, 69690, 69694, 69700, 69705, 69709, 69714, 69721, 69725, 69730, 69737, 69744, 69748, 69753, 69759, 69766, 69768, 69773, 69781, 69788, 69791, 69794, 69802, 69806, 69811, 69816, 69818, 69820, 69822, 69826, 69829, 69834, 69838, 69844, 69848, 69853, 69858, 69862, 69864, 69867, 69871, 69875, 69877, 69881, 69884, 69889, 69891, 69896, 69897, 69897, 69902, 69906, 69908, 69913]
2023-06-27 13:44:41,475 - __main__ - INFO - Validation results: top k documents hits accuracy [0.8283937297708954, 0.8527892365297963, 0.8619153392143174, 0.8666243574284445, 0.8695817731801739, 0.8716380021577711, 0.8731738275052358, 0.874252713079901, 0.8750650504537666, 0.8758393095132322, 0.8766643396585645, 0.8772735926889637, 0.8777178396902964, 0.8782763216348289, 0.8788728818937614, 0.8792409722662944, 0.8795709843244273, 0.8798375325252269, 0.8800913879545599, 0.8803833216982928, 0.880700640984959, 0.8809671891857587, 0.8811575807577584, 0.8813479723297583, 0.8815129783588247, 0.8817668337881577, 0.8819064542742908, 0.8821349241606905, 0.8823253157326902, 0.8824395506758901, 0.8826299422478898, 0.8829218759916228, 0.8830234181633559, 0.8831884241924224, 0.8833407374500222, 0.8834676651646887, 0.8835565145649552, 0.8836961350510885, 0.883823062765755, 0.8839246049374881, 0.8839626832518881, 0.8840642254236213, 0.8841403820524212, 0.8842292314526877, 0.884254616995621, 0.8843180808529543, 0.8844577013390874, 0.8845592435108206, 0.8846100145966872, 0.8846861712254871, 0.8847496350828203, 0.8848004061686869, 0.8848638700260202, 0.8849527194262867, 0.8850034905121533, 0.8850669543694866, 0.8851558037697531, 0.8852446531700197, 0.8852954242558863, 0.8853588881132195, 0.8854350447420194, 0.8855238941422859, 0.8855492796852192, 0.8856127435425525, 0.8857142857142857, 0.8858031351145522, 0.8858412134289522, 0.8858792917433521, 0.8859808339150853, 0.8860316050009519, 0.8860950688582853, 0.8861585327156185, 0.8861839182585518, 0.8862093038014851, 0.8862346893444184, 0.886285460430285, 0.886323538744685, 0.8863870026020182, 0.8864377736878848, 0.8865139303166847, 0.8865647014025513, 0.8866281652598845, 0.8866916291172178, 0.8867424002030844, 0.8867677857460177, 0.8868058640604176, 0.8868566351462842, 0.8869074062321508, 0.8869327917750841, 0.8869835628609507, 0.8870216411753507, 0.8870851050326839, 0.8871104905756172, 0.8871739544329504, 0.8871866472044171, 0.8871866472044171, 0.8872501110617503, 0.8873008821476169, 0.8873262676905502, 0.8873897315478835]
2023-06-27 13:44:56,230 - __main__ - INFO - writing new train top-k
2023-06-27 13:44:56,231 - __main__ - INFO - writing new train data
2023-06-27 13:47:30,503 - __main__ - INFO - Per question validation results len=8837
2023-06-27 13:47:30,566 - __main__ - INFO - Validation results: top k documents hits [5680, 6285, 6633, 6820, 6944, 7026, 7106, 7161, 7199, 7243, 7276, 7303, 7338, 7368, 7387, 7407, 7421, 7439, 7449, 7463, 7476, 7495, 7500, 7513, 7525, 7534, 7541, 7547, 7555, 7558, 7567, 7573, 7580, 7586, 7592, 7597, 7604, 7605, 7608, 7613, 7613, 7618, 7623, 7627, 7634, 7638, 7643, 7644, 7647, 7652, 7655, 7656, 7657, 7659, 7661, 7664, 7667, 7673, 7675, 7680, 7686, 7690, 7694, 7697, 7700, 7704, 7707, 7714, 7716, 7717, 7718, 7720, 7720, 7721, 7723, 7724, 7725, 7726, 7728, 7728, 7728, 7730, 7730, 7731, 7732, 7735, 7737, 7739, 7741, 7743, 7744, 7746, 7747, 7747, 7751, 7753, 7754, 7755, 7755, 7757]
2023-06-27 13:47:30,566 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6427520651804911, 0.7112142129682019, 0.7505940930179925, 0.7717551205160122, 0.7857870317981215, 0.7950661989362906, 0.8041190449247482, 0.8103428765418128, 0.8146429783863302, 0.8196220436799819, 0.8233563426502206, 0.8264116781713251, 0.8303722982912753, 0.8337671155369469, 0.8359171664592057, 0.83818037795632, 0.8397646260043001, 0.8418015163517031, 0.8429331221002603, 0.8445173701482404, 0.8459884576213648, 0.8481385085436234, 0.848704311417902, 0.8501753988910263, 0.851533325789295, 0.8525517709629965, 0.8533438949869865, 0.8540228584361208, 0.8549281430349667, 0.8552676247595338, 0.8562860699332353, 0.8569650333823696, 0.8577571574063596, 0.8584361208554939, 0.8591150843046282, 0.8596808871789069, 0.8604730112028969, 0.8605861717777527, 0.8609256535023198, 0.8614914563765984, 0.8614914563765984, 0.862057259250877, 0.8626230621251556, 0.8630757044245785, 0.8638678284485685, 0.8643204707479915, 0.86488627362227, 0.8649994341971258, 0.8653389159216929, 0.8659047187959715, 0.8662442005205386, 0.8663573610953944, 0.8664705216702501, 0.8666968428199615, 0.866923163969673, 0.8672626456942402, 0.8676021274188073, 0.8682810908679416, 0.868507412017653, 0.8690732148919317, 0.869752178341066, 0.8702048206404889, 0.8706574629399118, 0.8709969446644789, 0.8713364263890461, 0.871789068688469, 0.872128550413036, 0.8729206744370261, 0.8731469955867376, 0.8732601561615932, 0.873373316736449, 0.8735996378861605, 0.8735996378861605, 0.8737127984610161, 0.8739391196107277, 0.8740522801855833, 0.8741654407604391, 0.8742786013352948, 0.8745049224850062, 0.8745049224850062, 0.8745049224850062, 0.8747312436347177, 0.8747312436347177, 0.8748444042095734, 0.8749575647844291, 0.8752970465089963, 0.8755233676587078, 0.8757496888084192, 0.8759760099581306, 0.8762023311078421, 0.8763154916826977, 0.8765418128324092, 0.876654973407265, 0.876654973407265, 0.8771076157066878, 0.8773339368563993, 0.8774470974312549, 0.8775602580061107, 0.8775602580061107, 0.8777865791558221]
2023-06-27 13:47:39,281 - __main__ - INFO - writing new dev top-k
2023-06-27 13:47:39,281 - __main__ - INFO - writing new dev data
2023-06-27 13:48:49,310 - __main__ - INFO - Per question validation results len=11313
2023-06-27 13:48:49,399 - __main__ - INFO - Validation results: top k documents hits [7320, 8101, 8499, 8734, 8879, 8995, 9079, 9154, 9221, 9284, 9332, 9377, 9408, 9441, 9471, 9494, 9515, 9539, 9552, 9571, 9587, 9601, 9623, 9635, 9644, 9650, 9665, 9676, 9688, 9692, 9694, 9702, 9710, 9715, 9724, 9732, 9743, 9746, 9751, 9759, 9767, 9777, 9785, 9792, 9797, 9803, 9806, 9813, 9815, 9822, 9825, 9832, 9834, 9836, 9841, 9842, 9846, 9851, 9853, 9857, 9863, 9869, 9869, 9870, 9877, 9883, 9888, 9890, 9893, 9898, 9900, 9904, 9909, 9917, 9919, 9919, 9921, 9925, 9927, 9930, 9931, 9933, 9934, 9935, 9935, 9938, 9943, 9944, 9946, 9946, 9946, 9947, 9950, 9953, 9957, 9959, 9960, 9963, 9964, 9965]
2023-06-27 13:48:49,399 - __main__ - INFO - Validation results: top k documents hits accuracy [0.6470432246088571, 0.7160788473437638, 0.7512596128347918, 0.7720321753734641, 0.7848492884292407, 0.7951029788738619, 0.802528065057898, 0.8091576062936445, 0.8150799964642447, 0.8206488111022717, 0.8248917174931495, 0.8288694422345974, 0.8316096526120392, 0.8345266507557677, 0.8371784672500663, 0.8392115265623619, 0.8410677981083708, 0.8431892513038097, 0.8443383717846725, 0.8460178555643949, 0.8474321576946875, 0.8486696720586936, 0.8506143374878459, 0.8516750640855653, 0.8524706090338549, 0.8530009723327145, 0.8543268805798638, 0.85529921329444, 0.8563599398921594, 0.8567135154247326, 0.8568903031910192, 0.8575974542561655, 0.8583046053213118, 0.8587465747370282, 0.8595421196853178, 0.8602492707504641, 0.8612216034650402, 0.8614867851144701, 0.8619287545301865, 0.8626359055953328, 0.8633430566604791, 0.864226995491912, 0.8649341465570582, 0.8655529037390612, 0.8659948731547777, 0.8665252364536374, 0.8667904181030672, 0.8674091752850702, 0.8675859630513568, 0.8682047202333598, 0.8684699018827897, 0.8690886590647927, 0.8692654468310793, 0.8694422345973659, 0.8698842040130823, 0.8699725978962256, 0.8703261734287987, 0.8707681428445152, 0.8709449306108017, 0.8712985061433749, 0.8718288694422346, 0.8723592327410943, 0.8723592327410943, 0.8724476266242376, 0.8730663838062406, 0.8735967471051004, 0.8740387165208168, 0.8742155042871034, 0.8744806859365332, 0.8749226553522497, 0.8750994431185362, 0.8754530186511094, 0.8758949880668258, 0.876602139131972, 0.8767789268982586, 0.8767789268982586, 0.8769557146645452, 0.8773092901971183, 0.8774860779634049, 0.8777512596128348, 0.877839653495978, 0.8780164412622646, 0.8781048351454079, 0.8781932290285512, 0.8781932290285512, 0.8784584106779811, 0.8789003800936975, 0.8789887739768408, 0.8791655617431273, 0.8791655617431273, 0.8791655617431273, 0.8792539556262706, 0.8795191372757005, 0.8797843189251304, 0.8801378944577035, 0.8803146822239901, 0.8804030761071334, 0.8806682577565632, 0.8807566516397065, 0.8808450455228498]
2023-06-27 13:48:58,564 - __main__ - INFO - writing new test top-k
2023-06-27 13:48:58,564 - __main__ - INFO - writing new test data
2023-06-27 13:48:59,373 - __main__ - INFO -  global_step = 20000
2023-06-27 19:56:25,722 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-27 20:00:19,950 - __main__ - INFO -  global_step = 22000
2023-06-27 20:00:43,114 - __main__ - INFO - Loading passages from: ../TQ/psgs_w100.tsv
2023-06-27 20:03:41,335 - __main__ - INFO -  global_step = 22000
